import{a as _,b as z}from"../../../../_chunks/chunk-G6FQBLBG.js";import{i as P,j as F,k as d,l as n}from"../../../../_chunks/chunk-R2HZVO35.js";import{a as y}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as a,g as l,h as m,j as A,k as b}from"../../../../_chunks/chunk-L3ECGIWB.js";var S=l(b(),1);var s=l(y(),1);var D=l(_(),1),C=l(z(),1);var f=l(y(),1);var o=class extends f.EntityDialog{constructor(){super(...arguments);this.form=new F(this.idPrefix)}getFormKey(){return F.formKey}getRowDefinition(){return d}getService(){return n.baseUrl}};a(o,"PerformanceAppraisalFileAttachDialog"),o=m([f.Decorators.registerClass("HRMSoftware.PerformanceAppraisal.PerformanceAppraisalFileAttachDialog")],o);var u=l(b(),1);var i=class extends s.EntityGrid{getColumnsKey(){return P.columnsKey}getDialogType(){return o}getRowDefinition(){return d}getService(){return n.baseUrl}constructor(e){super(e)}onViewProcessData(e){return e=super.onViewProcessData(e),this.toolbar.findButton("column-picker-button").toggle(!1),e}getButtons(){var e=super.getButtons();return e.push({title:"Download Files",cssClass:"",icon:"fa fa-file-download",onClick:()=>{this.downloadAllFiles()}}),e.push({title:"Delete All Records",cssClass:"delete-button",onClick:()=>this.deleteAllRecords()}),e}deleteAllRecords(){let e=this.view.getItems().map(r=>r.Id);e.length!==0&&(0,u.confirm)("Are you sure you want to delete all visible records?",()=>{n.DeleteAll({RecordIds:e},r=>{this.refresh()})})}downloadAllFiles(){return A(this,null,function*(){var e=this.view.getItems();if(e.length===0){(0,u.alertDialog)("There are no files available to download.");return}var r=new D.default,t=new Date,c=t.getFullYear(),p=("0"+(t.getMonth()+1)).slice(-2),w=("0"+t.getDate()).slice(-2),v=("0"+t.getHours()).slice(-2),I=("0"+t.getMinutes()).slice(-2),k=("0"+t.getSeconds()).slice(-2),B=`Files_${c}-${p}-${w}_${v}-${I}-${k}.zip`,H=e.map(h=>A(this,null,function*(){var g=h;if(g.Files!=null){var K=window.location.protocol+"//"+window.location.host,M=K+"/upload/"+g.Files;let R=yield fetch(M);if(R.ok){let T=yield R.blob();r.file(g.Files,T)}}}));yield Promise.all(H),r.generateAsync({type:"blob"}).then(function(h){(0,C.saveAs)(h,B)})})}getColumns(){s.DataGrid.defaultRowHeight=50;let e=super.getColumns();return e.splice(0,0,{field:"File",name:"",format:r=>{var t=r.item,c="",p="";if(t.Files==null)c="disabled";else{var w=window.location.protocol+"//"+window.location.host,v=w+"/upload/"+t.Files;p=v}return'<a class="inline-action download-file-button '+c+'" title="Download File" target = "_blank" href='+p+'><i class="fa fa-file-alt" style="color: blue;"></i></a>'},width:24,minWidth:24,maxWidth:24}),e}};a(i,"PerformanceAppraisalFileAttachGrid"),i=m([s.Decorators.registerClass("HRMSoftware.PerformanceAppraisal.PerformanceAppraisalFileAttachGrid")],i);function E(){(0,S.initFullHeightGridPage)(new i($("#GridDiv")).element)}a(E,"pageInit");export{E as default};
//# sourceMappingURL=PerformanceAppraisalFileAttachPage.js.map
