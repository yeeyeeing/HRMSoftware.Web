import{a as F}from"../../../../_chunks/chunk-AFGMZXBR.js";import"../../../../_chunks/chunk-I3VQVPHQ.js";import{a as H,c as s,d as E}from"../../../../_chunks/chunk-BAH6NAWX.js";import{d as v}from"../../../../_chunks/chunk-KXMTVQGO.js";import"../../../../_chunks/chunk-GYFJ4L6D.js";import"../../../../_chunks/chunk-T7E74GLF.js";import"../../../../_chunks/chunk-6XVG2SV4.js";import{a as m}from"../../../../_chunks/chunk-27W64ILM.js";import"../../../../_chunks/chunk-3NATHMDL.js";import{l as k}from"../../../../_chunks/chunk-RTQCGMRU.js";import{f as N,j as A,n as C}from"../../../../_chunks/chunk-MVZ476J5.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import{a as I}from"../../../../_chunks/chunk-LLMDZJQJ.js";import{b}from"../../../../_chunks/chunk-J5PFZI4S.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as x}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as D,g,h as S,k as w}from"../../../../_chunks/chunk-L3ECGIWB.js";var P=g(w(),1);var r=g(x(),1);var i=g(w(),1);var y=class extends r.EntityGrid{constructor(t){super(t)}getColumnsKey(){return H.columnsKey}getDialogType(){return F}getRowDefinition(){return s}getService(){return E.baseUrl}getAddButtonCaption(){return"Apply Leave"}getButtons(){var t=super.getButtons(),e=this;return t.push({title:"OT Application Claim Batch Approve",cssClass:"fas fa-hat-wizard text-bg-success approveButton",onClick:o=>{(0,i.confirm)("Do you want to approve all selected applications?",()=>{let d=e.rowSelection.getSelectedAsInt64().map(l=>E.Retrieve({EntityId:l}).then(p=>{let c=p.Entity.EmployeeStatus,u=p.Entity.HrStatus,R=p.Entity.Id,n=p.Entity.EmployeeRowId,a={};return new Promise((f,h)=>{(0,i.serviceCall)({service:v.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:n},method:"GET",onSuccess:U=>{i.Authorization.userDefinition.Permissions[m.HumanResources]?U?c===2||u===2?c===2?a={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:u===2&&(a={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):u===1?a={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:c===1?a={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={EmployeeStatus:1,HrStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},E.Update({EntityId:R,Entity:a}).then(f).catch(h)},onError:h})})}));Promise.all(d).then(()=>{e.internalRefresh()}).catch(l=>{console.error("Error in update operations:",l)})})},separator:!0}),t.push({title:"OT Application Batch Reject",cssClass:"fas fa-hat-wizard text-bg-danger rejectButton",onClick:o=>{(0,i.confirm)("Do you want to reject all selected applications?",()=>{let d=e.rowSelection.getSelectedAsInt64().map(l=>E.Retrieve({EntityId:l}).then(p=>{let c=p.Entity.EmployeeStatus,u=p.Entity.HrStatus,R=p.Entity.Id,n={},a=p.Entity.EmployeeRowId;(0,i.serviceCall)({service:v.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:a},method:"GET",async:!1,onSuccess:f=>{console.log(f);var h=f;return i.Authorization.userDefinition.Permissions[m.HumanResources]?h==!0?c==2||u==2?c==2?n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:u==2&&(n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):u==0?n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:c==0?n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},E.Update({EntityId:R,Entity:n})}})}));Promise.all(d).then(()=>{e.internalRefresh()}).catch(l=>{console.error("Error in update operations:",l)})})},separator:!0}),t}onViewSubmit(){if(!super.onViewSubmit())return!1;var t=this;return this.slickGrid.onHeaderCellRendered.subscribe((e,o)=>{o.column.id==="SelectAll"&&$(o.node).empty().append("<input type='checkbox' id='selectAll'/>")}),$(document).on("change","#selectAll",function(){let e=$(this).prop("checked");$(".row-checkbox").prop("checked",e)}),!0}getQuickFilters(){let t=super.getQuickFilters();return i.Authorization.hasPermission(m.HumanResources)&&(t.push({cssClass:"hidden-xs",field:s.Fields.OccupationName,type:r.Select2Editor,title:"Occupation"}),t.push({cssClass:"hidden-xs",field:s.Fields.JobGradeName,type:r.Select2Editor,title:"Job Grade"}),t.push({cssClass:"hidden-xs",field:s.Fields.DivisionName,type:r.Select2Editor,title:"Division"}),t.push({cssClass:"hidden-xs",field:s.Fields.DepartmentName,type:r.Select2Editor,title:"Department"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeName,type:r.Select2Editor,title:"Name"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeID,type:r.Select2Editor,title:"Employee ID"}),t.push({cssClass:"hidden-xs",field:s.Fields.CostCentreName,type:r.Select2Editor,title:"Cost Centre"}),t.reverse()),t}createQuickFilters(){if(super.createQuickFilters(),i.Authorization.hasPermission(m.HumanResources)){let t=["January","February","March","April","May","June","July","August","September","October","November","December"];C.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.OccupationName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),A.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.JobGradeName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),I.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DepartmentName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),N.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DivisionName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),b.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeName).items.push({id:e.Entities[o].EmployeeName.toString(),text:e.Entities[o].EmployeeName.toString()}),this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeID).items.push({id:e.Entities[o].EmployeeID.toString(),text:e.Entities[o].EmployeeID.toString()})}),k.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.CostCentreName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})})}}createToolbarExtensions(){super.createToolbarExtensions(),this.rowSelection=new r.GridRowSelectionMixin(this,{selectable:t=>{var e=0,o;for((0,i.serviceCall)({service:v.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:t.EmployeeRowId},method:"GET",async:!1,onSuccess:l=>{e=1,o=l}});e==0;);let d=i.Authorization.hasPermission(m.HumanResources);if(t.Status==0){if(t.EmployeeRowId==i.Authorization.userDefinition.EmployeeRowID||d&&t.HrStatus==2)return;if(d&&t.HrStatus==0||o&&t.EmployeeStatus==0)return $(".approveButton, .rejectButton").show(),!0}}}),$(document).on("click",".select-item.check-box.no-float",function(){$(".select-item.check-box.no-float").parent().parent().removeClass("highlighted-row"),$(".select-item.check-box.no-float.checked").parent().parent().addClass("highlighted-row")}),$("<style>").prop("type","text/css").html(`
            .slick-row.highlighted-row {
                background-color: #D3E5FF !important;
            }
        `).appendTo("head")}getColumns(){var t=super.getColumns(),e;if(!i.Authorization.hasPermission(m.HumanResources))for(e in t)(t[e].name=="Employee Id"||t[e].name=="Approved By")&&t.splice(e,1);return t.unshift(r.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection)),t}onViewProcessData(t){return this.toolbar.findButton("column-picker-button").toggle(!1),t=super.onViewProcessData(t),$(".approveButton, .rejectButton").hide(),t}createEntityDialog(t,e){let o=super.createEntityDialog(t,e);var d=this;return o.element.on("dialogclose",()=>{d.internalRefresh(),console.log("hahaa")}),o}};D(y,"LeaveApplicationGrid"),y=S([r.Decorators.registerClass("HRMSoftware.LeaveApplication.LeaveApplicationGrid")],y);function L(){(0,P.initFullHeightGridPage)(new y($("#GridDiv")).element)}D(L,"pageInit");export{L as default};
//# sourceMappingURL=LeaveApplicationPage.js.map
