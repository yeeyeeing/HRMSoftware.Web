import{a as F}from"../../../../_chunks/chunk-N4LYTVJ7.js";import"../../../../_chunks/chunk-I3VQVPHQ.js";import{a as H,c as s,d as E}from"../../../../_chunks/chunk-OLYWZP6G.js";import"../../../../_chunks/chunk-6BHXH7OQ.js";import"../../../../_chunks/chunk-CICJSBLQ.js";import{d as R}from"../../../../_chunks/chunk-PMW367QL.js";import"../../../../_chunks/chunk-HHF47QKB.js";import"../../../../_chunks/chunk-T7E74GLF.js";import"../../../../_chunks/chunk-DA7Z2NN7.js";import{a as u}from"../../../../_chunks/chunk-27W64ILM.js";import"../../../../_chunks/chunk-NN5FEWI3.js";import{l as k}from"../../../../_chunks/chunk-KCWQ5BXW.js";import{f as N,j as A,n as C}from"../../../../_chunks/chunk-MVZ476J5.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import{a as I}from"../../../../_chunks/chunk-LLMDZJQJ.js";import{b}from"../../../../_chunks/chunk-MUCPV7IN.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as x}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as D,g as S,h as w,k as g}from"../../../../_chunks/chunk-L3ECGIWB.js";var P=S(g(),1);var r=S(x(),1);var i=S(g(),1);var m=class extends r.EntityGrid{constructor(t){super(t)}getColumnsKey(){return H.columnsKey}getDialogType(){return F}getRowDefinition(){return s}getService(){return E.baseUrl}getAddButtonCaption(){return"Apply Leave"}getButtons(){var t=super.getButtons(),e=this;return t.push({title:"OT Application Claim Batch Approve",cssClass:"fas fa-hat-wizard text-bg-success approveButton",onClick:o=>{(0,i.confirm)("Do you want to approve all selected applications?",()=>{let y=e.rowSelection.getSelectedAsInt64().map(a=>E.Retrieve({EntityId:a}).then(p=>{let d=p.Entity.EmployeeStatus,c=p.Entity.HrStatus,v=p.Entity.Id,n=p.Entity.EmployeeRowId,l={};return new Promise((f,h)=>{(0,i.serviceCall)({service:R.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:n},method:"GET",onSuccess:U=>{i.Authorization.userDefinition.Permissions[u.HumanResources]?U?d===2||c===2?d===2?l={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:c===2&&(l={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):c===1?l={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:d===1?l={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:l={EmployeeStatus:1,HrStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:l={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:l={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},E.Update({EntityId:v,Entity:l}).then(f).catch(h)},onError:h})})}));Promise.all(y).then(()=>{e.internalRefresh()}).catch(a=>{console.error("Error in update operations:",a)})})},separator:!0}),t.push({title:"OT Application Batch Reject",cssClass:"fas fa-hat-wizard text-bg-danger rejectButton",onClick:o=>{(0,i.confirm)("Do you want to reject all selected applications?",()=>{let y=e.rowSelection.getSelectedAsInt64().map(a=>E.Retrieve({EntityId:a}).then(p=>{let d=p.Entity.EmployeeStatus,c=p.Entity.HrStatus,v=p.Entity.Id,n={},l=p.Entity.EmployeeRowId;(0,i.serviceCall)({service:R.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:l},method:"GET",async:!1,onSuccess:f=>{console.log(f);var h=f;return i.Authorization.userDefinition.Permissions[u.HumanResources]?h==!0?d==2||c==2?d==2?n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:c==2&&(n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):c==0?n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:d==0?n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},E.Update({EntityId:v,Entity:n})}})}));Promise.all(y).then(()=>{e.internalRefresh()}).catch(a=>{console.error("Error in update operations:",a)})})},separator:!0}),t}onViewSubmit(){if(!super.onViewSubmit())return!1;var t=this;return this.slickGrid.onHeaderCellRendered.subscribe((e,o)=>{o.column.id==="SelectAll"&&$(o.node).empty().append("<input type='checkbox' id='selectAll'/>")}),$(document).on("change","#selectAll",function(){let e=$(this).prop("checked");$(".row-checkbox").prop("checked",e)}),!0}getQuickFilters(){let t=super.getQuickFilters();return i.Authorization.hasPermission(u.HumanResources)&&(t.push({cssClass:"hidden-xs",field:s.Fields.OccupationName,type:r.Select2Editor,title:"Occupation"}),t.push({cssClass:"hidden-xs",field:s.Fields.JobGradeName,type:r.Select2Editor,title:"Job Grade"}),t.push({cssClass:"hidden-xs",field:s.Fields.DivisionName,type:r.Select2Editor,title:"Division"}),t.push({cssClass:"hidden-xs",field:s.Fields.DepartmentName,type:r.Select2Editor,title:"Department"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeName,type:r.Select2Editor,title:"Name"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeID,type:r.Select2Editor,title:"Employee ID"}),t.push({cssClass:"hidden-xs",field:s.Fields.CostCentreName,type:r.Select2Editor,title:"Cost Centre"}),t.reverse()),t}createQuickFilters(){if(super.createQuickFilters(),i.Authorization.hasPermission(u.HumanResources)){let t=["January","February","March","April","May","June","July","August","September","October","November","December"];C.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.OccupationName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),A.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.JobGradeName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),I.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DepartmentName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),N.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DivisionName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),b.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeName).items.push({id:e.Entities[o].EmployeeName.toString(),text:e.Entities[o].EmployeeName.toString()}),this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeID).items.push({id:e.Entities[o].EmployeeID.toString(),text:e.Entities[o].EmployeeID.toString()})}),k.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.CostCentreName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})})}}createToolbarExtensions(){super.createToolbarExtensions(),this.rowSelection=new r.GridRowSelectionMixin(this,{selectable:t=>{var e=0,o;for((0,i.serviceCall)({service:R.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:t.EmployeeRowId},method:"GET",async:!1,onSuccess:a=>{e=1,o=a}});e==0;);let y=i.Authorization.hasPermission(u.HumanResources);if(t.Status==0){if(t.EmployeeRowId==i.Authorization.userDefinition.EmployeeRowID||y&&t.HrStatus==2)return;if(y&&t.HrStatus==0||o&&t.EmployeeStatus==0)return $(".approveButton, .rejectButton").show(),!0}}}),$(document).on("click",".select-item.check-box.no-float",function(){$(".select-item.check-box.no-float").parent().parent().removeClass("highlighted-row"),$(".select-item.check-box.no-float.checked").parent().parent().addClass("highlighted-row")}),$("<style>").prop("type","text/css").html(`
            .slick-row.highlighted-row {
                background-color: #D3E5FF !important;
            }
        `).appendTo("head")}getColumns(){var t=super.getColumns(),e;if(!i.Authorization.hasPermission(u.HumanResources))for(e in t)(t[e].name=="Employee Id"||t[e].name=="Approved By")&&t.splice(e,1);return t.unshift(r.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection)),t}onViewProcessData(t){return this.toolbar.findButton("column-picker-button").toggle(!1),t=super.onViewProcessData(t),$(".approveButton, .rejectButton").hide(),t}};D(m,"LeaveApplicationGrid"),m=w([r.Decorators.registerClass("HRMSoftware.LeaveApplication.LeaveApplicationGrid")],m);function L(){(0,P.initFullHeightGridPage)(new m($("#GridDiv")).element)}D(L,"pageInit");export{L as default};
//# sourceMappingURL=LeaveApplicationPage.js.map
