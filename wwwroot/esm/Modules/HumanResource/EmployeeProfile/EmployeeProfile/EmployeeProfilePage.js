import{c as ht,d as jt}from"../../../../_chunks/chunk-XI35V5IP.js";import{a as Vt}from"../../../../_chunks/chunk-GY4VIGRF.js";import{a as _t}from"../../../../_chunks/chunk-W3BLPUIC.js";import{h as Yt}from"../../../../_chunks/chunk-QV7MIW62.js";import{a as Ft}from"../../../../_chunks/chunk-BWB72ONM.js";import{a as Wt}from"../../../../_chunks/chunk-U3N67OCP.js";import{a as Gt}from"../../../../_chunks/chunk-HMF5OW44.js";import{G as Mt}from"../../../../_chunks/chunk-TCOECVPP.js";import{a as Bt}from"../../../../_chunks/chunk-ZKVNYKFQ.js";import{a as ii,b as ri}from"../../../../_chunks/chunk-FQXHXHZD.js";import{b as Ht}from"../../../../_chunks/chunk-U47JSUFM.js";import{d as At}from"../../../../_chunks/chunk-I3VQVPHQ.js";import{e as kt}from"../../../../_chunks/chunk-GHIP3IPF.js";import{e as at}from"../../../../_chunks/chunk-2YJXBIYS.js";import{d as Tt}from"../../../../_chunks/chunk-GYFJ4L6D.js";import"../../../../_chunks/chunk-T7E74GLF.js";import{d as Ot}from"../../../../_chunks/chunk-3MJ4Y52C.js";import{d as xt}from"../../../../_chunks/chunk-T7MGTPAP.js";import{a as Lt}from"../../../../_chunks/chunk-47F7KCJ6.js";import{d as Ut}from"../../../../_chunks/chunk-C45P7KJQ.js";import{c as Nt}from"../../../../_chunks/chunk-U2RRK6JY.js";import{d as Qe}from"../../../../_chunks/chunk-HDHDXEPW.js";import"../../../../_chunks/chunk-BVVXSYMS.js";import{m as je}from"../../../../_chunks/chunk-3FMYFY2A.js";import{a as Ze}from"../../../../_chunks/chunk-OAOSE5IN.js";import{j as Ct,s as $t,v as pt}from"../../../../_chunks/chunk-F3ZQHHES.js";import{x as St}from"../../../../_chunks/chunk-E5LOGLR4.js";import"../../../../_chunks/chunk-EM5O7OU6.js";import"../../../../_chunks/chunk-JXMDZA3A.js";import"../../../../_chunks/chunk-LLMDZJQJ.js";import{a as rt,b as M}from"../../../../_chunks/chunk-J5PFZI4S.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as ft}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as P,g as _,h as it,j as ne,k as he}from"../../../../_chunks/chunk-L3ECGIWB.js";var Jt=_(ft(),1),He=_(he(),1),Be=_(he(),1),Me=_(he(),1),zt=_(he(),1);var ve=_(ft(),1);var b=_(ft(),1);var Ae=_(he(),1);var c=_(he(),1);var Le=_(he(),1);var ot=_(he(),1);var ke=class extends b.EntityDialog{constructor(){super();this.form=new pt(this.idPrefix);this.list_of_employee_id=[];this.list_of_employee_row_id=[];this.ListOfUser=[];this.OriginalValue={};this.EditedValue={};this.form.FixedDeductionList.slickGrid.setOptions({rowHeight:30}),this.form.AllowanceLists.slickGrid.setOptions({rowHeight:30}),this.form.EmployeeCareerPath.slickGrid.setOptions({rowHeight:30}),this.cloneButton.remove(),M.List({},e=>{for(var a in e.Entities)this.list_of_employee_id.push(e.Entities[a].EmployeeID),this.list_of_employee_row_id.push(e.Entities[a].Id)})}getFormKey(){return pt.formKey}getRowDefinition(){return rt}getService(){return M.baseUrl}onDeleteSuccess(e){super.onDeleteSuccess(e);var a=this;je.List({},d=>{for(var n in d.Entities)d.Entities[n].UserId==a.form.UserRowID.value&&je.Update({EntityId:a.form.UserRowID.value,Entity:{EmployeeRowID:null,Email:null}})})}onSaveSuccess(e){var a=e.EntityId,d=e,n=this;at.List({}).then(r=>{function g(s,R,O){s.endsWith("Class")&&(s=s.slice(0,-5));var h=String.fromCharCode(R)+s+String.fromCharCode(O);return h.replace(/\s+/g,"")}P(g,"EncodeString");function I(s){var x,Y,j,Ee,re,Z;s=A(s);let R=(Y=(x=s.match(/DIVISION(\d+)/))==null?void 0:x[1])!=null?Y:"",O=(Ee=(j=s.match(/DEPARTMENT(\d+)/))==null?void 0:j[1])!=null?Ee:"",h=(Z=(re=s.match(/SECTION(\d+)/))==null?void 0:re[1])!=null?Z:"",w=`DIVISION${R}`;return O&&(w+=`(?:[^D]*DEPARTMENT${O}`,h&&(w+=`(?:[^S]*SECTION${h})?`),w+=")?"),new RegExp(w)}P(I,"buildRegexPattern");function A(s){return s.replace(/[\x88\x99]/g,"")}P(A,"normalizeInput");function C(s,R,O){var h="",w=!1,x=[];for(let j=0;j<s.length;j++){var Y=s.charCodeAt(j);Y==R||w==!0&&Y!=O?(w==!0&&(h+=s[j]),w=!0):Y==O&&(x.push(h),w=!1,h="")}return x}P(C,"DecomposeStringToList");function L(s,R){return s.filter(O=>R.includes(O)).length}P(L,"countMatches");let f=r.Entities.filter(s=>s.HierarchyLevel>=1&&s.HierarchyLevel<=3&&(0,c.isEmptyOrNull)(s.EmployeeRowId)),y=r.Entities.filter(s=>s.HierarchyLevel==4&&s.EmployeeRowId==a),G=r.Entities.filter(s=>s.HierarchyLevel>=1&&s.HierarchyLevel<=3&&s.EmployeeRowId==a);if(!(0,c.isEmptyOrNull)(G))return;var Fe=r.Entities.find(s=>s.HierarchyLevel==0);console.log(Fe),console.log("hahah");var ie,ye;y.length>0&&(ie=y[0].Id,ye=y[0].NodeId);var $e="",ge="",se="";isNaN(n.DivisionId)==!1&&($e=g(`DIVISION${n.DivisionId}`,136,153)),isNaN(n.DepartmentId)==!1&&(ge=g(`DEPARTMENT${n.DepartmentId}`,136,153)),isNaN(n.SectionId)==!1&&(se=g(`SECTION${n.SectionId}`,136,153));var ee=`${$e}${ge}${se}`,We=I(ee);let Ge=[];var Q=C(ee,136,153),p={NodeId:Fe.NodeId},be=r.Entities.filter(s=>s.ParentId===p.NodeId).length;if(Q.length>0){f.forEach(h=>{var w=A(h.NodeId);We.test(w)&&Ge.push(h)});let s=-1,R=[];Ge.forEach(h=>{var w=C(h.NodeId,136,153),x=L(Q,w);x>0&&x>s&&(s=x)}),Ge.forEach(h=>{var w=C(h.NodeId,136,153),x=L(Q,w);x==s&&R.push(h)});let O=99999;R.forEach(h=>{var w=C(h.NodeId,136,153).length;O>w&&(p=h,O=w)}),be=r.Entities.filter(h=>h.ParentId===p.NodeId).length,be==1&&(0,c.isEmptyOrNull)(p.EmployeeRowId)&&r.Entities.filter(h=>h.ParentId===p.NodeId)[0].HierarchyLevel==p.HierarchyLevel&&(p=r.Entities.find(h=>h.ParentId===p.NodeId)||p,be=r.Entities.filter(h=>h.ParentId===p.NodeId).length)}var V={ParentId:p.NodeId,NodeId:`${p.NodeId}${g(`EMPLOYEE${a}`,136,153)}`,Name:n.OccupationText,ClassName:`EMPLOYEE${a} Class`,HierarchyLevel:4,childrenIndex:be,EmployeeRowId:a};return console.log(V.NodeId),console.log(V.NodeId===ye),V.NodeId===ye?Promise.resolve():(console.log("action"),(ie?at.Delete({EntityId:ie}):Promise.resolve()).then(()=>at.Create({Entity:V})))}).then(()=>{if(n.isNew()){var r=c.Authorization.userDefinition.Username,g=new Date,I=`Employee ${n.EmployeeName} is created by ${r} on ${g}`;return ht.Create({Entity:{Description:I,OldValue:null,NewValue:null,FieldName:null,EmployeeRowId:a}})}else{var A=Object.keys(n.EditedValue),r=c.Authorization.userDefinition.Username,g=new Date;return Promise.all(A.map(f=>{if(n.EditedValue[f]!==n.OriginalValue[f]&&typeof n.OriginalValue[f]!="object"&&typeof n.EditedValue[f]!="object"){var y=f.replace(/ID/g,""),G=(0,c.isEmptyOrNull)(n.OriginalValue[f])?`${y} of ${n.EmployeeName} is set by ${r} to ${n.EditedValue[f]} on ${g}`:`${y} of ${n.EmployeeName} is changed by ${r} from ${n.OriginalValue[f]} to ${n.EditedValue[f]} on ${g}`;return ht.Create({Entity:{Description:G,OldValue:n.OriginalValue[f],NewValue:n.EditedValue[f],FieldName:f,EmployeeRowId:a}})}return Promise.resolve()}))}}).then(()=>{super.onSaveSuccess(d)}).catch(r=>{console.error("Error during SplitOrganisationChartService operation:",r)})}onDialogClose(){super.onDialogClose(),clearInterval(this.refreshInterval)}dialogOpen(){super.dialogOpen();var e=this;$(document).on("click",".tool-button.add-button",function(){var a=e.form.EmployeeCareerPath.value.length;$(".s-HRMSoftware-EmployeeProfile-EmployeeCareerPathEditDialog").on("dialogclose",function(){if(a!=e.form.EmployeeCareerPath.value.length){e.loadById(e.entityId);for(let d=0;d<e.form.EmployeeCareerPath.value.length;d++)(0,c.isEmptyOrNull)(e.form.EmployeeCareerPath.value[d].IsActive)&&(e.form.EmployeeCareerPath.value[d].IsActive=1,Ct.Create({Entity:{EmployeeRowId:e.entityId,CareerPathId:e.form.EmployeeCareerPath.value[d].CareerPathId,CareerPathCode:e.form.EmployeeCareerPath.value[d].CareerPathCode,careerPaathType:e.form.EmployeeCareerPath.value[d].careerPaathType,CategoryId:e.form.EmployeeCareerPath.value[d].CategoryId,NewValue:e.form.EmployeeCareerPath.value[d].NewValue,newCostCentre:e.form.EmployeeCareerPath.value[d].newCostCentre,newDivision:e.form.EmployeeCareerPath.value[d].newDivision,oldValue:e.form.EmployeeCareerPath.value[d].oldValue,newDepartment:e.form.EmployeeCareerPath.value[d].newDepartment,newSection:e.form.EmployeeCareerPath.value[d].newSection,newOccupation:e.form.EmployeeCareerPath.value[d].newOccupation,newJobGrade:e.form.EmployeeCareerPath.value[d].newJobGrade,EffectiveDate:e.form.EmployeeCareerPath.value[d].EffectiveDate,Description:e.form.EmployeeCareerPath.value[d].Description,ManDesc:e.form.EmployeeCareerPath.value[d].ManDesc}},n=>{let r=0,g=!1,I=JSON.stringify(e.getSaveEntity()),A=P(()=>{let L=JSON.stringify(e.getSaveEntity());I!==L&&(g=!0,clearInterval(C))},"checkForChanges"),C=setInterval(()=>{r>=5||g?clearInterval(C):(e.loadById(e.entityId),A(),r++)},1e3)}))}})})}onDialogOpen(){super.onDialogOpen();var e=this;Qe.List({},i=>{for(var D in i.Entities)i.Entities[D].IsActive==1&&(this.ProbationMonths=i.Entities[D].ProbationPeriod,this.RetireAge=i.Entities[D].RetireAge,e.isNew()&&(e.form.ProbationPeriod.value=this.ProbationMonths))}),$(".UserRowID").hide();var a=document.getElementById(this.idPrefix+"EpfAccountNumber");$(a).on("input",function(){return ne(this,null,function*(){let i=this.value;i=i.replace(/\D/g,""),i.length>19&&(i=i.slice(0,19)),this.value=i})});var d=document.getElementById(this.idPrefix+"Nric");$(d).on("input",function(){return ne(this,null,function*(){let i=this.value;i=i.replace(/\D/g,""),i.length>12&&(i=i.slice(0,12)),this.value=i})});var n=document.getElementById(this.idPrefix+"SsfwNumber");$(n).on("input",function(){return ne(this,null,function*(){let i=this.value;i=i.replace(/\D/g,""),i.length>12&&(i=i.slice(0,12)),this.value=i})}),b.EditorUtils.setReadonly(e.form.Age.element,!0),$(".OtPayEntitlement").parent().after(`<ul role="tablist" class="nav nav-tabs property-tabs">
            <li class="nav-item" role="presentation"> <a class="nav-link custom active AllowanceLists" data-bs-toggle="tab" role="tab">Allowance</a> </li>
            <li class="nav-item" role="presentation"> <a class="nav-link custom FixedDeductionList" data-bs-toggle="tab" role="tab"> Deductions</a></li>
        </ul>
        `),$(".field.FixedDeductionList").parent().hide(),$(".field.OtPayEntitlement, .field.FixedOtRateOption, .field.PayByMonth, .field.PayByHour, .field.PayByDay").addClass("col-2"),document.querySelectorAll(".nav-link.custom").forEach(i=>{i.addEventListener("click",function(){document.querySelectorAll(".nav-link.custom").forEach(me=>me.classList.remove("active")),this.classList.add("active"),console.log(this.classList);let D=Object.values(this.classList).includes("AllowanceLists"),H=Object.values(this.classList).includes("FixedDeductionList");D?($(".field.AllowanceLists").parent().show(),$(".field.FixedDeductionList").parent().hide()):H&&($(".field.AllowanceLists").parent().hide(),$(".field.FixedDeductionList").parent().show())})}),$(".FixedOtRateOption").hide();var Z=document.getElementById(`${this.idPrefix}EmployeeType`);$(Z).on("change",function(){return ne(this,null,function*(){$(".SsfwNumber, .Nric, .OldNRIC").hide(),parseInt(e.form.EmployeeType.value)==1 .valueOf()?$(".Nric, .OldNRIC").show():parseInt(e.form.EmployeeType.value)==2 .valueOf()&&$(".SsfwNumber").show()})});var r=document.getElementById(`${this.idPrefix}PostcodeId`);if($(r).on("change",function(){return ne(this,null,function*(){St.Retrieve({EntityId:e.form.PostcodeId.value},i=>{!(0,c.isEmptyOrNull)(i.Entity.MasterCity)&&(0,c.isEmptyOrNull)(e.form.CityID.value)&&(e.form.CityID.value=i.Entity.MasterCity.toString()),!(0,c.isEmptyOrNull)(i.Entity.MasterState)&&(0,c.isEmptyOrNull)(e.form.StateID.value)&&(e.form.StateID.value=i.Entity.MasterState.toString()),!(0,c.isEmptyOrNull)(i.Entity.MasterCountry)&&(0,c.isEmptyOrNull)(e.form.CountryID.value)&&(e.form.CountryID.value=i.Entity.MasterCountry.toString())})})}),this.isNew())$(".CareerPahth").parent().hide(),$(".EmployeeCareerPath").parent().hide();else{$(Z).trigger("change");var g=e.form.DivisionID.value,I=e.form.DepartmentID.value,A=e.form.OccupationID.value,C=e.form.SectionID.value,L=e.form.JobGradeID.value,f=e.form.BasicSalary.value,y=document.getElementById(`${this.idPrefix}DivisionID`),G=document.getElementById(`${this.idPrefix}Cp8dID`),Fe=document.getElementById(`${this.idPrefix}DepartmentID`),ie=document.getElementById(`${this.idPrefix}SectionID`),ye=document.getElementById(`${this.idPrefix}JobGradeID`),$e=document.getElementById(`${this.idPrefix}OccupationID`),ge=document.getElementById(`${this.idPrefix}CostCentreID`),se=document.getElementById(`${this.idPrefix}BasicSalary`)}var ee=document.getElementById(`${this.idPrefix}OtPayEntitlement`);$(ee).on("change",function(){return ne(this,null,function*(){e.form.OtPayEntitlement.value==!0?$(".FixedOtRateOption, .OtRateWeekday, .OtRateWeekend, .OtRatePublicHoliday, .FixedOtRateOption").show():e.form.OtPayEntitlement.value==!1&&(e.form.OtRateWeekday.value=e.form.OtRateWeekend.value=e.form.OtRatePublicHoliday.value=0,$(".OtRateWeekday, .OtRateWeekend, .OtRatePublicHoliday, .FixedOtRateOption").hide())})}),$(ee).trigger("change");var We=document.getElementById(`${this.idPrefix}FixedOtRateOption`);$(We).on("change",function(){return ne(this,null,function*(){e.form.FixedOtRateOption.value==!0?(b.EditorUtils.setReadonly(e.form.OtRatePublicHoliday.element,!1),b.EditorUtils.setReadonly(e.form.OtRateWeekday.element,!1),b.EditorUtils.setReadonly(e.form.OtRateWeekend.element,!1)):e.form.FixedOtRateOption.value==!1&&(b.EditorUtils.setReadonly(e.form.OtRatePublicHoliday.element,!0),b.EditorUtils.setReadonly(e.form.OtRateWeekday.element,!0),b.EditorUtils.setReadonly(e.form.OtRateWeekend.element,!0))})}),$(We).trigger("change"),b.EditorUtils.setReadonly(this.form.WorkingHour.element,!0),b.EditorUtils.setReadonly(this.form.WorkingDays.element,!0),b.EditorUtils.setReadonly(this.form.DailyRateBase.element,!0),b.EditorUtils.setReadonly(this.form.NplRateBase.element,!0);var Ge=this.form.UserPassword.element,Q=this.form.UserName.element;$(Ge).attr("autocomplete","off"),$(Q).attr("autocomplete","off");let p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor="#000",p.style.color="#fff",p.style.padding="4px",p.style.borderRadius="4px",p.style.zIndex=Number.MAX_SAFE_INTEGER.toString(),p.style.display="none",document.body.appendChild(p),(parseInt(this.form.EmployeeType.value)==1||this.isNew())&&$(".IssueDate, .WorkingPermitIssueDate, .WorkingPermitExpireDate, .WorkingPermitValidFrom, .WorkingPermitValidUntil, .ArrivalDate").hide(),this.validateBeforeSave(),this.form.CreateUser.addValidationRule(this.uniqueName,i=>this.form.CreateUser.value&&((0,c.isEmptyOrNull)(this.form.UserName.value)||(0,c.isEmptyOrNull)(this.form.UserPassword.value))?"Please fill in UserName and Password":null);var be=document.getElementById(this.idPrefix+"Birthday");b.EditorUtils.setReadonly(this.form.RetireDate.element,!0),$(be).on("change",function(){var i=e.form.Birthday.valueAsDate;let D=i.getFullYear()+e.RetireAge,H=new Date(i);H.setFullYear(D),H<new Date&&H.setFullYear(D+1),console.log(H),e.form.RetireDate.valueAsDate=H});var V=document.getElementById(this.idPrefix+"UserName"),s="Username Cannot Start With Number, No Special Characters";$(V).on("blur",function(){(0,c.isEmptyOrNull)($(this).val())&&($(this).val(s),$(this).css({color:"grey"}))}),$(V).on("focus",function(){$(this).val()==s&&($(this).val(""),$(this).css({color:"black"}))}),$(V).on("change",function(){$(this).val()!=""&&$(this).val()!=s?$(this).css("color","black"):$(this).css("color","grey")}),$(V).on("keydown",function(i){var D=this.selectionStart,H=/[A-Za-z0-9]/,me=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,144,145];i.key.match(H)||me.includes(i.keyCode)?D===0&&i.key.match(/[0-9]/)&&i.preventDefault():i.preventDefault()}),$(V).on("mouseenter",()=>{p.innerHTML="Please dont use repeated username <br> Username can not contain anything else than number and characters";let i=$(Q)[0].getBoundingClientRect();p.style.display="block",p.style.top=`${i.bottom}px`,p.style.left=`${i.left}px`}),$(V).on("mouseleave",()=>{p.style.display="none"});var R=document.getElementById(this.idPrefix+"UserPassword"),O="Password length must be greater or equal to 6";$(R).on("blur",function(){(0,c.isEmptyOrNull)($(this).val())&&($(this).val(O),$(this).css({color:"grey"}))}),$(R).on("focus",function(){$(this).val()==O&&($(this).val(""),$(this).css({color:"black"}))}),$(R).on("change",function(){$(this).val()!=""&&$(this).val()!=O?$(this).css("color","black"):$(this).css("color","grey")}),$(R).on("mouseenter",()=>{p.innerHTML="Password length must be greater or equal to 6";let i=$(R)[0].getBoundingClientRect();p.style.display="block",p.style.top=`${i.bottom}px`,p.style.left=`${i.left}px`}),$(R).on("mouseleave",()=>{p.style.display="none"});var h=document.getElementById(this.idPrefix+"CalculationDate");if($(h).on("change",()=>{(0,Ae.serviceCall)({service:M.baseUrl+"/CalculateWorkingHourAndDayWithDate",data:{EmployeeRowID:this.entityId,Date:e.form.CalculationDate.value},method:"GET",async:!1,onSuccess:i=>{!(0,c.isEmptyOrNull)(i.Entities[0].NumberOfWorkingDays)&&i.Entities[0].NumberOfWorkingDays>0?e.form.WorkingHour.value=i.Entities[0].TotalWorkingTimeInMinutes/i.Entities[0].NumberOfWorkingDays:e.form.WorkingHour.value=0,e.form.WorkingDays.value=i.Entities[0].NumberOfWorkingDays,e.form.DailyRateBase.value=i.Entities[0].DailyRateBase,e.form.NplRateBase.value=i.Entities[0].NplRateBase},onError:i=>{console.log(i.Error)}}),e.form.OtPayEntitlement.value==!0?(0,Ae.serviceCall)({service:M.baseUrl+"/CalculateOtRate",data:{EmployeeRowID:this.entityId,Date:e.form.CalculationDate.value},method:"GET",async:!1,onSuccess:i=>{console.log(i),e.form.OtRateWeekday.value=i.Entities[0].OtRateWeekday,e.form.OtRateWeekend.value=i.Entities[0].OtRateWeekend,e.form.OtRatePublicHoliday.value=i.Entities[0].OtRatePublicHoliday}}):(e.form.OtRateWeekday.value=e.form.OtRateWeekend.value=e.form.OtRatePublicHoliday.value=0,$(".OtRateWeekday, .OtRateWeekend, .OtRatePublicHoliday").hide())}),(0,Ae.serviceCall)({service:Mt.baseUrl+"/GetTodayDateTime",method:"GET",data:{},async:!1,onSuccess:i=>{e.form.CalculationDate.value=i,$(h).trigger("change")}}),this.isNew()){var w=document.querySelectorAll(".text-bg-danger");w.forEach(function(i){$(i).hide()});var x=document.querySelectorAll(".text-bg-warning");x.forEach(function(i){$(i).hide()});var Y=document.querySelectorAll(".text-bg-success");Y.forEach(function(i){$(i).hide()})}else{if(this.OriginalEmployeeId=this.form.EmployeeID.value,this.Username=this.form.UserName.value,console.log(this.form.PassedProbation.value),parseInt(this.form.PassedProbation.value)==2||parseInt(this.form.PassedProbation.value)==1){var Y=document.querySelectorAll(".text-bg-success");Y.forEach(function(D){$(D).hide()}),b.EditorUtils.setReadonly(this.form.ProbationPeriodUntil.element,!0),b.EditorUtils.setReadonly(this.form.ProbationPeriodFrom.element,!0)}M.Retrieve({EntityId:this.entityId},i=>{i.Entity.Retired==0&&i.Entity.Terminated==0&&i.Entity.Resigned==0?$(".tool-button").removeClass("hidden"):(e.readOnly=!0,i.Entity.Terminated==1?(e.dialogTitle=`Terminated Employee (${e.form.EmployeeID.value})`,$(".TerminateDate").show(),$(".TerminateLeaveDate").show()):i.Entity.Resigned==1?(e.dialogTitle=`Resigned Employee (${e.form.EmployeeID.value})`,$(".ResignationDate").show(),$(".ResignLeaveDate").show()):i.Entity.Retired==1&&(e.dialogTitle=`Retired Employee (${e.form.EmployeeID.value})`))})}b.EditorUtils.setReadonly(this.form.PassedProbation.element,!0),b.EditorUtils.setReadonly(this.form.ProbationPeriodFrom.element,!0),b.EditorUtils.setReadonly(this.form.ProbationPeriodUntil.element,!0);var j=document.getElementById(this.idPrefix+"ProbationPeriod"),Ee=document.getElementById(this.idPrefix+"ProbationPeriodUntil"),re=document.getElementById(this.idPrefix+"JoinDate"),Z=document.getElementById(this.idPrefix+"EmployeeType"),Se=document.getElementById(this.idPrefix+"PayByDay"),de=document.getElementById(this.idPrefix+"PayByMonth"),nt=document.getElementById(this.idPrefix+"PayByHour");$(Se).on("change",function(i){e.form.PayByDay.value&&(e.form.PayByHour.value=!1,e.form.PayByMonth.value=!1)}),$(nt).on("change",function(i){e.form.PayByHour.value&&(e.form.PayByDay.value=!1,e.form.PayByMonth.value=!1)}),$(de).on("change",function(i){e.form.PayByMonth.value&&(e.form.PayByHour.value=!1,e.form.PayByDay.value=!1)}),$(Z).on("change",function(i){$(Z).val()==1?($(".EpfContribution").hide(),$(".WorkingPermit").hide(),$(".WorkingPermitIssueDate").hide(),$(".WorkingPermitExpireDate").hide(),$(".WorkingPermitValidFrom").hide(),$(".WorkingPermitValidUntil").hide(),$(".ArrivalDate").hide()):($(".EpfContribution").show(),$(".WorkingPermit").show(),$(".WorkingPermitIssueDate").show(),$(".WorkingPermitExpireDate").show(),$(".WorkingPermitValidFrom").show(),$(".WorkingPermitValidUntil").show(),$(".ArrivalDate").show())}),$(document).ready(function(){$("<span>months</span>").insertAfter(`#${e.idPrefix}ProbationPeriod`)});function xe(){var i=$(re).val(),D=e.form.ProbationPeriod.value;if(D==0){e.form.ProbationPeriodFrom.value=e.form.ProbationPeriodUntil.value="00/00/0000",e.form.PassedProbation.value=1 .valueOf().toString();return}else e.form.PassedProbation.value==2 .valueOf().toString();if(!((0,c.isEmptyOrNull)(e.form.JoinDate.value)||(0,c.isEmptyOrNull)(e.form.ProbationPeriod.value))&&D>0){var H=i.split("/");let t=new Date(parseInt(H[2]),parseInt(H[0])-1,parseInt(H[1])),o=Math.floor(D),l=D-o;if(t.setMonth(t.getMonth()+o),l>0){let E=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),N=Math.round(E*l);t.setDate(t.getDate()+N)}let v=t.getFullYear(),m=t.getMonth()+1,u=t.getDate();var me=`${m}/${u}/${v}`;e.form.ProbationPeriodFrom.value=i,e.form.ProbationPeriodUntil.value=me,$(Ee).val(me);var Xe=new Date(e.form.ProbationPeriodUntil.value);e.form.CalculationDate.valueAsDate>Xe?e.form.PassedProbation.value=2 .valueOf().toString():e.form.PassedProbation.value=0 .valueOf().toString(),console.log(e.form.PassedProbation.value)}}if(P(xe,"calculateProbation"),console.log(e.form.PassedProbation.value),console.log(2 .valueOf().toString()),this.isNew())$(".EpfContribution, .UserName, .UserPassword, .GrantHRPrivilege").hide(),$(".CreateUser").on("change",i=>{e.form.CreateUser.value==!0?($(".GrantHRPrivilege").show(),$(".UserName").show(),(0,c.isEmptyOrNull)($(Q).val())&&($(Q).val(s),$(Q).css({color:"grey"})),$(".UserPassword").show(),(0,c.isEmptyOrNull)($(R).val())&&($(R).val(O),$(R).css({color:"grey"}))):($(".GrantHRPrivilege, .UserName, .UserPassword").val(""),$(".GrantHRPrivilege, .UserName, .UserPassword").hide())});else{if(xe(),window.employeeRowId=this.entityId,this.form.CreateUser.value==!0?b.EditorUtils.setReadonly(this.form.CreateUser.element,!0):($(".UserName, .UserPassword, .GrantHRPrivilegeUserName").hide(),$(".CreateUser").on("change",i=>{this.form.CreateUser.value==!0?$(".UserName, .UserPassword, .GrantHRPrivilegeUserName").show():$(".UserName, .UserPassword, .GrantHRPrivilegeUserName").hide()})),(0,c.isEmptyOrNull)(this.form.RetireDate.value)){var Ne=e.form.Birthday.valueAsDate;let i=Ne.getFullYear()+e.RetireAge,D=new Date(Ne);D.setFullYear(i),D<new Date&&D.setFullYear(i+1),e.form.RetireDate.valueAsDate=D}$(re).prop("readonly",!1),this.Record(this.OriginalValue);for(var Je in this.list_of_employee_id)this.list_of_employee_id[Je]==this.form.EmployeeID.value&&(this.EmployeeRowID=this.list_of_employee_row_id[Je]);(parseInt(this.form.PassedProbation.value)==2||parseInt(this.form.PassedProbation.value)==1)&&(b.EditorUtils.setReadonly(this.form.ProbationPeriodFrom.element,!0),b.EditorUtils.setReadonly(this.form.ProbationPeriodUntil.element,!0),b.EditorUtils.setReadonly(this.form.ProbationPeriod.element,!0))}e.form.PassedProbation.value!=2 .valueOf().toString()&&($(j).on("change",function(i){xe()}),$(re).on("change",function(i){xe()}))}Record(e){var A,C;var a=this.propertyGrid.get_items(),d=[];for(var n in a){var r=a[n].name;d.push(r)}let g={};for(let L of d){var I=(A=this.form[L])==null?void 0:A.text;(typeof I=="undefined"||I===null)&&(I=(C=this.form[L])==null?void 0:C.value,(typeof I=="undefined"||I===null)&&(I="")),g[L]=I}Object.assign(e,g)}getDialogOptions(){let e=super.getDialogOptions();return e.height=800,e.width=1200,e}save_submitHandler(e){var a=[];this.EmployeeName=this.form.EmployeeName.value,this.Record(this.EditedValue),this.DivisionId=parseInt(this.form.DivisionID.value),this.DepartmentId=parseInt(this.form.DepartmentID.value),this.SectionId=parseInt(this.form.SectionID.value),this.OccupationText=this.form.OccupationID.text;function d(f){return/^[0-9]/.test(f)}P(d,"startsWithNumber");function n(f){return!/[^a-zA-Z0-9]/.test(f)}P(n,"containsOnlyNumbersAndChars"),this.form.UserName.value=="Username Cannot Start With Number, No Special Characters"&&(this.form.UserName.value="");var r=this;this.form.CreateUser.value==!0&&this.form.UserPassword.value==""&&a.push("Please fill in UserPassword"),this.form.CreateUser.value==!0&&this.form.UserPassword.value.length<6&&a.push("Length of UserPassword cannot be less than 6"),this.form.CreateUser.value==!0&&this.form.UserName.value.length<5&&a.push("Length of UserName cannot be less than 5"),this.form.CreateUser.value==!0&&d(this.form.UserName.value)==!0&&a.push("User Name cannot start with number"),this.form.CreateUser.value==!0&&n(this.form.UserName.value)==!1&&a.push("User Name cannot contain anything else than number and characters");var g=document.getElementById(this.idPrefix+"EmployeeType");$(g).val()==1?(0,c.isEmptyOrNull)(r.form.Nric.value)?a.push("Please fill in NRIC number"):r.form.Nric.value.length<12&&a.push("The length of NRIC should be 12"):parseInt(r.form.EmployeeType.value)==2 .valueOf()&&((0,c.isEmptyOrNull)(r.form.SsfwNumber.value)?a.push("Please fill in SSFW number"):r.form.SsfwNumber.value.length<12&&a.push("The length of SSFW should be 12")),this.form.FixedOtRateOption.value==!0&&((0,c.isEmptyOrNull)(this.form.OtRatePublicHoliday.value)||(0,c.isEmptyOrNull)(this.form.OtRateWeekday.value)||(0,c.isEmptyOrNull)(this.form.OtRateWeekend.value))&&a.push("Please fill in the Ot Rate");var I=this.form.EmployeeID.value.toString();if(this.isNew()||!this.isNew()&&this.form.EmployeeID.value!=this.OriginalEmployeeId)for(var A in this.list_of_employee_id)this.list_of_employee_id[A]===I&&a.push("There is a active employee with the ID, please check again.");if(a.length>0){let f=a.map(y=>`- ${y}`).join(`
`);(0,Ae.alertDialog)(f)}else if(a.length==0){var C=0,L=e;r.form.CreateUser.value==!0?je.List({},f=>{r.ListOfUser.length=0;for(var y in f.Entities)f.Entities[y].Username==this.form.EmployeeID.value&&(this.UserRowID=f.Entities[y].UserId),this.ListOfUser.push({EmployeeRowId:f.Entities[y].EmployeeRowID,UserName:f.Entities[y].Username,UserId:f.Entities[y].UserId});var G=1;if((0,c.isEmptyOrNull)(r.form.UserRowID.value)){for(var y in this.ListOfUser)if(console.log(this.ListOfUser[y].EmployeeRowId==r.entityId&&!(0,c.isEmptyOrNull)(r.entityId)),this.form.UserName.value==this.ListOfUser[y].UserName){if(G=0,(0,c.isEmptyOrNull)(this.ListOfUser[y].EmployeeRowId)||this.ListOfUser[y].EmployeeRowId==r.entityId&&!(0,c.isEmptyOrNull)(r.entityId)){C=1,(0,ot.confirmDialog)("There is already a user with the same username, do you want to link this employee to that account?",()=>{r.form.UserRowID.value=r.ListOfUser[y].UserId,je.Update({EntityId:r.ListOfUser[y].UserId,Entity:{EmployeeRowID:r.entityId,Password:r.form.UserPassword.value,PasswordConfirm:r.form.UserPassword.value}},ie=>{r.form.ProbationPeriod.value==0&&(r.form.ProbationPeriodUntil.value=r.form.ProbationPeriodFrom.value=""),super.save_submitHandler(L)})},{onNo:()=>{(0,ot.notifyInfo)("Please select another unique username")}});break}else if(!(0,c.isEmptyOrNull)(this.ListOfUser[y].EmployeeRowId)){if(this.entityId!=this.ListOfUser[y].EmployeeRowId){(0,Ae.alertDialog)("Please use another username, there is another user with same username");return}else r.form.ProbationPeriod.value==0&&(r.form.ProbationPeriodUntil.value=r.form.ProbationPeriodFrom.value="");break}break}}else je.Update({EntityId:r.form.UserRowID.value,Entity:{Username:r.form.UserName.value,Password:r.form.UserPassword.value,PasswordConfirm:r.form.UserPassword.value}});r.form.ProbationPeriod.value==0&&(r.form.ProbationPeriodUntil.value=r.form.ProbationPeriodFrom.value=""),C==0&&super.save_submitHandler(L)}):(r.form.ProbationPeriod.value==0&&(r.form.ProbationPeriodUntil.value=r.form.ProbationPeriodFrom.value=""),super.save_submitHandler(L))}}getToolbarButtons(){var e=super.getToolbarButtons(),a=this,d=document.createElement("style");return d.textContent=`
            .hidden {
      display: none;
    }
    .nav-link.custom {
        cursor: pointer;
    }

            `,document.head.appendChild(d),e.push({title:"Empoyee Retire",cssClass:"text-bg-primary p-2 hidden retireButton",onClick:()=>{var n=new Date;a.form.RetireDate.valueAsDate>n?(0,Le.confirm)("This employee has not reached the retire date, are you sure?",()=>{(0,Le.confirm)("Are you sure this employee has retired?",()=>{M.Update({EntityId:a.entityId,Entity:{Retired:1}}),a.readOnly=!0,a.dialogTitle=`Retired Employee (${a.form.EmployeeID.value})`,$(".confirmEmployee").addClass("hidden"),$(".terminateButton").addClass("hidden"),$(".resignButton").addClass("hidden"),$(".retireButton").addClass("hidden")})}):(0,Le.confirm)("Are you sure this employee has retired?",()=>{M.Update({EntityId:a.entityId,Entity:{Retired:1}}),a.readOnly=!0,a.dialogTitle=`Retired Employee (${a.form.EmployeeID.value})`,$(".confirmEmployee").addClass("hidden"),$(".terminateButton").addClass("hidden"),$(".resignButton").addClass("hidden"),$(".retireButton").addClass("hidden")})}}),e.push({title:"Confirm Empoyee",cssClass:"text-bg-success p-2 confirmEmployee hidden",onClick:()=>{var n=new Date;if(!(0,c.isEmptyOrNull)(a.form.ProbationPeriodUntil.value)){console.log(a.form.ProbationPeriodUntil.value);var r=new Date(a.form.ProbationPeriodUntil.value);r>n?(0,Le.confirm)("This employee has not passed probation period, are you sure?",()=>{(0,Le.confirm)("Do you want to pass probation of this employee?",()=>{M.Update({EntityId:a.entityId,Entity:{PassedProbation:2}}),a.form.PassedProbation.value=2 .valueOf().toString(),$(".confirmEmployee").addClass("hidden")})}):(0,Le.confirm)("Do you want to pass probation of this employee?",()=>{M.Update({EntityId:a.entityId,Entity:{PassedProbation:2}}),b.EditorUtils.setReadonly(a.form.ProbationPeriod.element,!0),a.form.PassedProbation.value=2 .valueOf().toString(),$(".confirmEmployee").addClass("hidden")})}}}),e.push({title:"Terminate Employee",cssClass:"text-bg-danger p-2 hidden terminateButton",onClick:()=>{var n=new Gt;n.loadByIdAndOpenDialog(this.entityId),n.element.on("dialogclose",function(){M.Retrieve({EntityId:a.entityId},r=>{r.Entity.Retired==0&&r.Entity.Terminated==0&&r.Entity.Resigned==0?$(".tool-button").removeClass("hidden"):(a.readOnly=!0,r.Entity.Terminated==1?a.dialogTitle=`Terminated Employee (${a.form.EmployeeID.value})`:r.Entity.Resigned==1?a.dialogTitle=`Resigned Employee (${a.form.EmployeeID.value})`:r.Entity.Retired==1&&(a.dialogTitle=`Retired Employee (${a.form.EmployeeID.value})`))})})}}),e.push({title:"Employee Resign",cssClass:"text-bg-warning p-2 hidden resignButton",onClick:()=>{var n=new Vt;n.loadByIdAndOpenDialog(this.entityId),n.element.on("dialogclose",function(){M.Retrieve({EntityId:a.entityId},r=>{r.Entity.Retired==0&&r.Entity.Terminated==0&&r.Entity.Resigned==0?$(".tool-button").removeClass("hidden"):(a.readOnly=!0,r.Entity.Terminated==1?a.dialogTitle=`Terminated Employee (${a.form.EmployeeID.value})`:r.Entity.Resigned==1?a.dialogTitle=`Resigned Employee (${a.form.EmployeeID.value})`:r.Entity.Retired==1&&(a.dialogTitle=`Retired Employee (${a.form.EmployeeID.value})`))})})}}),e}};P(ke,"EmployeeProfileDialog"),ke=it([b.Decorators.registerClass("HRMSoftware.EmployeeProfile.EmployeeProfileDialog")],ke);var Re=_(he(),1);var Te=class extends ve.EntityGrid{constructor(e){super(e);this.RowIdWithInitialisedLeave=[];this.RowIdOfEmployees=[];this.AnnualLeaveStartingRange=[];this.SickLeaveStartingRange=[];this.AnnualLeaveEndingRange=[];this.SickLeaveEndingRange=[];this.EntitledAnnualLeave=[];this.EntitledSickLeave=[];this.PrevYearAnnualLeaveStartingRange=[];this.PrevYearSickLeaveStartingRange=[];this.PrevYearAnnualLeaveEndingRange=[];this.PrevYearSickLeaveEndingRange=[];this.PrevYearEntitledAnnualLeave=[];this.PrevYearEntitledSickLeave=[];this.DynamicList=[];this.UserID=[];this.EmployeeRowID=[]}getColumnsKey(){return $t.columnsKey}getDialogType(){return ke}getRowDefinition(){return rt}getService(){return M.baseUrl}getAddButtonCaption(){return"Create Employee Profile"}getQuickFilters(){return super.getQuickFilters()}onViewProcessData(e){e=super.onViewProcessData(e),this.toolbar.findButton("column-picker-button").toggle(!1);var a=e.Entities;return this.RowIdOfEmployees.length=0,e}createToolbarExtensions(){super.createToolbarExtensions(),this.rowSelection=new ve.GridRowSelectionMixin(this,{selectable:e=>!0})}getColumns(){ve.DataGrid.defaultRowHeight=100;var e=super.getColumns();return e.splice(0,0,{field:"Employee Leave",name:"",format:a=>{var d='<a class="inline-action leave-application" title="leave"><i class="fa fa-plane"></i></a><br><a class="inline-action employee-post" title="employee profile edit history"><i class="fa fa-wrench"></i></a>';return d},width:12,minWidth:12,maxWidth:12}),e.splice(0,0,{field:"Employee Shift History",name:"",format:a=>{var d='<a class="inline-action shift-history" title="shift history"><i class="fa fa-book"></i></a><br><a class="inline-action basic-info" title="basic info"> <i class="fa fa-user-tie"></i></a>';return d},width:12,minWidth:12,maxWidth:12}),e}getButtons(){var e=super.getButtons(),a=this;return Re.Authorization.hasPermission(Ze.HumanResources)&&e.push({title:"Batch User Creation",cssClass:"apply-changes-button",onClick:d=>{(0,Re.confirm)("Do you want to create users in batch?",()=>{var n=new Wt;n.dialogOpen(),n.element.on("dialogclose",function(){a.internalRefresh()})})},separator:!0}),e}onClick(e,a,d){if(super.onClick(e,a,d),!e.isDefaultPrevented()){var n=this.itemAt(a),r=$(e.target);r.parent().hasClass("inline-action")&&(r=r.parent()),r.hasClass("basic-info")&&(0,Re.confirm)("Do you want to view basic employee data?",()=>{var g=new Tt(n.Id);g.loadByIdAndOpenDialog(n.Id),g.set_readOnly(!0),g.element.on("dialogopen",function(){})}),r.hasClass("employee-post")&&(0,Re.confirm)("Do you want to view employee profile edit history?",()=>{var g=new jt(n.Id);g.dialogOpen()}),r.hasClass("leave-application")&&(0,Re.confirm)("Do you want to view leave details?",()=>{At.List({},g=>{var I=g.Entities.filter(C=>C.EmployeeRowId===n.Id);I.sort((C,L)=>{let f=new Date(C.NextEntitlementDate).getTime(),y=new Date(L.NextEntitlementDate).getTime();return f-y});var A=new Ft(n.Id);A.loadByIdAndOpenDialog(I[I.length-1].Id)})}),r.hasClass("shift-history")&&(0,Re.confirm)("Do you want to view the shift history?",()=>{var g=new Bt(n.EmployeeID,n.Id);g.dialogOpen()})}}};P(Te,"EmployeeProfileGrid"),Te=it([ve.Decorators.filterable(),ve.Decorators.registerClass("HRMSoftware.EmployeeProfile.EmployeeProfileGrid")],Te);var vt=_(ii(),1),qt=_(ri(),1);function le(Ce,T){for(let e=0;e<Ce.length;e++)if(Ce[e].Id===T)return Ce[e].Name;return null}P(le,"findRowById");function ai(){var Ce;if(Qe.List({},t=>{for(var o in t.Entities)if(t.Entities[o].IsActive==1){Ce=t.Entities[o].BasedCountry;break}}),Me.Authorization.hasPermission(Ze.HumanResources)){Qe.List({},t=>{if(t.Entities.length==0){let o=document.createElement("main");o.id="main-content",o.className="main-container",o.innerHTML="<h1>This page is used to create Employee Profiles and new users</h1><p>Please initialise company settings to start using this feature.</p>",$("#GridDiv").append(o);return}else(0,zt.initFullHeightGridPage)(new Te($("#GridDiv")).element)});return}(0,qt.default)(vt);var T,e=[],a=[],d=[],n=[],r=[],g=[],I=[],A=!1;for((0,Be.serviceCall)({service:Nt.baseUrl+"/ListShift",method:"GET",data:{},async:!1,onSuccess:t=>{A=!0;let o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(var l in t.Entities){var v=[],m=[],u=[];for(var E in o)v.push(t.Entities[l][o[E]+"StartingFrom"]),m.push(t.Entities[l][o[E]+"EndingAt"]),u.push(t.Entities[l][o[E]+"WorkingTime"]);I.push({ShiftName:t.Entities[l].ShiftName,WorkingHourFromList:v,WorkingHourUntilList:m,WorkingTimeList:u,Color:t.Entities[l].ShiftColor,ShiftIdList:t.Entities[l].Id}),n.push(v),r.push(m),g.push(u),e.push(t.Entities[l].ShiftName),a.push(t.Entities[l].ShiftColor),d.push(t.Entities[l].Id)}},onError:t=>{console.log(t)}});A==!1;);var C=[],L=!1;for((0,Be.serviceCall)({service:Ut.baseUrl+"/ListPublicHoliday",method:"GET",data:{},async:!1,onSuccess:t=>{L=!0;for(var o in t.Entities)t.Entities[o].IsActive==1&&C.push({PublicHolidayDate:t.Entities[o].Date,PublicHolidayName:t.Entities[o].Name,PublicHolidayId:t.Entities[o].Id})},onError:t=>{console.log(t)}});L==!1;);var f=[],y=!1;for((0,Be.serviceCall)({service:Yt.baseUrl+"/ListGroup",method:"GET",data:{},async:!1,onSuccess:t=>{y=!0;for(var o in t.Entities)f.push({GroupName:t.Entities[o].Name,GroupColor:t.Entities[o].ShiftColor,GroupID:t.Entities[o].Id})},onError:t=>{console.log(t)}});y==!1;);var G=[],Fe=!1;for((0,Be.serviceCall)({service:kt.baseUrl+"/ListTakenLeaveFromID",method:"GET",data:{EmployeeRowID:Me.Authorization.userDefinition.EmployeeRowID},async:!1,onSuccess:t=>{Fe=!0;for(var o in t.Entities){var l=0;t.Entities[o].LeaveReasonId==4&&t.Entities[o].HalfDay==1&&(l=1),G.push({StartDate:t.Entities[o].StartDate.substring(0,10),EndDate:t.Entities[o].EndDate.substring(0,10),HalfDate:l,LeaveReason:t.Entities[o].LeaveReasonId,ID:t.Entities[o].Id})}},onError:t=>{console.log(t)}});Fe==!1;);var ie,ye,$e,ge=new Date,se=ge.getMonth()+1,ee=ge.getFullYear(),We=`${ge.getFullYear()}-${(ge.getMonth()+1).toString().padStart(2,"0")}`;function Ge(t,o,l){if(o>l){var v=l;l=o,o=v}return t>=o&&t<=l}P(Ge,"isInRange");function Q(t){return t<10?"0"+t:t.toString()}P(Q,"addLeadingZero");function p(t,o,l){var v=[],m=[],u=[];for(var E in t){var N=new Date(t[E].PublicHolidayDate.substring(0,10)),k=N.getFullYear(),S=N.getMonth()+1;k==o&&S==l&&(v.push(t[E].PublicHolidayName),m.push(t[E].PublicHolidayDate.substring(0,10)),u.push(t[E].PublicHolidayId))}return[v,m,u]}P(p,"GetCurrentMonthHoliday");function be(t,o){let l=[],v=new Date(t,o-1,1);for(let m=6;m>0;m--){let u=new Date(v);u.setMonth(u.getMonth()-m),l.push(`${u.getFullYear()}-${(u.getMonth()+1).toString().padStart(2,"0")}`)}l.push(`${v.getFullYear()}-${(v.getMonth()+1).toString().padStart(2,"0")}`);for(let m=1;m<=6;m++){let u=new Date(v);u.setMonth(u.getMonth()+m),l.push(`${u.getFullYear()}-${(u.getMonth()+1).toString().padStart(2,"0")}`)}return l}P(be,"generateMonthRange");function V(t,o,l){var v=new Date(o,l,0).getDate();let m=[];for(let F=1;F<=v;F++){var u=`${o}-${Q(l)}-${Q(F)}`,E=null,N=new Date(u);for(var k in t){var S=new Date(t[k].ShiftStartDate),ae=new Date(t[k].ShiftEndDate);if(N.setHours(0),N.setMinutes(0),N.setSeconds(0),N.setMilliseconds(0),typeof t[k].EmployeeGroupID!==void 0&&N>=S&&N<=ae){E=t[k].EmployeeGroupID;break}}m.push({date:u,shift:null,GroupID:E})}return m}P(V,"generateListOfDate");function s(t,o){console.log(o);for(var l in o){let u=new Date(o[l].ShiftStartDate.substring(0,10)),E=new Date(o[l].ShiftEndDate.substring(0,10));for(var v of t){var m=new Date(v.date);m>=u&&m<=E&&v.GroupID==null&&(v.shift=o[l].ShiftId)}}return t}P(s,"appendShift");function R(t,o,l,v,m){console.log(t);let u=new Date(t[0].date).getDay(),E=t.length,N=u,k=[];for(let W=1;W<=E;W++){var S=new Date(t[W-1].date),ae=`${S.getFullYear()}-${(S.getMonth()+1).toString().padStart(2,"0")}-${S.getDate().toString().padStart(2,"0")}`;let q=(N+W-1)%7,Ie=Math.floor((u+W-1)/7),we=W;var F=t[W-1].shift,Pe=t[W-1].GroupID,te=null,J=null,X=null;for(var U in v)if(v[U].PublicHolidayDate.substring(0,10)==ae){J=X=v[U].PublicHolidayName,te="#FF0000",F=null,Pe=null;break}if(F!=null){var B;for(var U in l)if(l[U].ShiftIdList==F){B=U;break}te=l[B].Color,J=l[B].ShiftName,l[B].WorkingHourUntilList[q]===void 0&&l[B].WorkingHourFromList[q]==null?(J="Rest Day",te="#FFFFE0",X="Happy Holidays"):l[B].WorkingHourFromList[q]!=null&&l[B].WorkingHourUntilList[q]!=null&&(X=l[B].WorkingHourFromList[q]+"-"+l[B].WorkingHourUntilList[q])}else if(Pe!=null){for(var U in o)if(o[U].GroupID==Pe){J=X=o[U].GroupName,te=o[U].GroupColor;break}}var oe=(0,He.getLookup)("LeaveReason.LeaveReason");for(var U in m){var ue=new Date(m[U].StartDate),De=new Date(m[U].EndDate),Oe=m[U].LeaveReason,z;for(var ce in oe.items)if(oe.items[ce].Id==Oe){z=oe.items[ce].LeaveReason.replace(/\s/g,"");break}S>=ue&&S<=De&&(J=X=z,te="#00FF00",F=null)}k.push({x:q,y:5-Ie,color:te,shiftstring:J,value:F,date:ae,custom:{monthDay:we,details:X}})}return console.log(k),k}P(R,"generateChartData");function O(t,o,l){return o===void 0||l===void 0?!1:t.getTime()>=o.getTime()&&t.getTime()<=l.getTime()}P(O,"isDateBetween");function h(t,o){var v=vt.chart("Employee-Timetable",{chart:{type:"heatmap"},title:{text:"",align:"left"},accessibility:{landmarkVerbosity:"one"},tooltip:{enabled:!0,outside:!0,zIndex:20,headerFormat:"",pointFormat:"{point.date:%A, %b %e, %Y} </br>{point.custom.details:%s }",nullFormat:"{point.date:%A, %b %e, %Y} </br>{point.custom.details:%s }"},xAxis:{categories:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],opposite:!0,lineWidth:26,offset:13,lineColor:"rgba(27, 26, 37, 0.2)",labels:{rotation:0,y:20,style:{textTransform:"uppercase",fontWeight:"bold"}},accessibility:{description:"weekdays",rangeDescription:"X Axis is showing all 7 days of the week, starting with Sunday."}},yAxis:{min:0,max:5,accessibility:{description:"weeks"},visible:!1},legend:{enable:!1,layout:"vertical",verticalAlign:"middle"},series:[{showInLegend:!1,keys:["x","y","value","date","color","id"],data:t,nullColor:"rgba(196, 196, 196, 0.2)",borderWidth:2,borderColor:"rgba(196, 196, 196, 0.2)",dataLabels:[{enabled:!0,format:"{#unless point.custom.empty}{point.shiftstring}{/unless}",style:{textOutline:"none",fontWeight:"normal",fontSize:"0.73rem"},y:4},{enabled:!0,align:"left",verticalAlign:"top",format:"{#unless point.custom.details}{point.custom.details}{/unless}",backgroundColor:"whitesmoke",padding:2,style:{textOutline:"none",color:"rgba(70, 70, 92, 1)",fontSize:"0.8rem",fontWeight:"bold",opacity:.5},x:1,y:1}]}],plotOptions:{series:{point:{events:{click:function(){var E=-1,N=0;for(var k in t)if(t[k].x==this.x&&t[k].y==this.y){var S=new Date(t[k].date),ae=S.getDate(),F=S.getMonth()+1,Pe=S.getFullYear(),J=!1;let fe=`${Pe}-${F.toString().padStart(2,"0")}-${ae.toString().padStart(2,"0")}`;var te=new Date(fe),J=!1;for(var X in G){var U=new Date(G[X].StartDate),B=new Date(G[X].EndDate);if(S>=U&&S<=B){var oe=new Ht;oe.loadByIdAndOpenDialog(G[X].ID),oe.set_readOnly(!0),N=1;break}}if(N==1)break;var ue=!1;for(var De in o)if(o[De].PublicHolidayDate==fe){var Oe=o[De].Id;ue=!0;break}if(ue=!0)break;for(var z in T){var ce=new Date(T[z].ShiftStartDate),W=new Date(T[z].ShiftEndDate),q=T[z].ShiftEndDate;if(T[z].EmployeeGroupID!==void 0&&S>=ce&&S<=W){E=T[z].EmployeeGroupID,J=!0;break}if(O(te,ce,W)){E=T[z].Id;var Ie=new Ot(Me.Authorization.userDefinition.EmployeeRowID,fe,1,q);Ie.loadByIdAndOpenDialog(E),Ie.set_readOnly(!0)}}if(J){var we=new _t;we.loadByIdAndOpenDialog(E),we.set_readOnly(!0)}if(ue){var Ve=new Lt;Ve.loadByIdAndOpenDialog(Oe),Ve.set_readOnly(!0)}break}}}}}}}),m=v.chartWidth,u=v.chartHeight;return[m,u]}if(P(h,"plot"),!Me.Authorization.hasPermission(Ze.HumanResources)){var w=document.createElement("style");w.setAttribute("type","text/css"),w.innerHTML=` body {margin-top:20px;}

            .card-style1 {
                box-shadow: 0px 0px 10px 0px rgb(89 75 128 / 9 %);
            }
            .border - 0 {
                border: 0!important;
            }
            .card {
                position: relative;
                display: flex;
                flex-direction: column;
                min-width: 0;
                word-wrap: break-word;
                background-color: #fff;
                background-clip: border-box;
                border: 1px solid rgba(0, 0, 0, .125);
                border-radius: 0.25rem;
            }
            section {
                padding: 120px 0;
                overflow: hidden;
                background: #fff;
            }
            .mb-2-3,.my-2-3 {
                margin-bottom: 2.3rem;
            }

            .section-title {
                font-weight: 600;
                letter-spacing: 2px;
                text-transform: uppercase;
                margin-bottom: 10px;
                position: relative;
                display: inline-block;
            }

            .text-primary {
                    color: #ceaa4d!important;
                }

            .text-secondary {
                    color: #15395A!important;
                }

            .font-weight-600 {
                    font-weight: 600;
                }

            .display-26 {
                    font-size: 1.3rem;
                }

        @media screen and(min-width: 992px) {
        .p-lg-7 {
                padding: 4rem;
            }
        }

        @media screen and(min-width: 768px) {
        .p-md-6 {
                padding: 3.5rem;
            }
        }

        @media screen and(min-width: 576px) {
        .p-sm-2-3 {
                padding: 2.3rem;
            }
        }

    .p-1-9 {
            padding: 1.9rem;
        }

    .bg-secondary {
            background: #15395A!important;
        }

        @media screen and(min - width: 576px) {
        .pe-sm-6,.px-sm-6{
                padding-right: 3.5rem;
            }
        }

        @media screen and(min-width: 576px) {
        .ps-sm-6,.px-sm-6 {
                padding-left: 3.5rem;
            }
        }

    .pe-1-9,.px-1-9{
            padding-right: 1.9rem;
        }

    .ps-1-9,.px-1-9 {
            padding-left: 1.9rem;
        }

    .pb-1-9,.py-1-9 {
            padding-bottom: 1.9rem;
        }

    .pt-1-9,.py-1-9{
            padding-top: 1.9rem;
        }
    .mb-1-9,.my-1-9 {
            margin-bottom: 1.9rem;
        }

        @media(min-width: 992px) {
        .d-lg-inline-block {
                display: inline - block!important;
            }
        }
    .rounded {
            border-radius: 0.25rem!important;
        }
        .tab {
          overflow: hidden;
          border: 1px solid #ccc;
          background-color: #f1f1f1;
        }

        .tab button {
          background-color: inherit;
          float: left;
          border: none;
          outline: none;
          cursor: pointer;
          padding: 14px 16px;
          transition: 0.3s;
        }

        .tab button:hover {
          background-color: #ddd;
        }

        .tab button.active {
          background-color: #ccc;
        }


        .tabcontent {
          display: none;
          padding: 6px 12px;
          border: 1px solid #ccc;
          border-top: none;
        animation: fadeEffect 1s; /* Fading effect takes 1 second */

        }

        @keyframes fadeEffect {
          from {opacity: 0;}
          to {opacity: 1;}
        }
        `;var x=document.createElement("div");x.setAttribute("class","row");var Y=document.createElement("div");Y.setAttribute("class","container");var j=document.createElement("section");j.setAttribute("class","bg-light");var Ee=document.createElement("DIV");Ee.setAttribute("class","col-lg-12 mb-4 mb-sm-5");var re=document.createElement("DIV");re.setAttribute("class","card card-style1 border-0");var Z=document.createElement("DIV");Z.setAttribute("class","card-body");var Se=document.createElement("div");Se.setAttribute("class","row align-items-center");var de=document.createElement("img");de.setAttribute("id","myImg"),de.width=63,de.height=112.5;var nt=document.createElement("DIV");nt.setAttribute("class","col-lg-12 mb-4 mb-sm-5");var xe=document.createElement("DIV");xe.classList.add("category-title"),xe.setAttribute("id","Employee-Timetable");var Ne=!1,Je=(0,He.getLookup)("Department.Department"),i=(0,He.getLookup)("Division.Division"),D=(0,He.getLookup)("Section.Section"),H=(0,He.getLookup)("JobGrade.JobGrade"),me=(0,He.getLookup)("Occupation.Occupation"),Xe=!1;for((0,Be.serviceCall)({service:xt.baseUrl+"/RetriveShiftHistory",method:"GET",data:{EmployeeID:Me.Authorization.userDefinition.EmployeeRowID},async:!1,onSuccess:t=>{T=t.Entities,ie=V(T,ee,se);for(var o in t.Entities)if(parseInt(t.Entities[o].Id)==0){Ne=!0;break}Xe=!0},onError:t=>{console.log(t)}});Xe==!1;);console.log(Ne),(0,Be.serviceCall)({service:M.baseUrl+"/EmployeeProfileBasedOnID",data:{EmployeeID:Me.Authorization.userDefinition.EmployeeRowID},method:"GET",async:!1,onSuccess:t=>{t.Entities[0].EmployeeImg?de.src="/upload/"+t.Entities[0].EmployeeImg:t.Entities[0].Sex==1?de.src="https://i.stack.imgur.com/l60Hf.png":t.Entities[0].Sex==0&&(de.src="https://st.depositphotos.com/2218212/2938/i/950/depositphotos_29388097-stock-illustration-facebook-profile.jpg");var o=document.createElement("div");o.appendChild(de),o.setAttribute("class","col-lg-2 mb-4 mb-lg-0");var l=document.createElement("div");l.setAttribute("class","col-lg-5 px-xl-10");var v=document.createElement("div");v.setAttribute("class","col-lg-5 px-xl-10");var m=document.createElement("ul");m.setAttribute("class","list-unstyled ");var u=document.createElement("ul");u.setAttribute("class","list-unstyled ");var E=document.createElement("li"),N=document.createElement("span");N.setAttribute("class","text-secondary me-1 font-weight-600"),N.innerText="Name",E.appendChild(N),E.insertAdjacentText("beforeend",t.Entities[0].EmployeeName),m.appendChild(E);var k=document.createElement("li"),S=document.createElement("span");S.setAttribute("class","text-secondary me-1 font-weight-600"),S.innerText="Employee ID",k.appendChild(S),k.insertAdjacentText("beforeend",t.Entities[0].EmployeeID),m.appendChild(k),console.log(t.Entities[0]);var ae=document.createElement("li"),F=document.createElement("span");F.setAttribute("class","text-secondary me-1 font-weight-600"),F.innerText="Age",ae.appendChild(F),ae.insertAdjacentText("beforeend",t.Entities[0].Age),m.appendChild(ae);let Pe=new Date(t.Entities[0].RecruitmentDate),te=new Date,J=te.getFullYear()-Pe.getFullYear(),X=te.getMonth()-Pe.getMonth();var U=document.createElement("li"),B=document.createElement("span");B.setAttribute("class","text-secondary me-1 font-weight-600");var oe;if(J==0?(B.innerText="Month of service",oe=X.toString()):(B.innerText="Year of service",oe=J.toString()),U.appendChild(B),U.insertAdjacentText("beforeend",oe),m.appendChild(U),le(Je.items,t.Entities[0].DepartmentId)!=null){var ue=document.createElement("li"),De=document.createElement("span");De.setAttribute("class","text-secondary me-1 font-weight-600"),De.innerText="Department",ue.appendChild(De),ue.insertAdjacentText("beforeend",le(Je.items,t.Entities[0].DepartmentId)),u.appendChild(ue)}if(le(i.items,t.Entities[0].DivisionId)!=null){var Oe=document.createElement("li"),z=document.createElement("span");z.setAttribute("class","text-secondary me-1 font-weight-600"),z.innerText="Division",Oe.appendChild(z),Oe.insertAdjacentText("beforeend",le(i.items,t.Entities[0].DivisionId)),u.appendChild(Oe)}if(le(D.items,t.Entities[0].SectionId)!=null){var ce=document.createElement("li"),W=document.createElement("span");W.setAttribute("class","text-secondary me-1 font-weight-600"),W.innerText="Section",ce.appendChild(W),ce.insertAdjacentText("beforeend",le(D.items,t.Entities[0].SectionId)),u.appendChild(ce)}if(le(me.items,t.Entities[0].OccupationId)!=null){var q=document.createElement("li"),Ie=document.createElement("span");Ie.setAttribute("class","text-secondary me-1 font-weight-600"),Ie.innerText="Occupation",q.appendChild(Ie),q.insertAdjacentText("beforeend",le(me.items,t.Entities[0].OccupationId)),u.appendChild(q)}if(le(H.items,t.Entities[0].JobGradeId)!=null){var we=document.createElement("li"),Ve=document.createElement("span");Ve.setAttribute("class"," text-secondary me-1 font-weight-600"),Ve.innerText="JobGrade",we.appendChild(Ve),we.insertAdjacentText("beforeend",le(H.items,t.Entities[0].JobGradeId)),u.appendChild(we)}l.appendChild(m),v.appendChild(u),Se.appendChild(o),Se.appendChild(l),Se.appendChild(v),Z.appendChild(Se),re.appendChild(Z),Ee.appendChild(re),x.append(Ee),Y.append(x),j.append(Y),$("#GridDiv").append(j),$("#GridDiv").append(w);var fe=document.createElement("DIV");fe.setAttribute("id","time-box"),fe.setAttribute("class","row"),fe.setAttribute("align","right");var yt=document.createElement("DIV"),et=document.createElement("INPUT");et.setAttribute("id","Month"),et.setAttribute("type","text"),et.setAttribute("class","monthSelect"),yt.appendChild(et),fe.appendChild(yt);function Kt(mt,qe){var K,Ke,Ue;for(Ke=document.getElementsByClassName("tabcontent"),K=0;K<Ke.length;K++)Ke[K].style.display="none";for(Ue=document.getElementsByClassName("tablinks"),K=0;K<Ue.length;K++)Ue[K].className=Ue[K].className.replace(" active","");document.getElementById(qe)!=null&&(document.getElementById(qe).style.display="block"),mt.currentTarget.className+=" active"}P(Kt,"open");var lt=document.createElement("div");lt.setAttribute("class","tab");var Ye=document.createElement("button");Ye.addEventListener("click",function(){Kt(event,"shifttab")},!1),Ye.setAttribute("class","tablinks"),Ye.innerText="Shift",Ye.setAttribute("id","defaultOpen"),lt.appendChild(Ye);var ze=document.createElement("DIV");ze.setAttribute("class","tabcontent"),ze.setAttribute("id","shifttab"),ze.appendChild(fe),ze.appendChild(xe);var pe=document.createElement("DIV");pe.setAttribute("class","tabcontent"),pe.setAttribute("id","tab2");var gt=document.createElement("h3");gt.textContent="Tab 2";var bt=document.createElement("p");bt.textContent="This is the content of Tab 2",pe.appendChild(gt),pe.appendChild(bt),x.appendChild(lt),x.appendChild(ze),x.appendChild(pe);var tt=be(ee,se);let Et=new Jt.Select2Editor($("#Month"));for(var _e=0;_e<tt.length;_e++)Et.addItem({id:_e.toString(),text:tt[_e].toString()}),tt[_e].toString()==We&&Et.set_value(_e.toString());$("#Month").on("change",function(){return ne(this,null,function*(){var mt=$(this).val(),qe=tt[mt];ye=parseInt(qe.split("-")[0]),$e=parseInt(qe.split("-")[1]),se=$e,ee=ye;var K=V(T,ye,$e);Ne==!1&&(K=s(K,T));var[Ke,Ue,ei]=p(C,ee,se),ut=[];for(var ct in Ue)ut.push({PublicHolidayDate:Ue[ct],PublicHolidayId:ei[ct],PublicHolidayName:Ke[ct]});var ti=R(K,f,I,ut,G),wt,Rt;[wt,Rt]=h(ti,ut),pe.style.width=String(wt)+"px",pe.style.height=String(Rt)+"px"})}),Ne==!1&&(ie=s(ie,T));var[Qt,Pt,Zt]=p(C,ee,se),st=[];for(var dt in Pt)st.push({PublicHolidayDate:Pt[dt],PublicHolidayId:Zt[dt],PublicHolidayName:Qt[dt]});var Xt=R(ie,f,I,st,G),Dt,It;[Dt,It]=h(Xt,st),pe.style.width=String(Dt)+"px",pe.style.height=String(It)+"px",Ye.click()},onError:t=>{console.log(t.Error)}})}}P(ai,"pageInit");export{ai as default};
//# sourceMappingURL=EmployeeProfilePage.js.map
