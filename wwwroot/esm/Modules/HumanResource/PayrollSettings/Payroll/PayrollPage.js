import{a as ve}from"../../../../_chunks/chunk-QZYCQMHW.js";import{a as Ee}from"../../../../_chunks/chunk-UBGIU2ND.js";import{l as Pe}from"../../../../_chunks/chunk-DF2FLON5.js";import{a as ge}from"../../../../_chunks/chunk-3RMZF3NW.js";import{a as he,b as Z}from"../../../../_chunks/chunk-IOPKNAJI.js";import"../../../../_chunks/chunk-YIP4GR2E.js";import"../../../../_chunks/chunk-B4PP3UR2.js";import"../../../../_chunks/chunk-5TAMAFA5.js";import{a as ye}from"../../../../_chunks/chunk-7NHB3LMO.js";import{G as pe}from"../../../../_chunks/chunk-QIDIFHUV.js";import{a as Se}from"../../../../_chunks/chunk-57K2HWZQ.js";import{a as ue}from"../../../../_chunks/chunk-KKPMYGUV.js";import{a as fe}from"../../../../_chunks/chunk-TS6RV5FM.js";import"../../../../_chunks/chunk-XZKAQRVI.js";import{A as ce,B as s,C,G as D,_,ca as me,d as J,da as V,h as K,l as X,q as se,z as de}from"../../../../_chunks/chunk-2WW6XFKA.js";import"../../../../_chunks/chunk-CICJSBLQ.js";import"../../../../_chunks/chunk-BFH3N3PU.js";import"../../../../_chunks/chunk-335Q4VKD.js";import"../../../../_chunks/chunk-T7E74GLF.js";import{d as le}from"../../../../_chunks/chunk-HDHDXEPW.js";import"../../../../_chunks/chunk-BVVXSYMS.js";import"../../../../_chunks/chunk-DA7Z2NN7.js";import{a as M}from"../../../../_chunks/chunk-27W64ILM.js";import"../../../../_chunks/chunk-7GGACY5T.js";import{f as oe,j as ae,n as ne,r as re}from"../../../../_chunks/chunk-HERT6KZV.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import{a as ie}from"../../../../_chunks/chunk-TIB4BNCY.js";import{a as H,b as G}from"../../../../_chunks/chunk-TYRFK7TU.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as z}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as O,g as w,h as Y,j as g,k as j}from"../../../../_chunks/chunk-L3ECGIWB.js";var be=w(j(),1);var N=w(z(),1);var n=w(j(),1);var L=w(j(),1),m=w(z(),1);var T=w(z(),1);var S=w(j(),1),Q=w(j(),1),ee=w(z(),1);var R=class extends T.EntityDialog{constructor(){super();this.form=new V(this.idPrefix);var e,o=this;D.List({},i=>{for(var t in i.Entities)i.Entities[t].IsActive==1&&(o.payrollSettingId=i.Entities[t].Id,o.payDay=i.Entities[t].CreditingDay,o.form.OrganisationName.value=i.Entities[t].OrganisationName,o.form.OrganisationCode.value=i.Entities[t].OrganisationCode,o.form.Email.value=i.Entities[t].Email,o.form.PhoneNumber.value=i.Entities[t].PhoneNumber,o.form.ContactPerson.value=i.Entities[t].ContactPerson,o.ContactPerson=i.Entities[t].ContactPerson,o.OrganisationCode=i.Entities[t].OrganisationCode,o.OrganisationName=i.Entities[t].OrganisationName,o.PhoneNumber=i.Entities[t].PhoneNumber,o.Email=i.Entities[t].Email)}),G.List({Criteria:T.Criteria.and(e,[[H.Fields.Retired],"=","0"],[[H.Fields.Terminated],"=","0"],[[H.Fields.Resigned],"=","0"])},i=>{this.EmployeeData=i.Entities})}getFormKey(){return V.formKey}getRowDefinition(){return de}getService(){return ce.baseUrl}getToolbarButtons(){var e=this,o=super.getToolbarButtons();return $(`#${this.idPrefix}Toolbar`).addClass("ms-auto"),o.push({title:"Download Text File",cssClass:"text-bg-success p-2 ml-auto",icon:"fas fa-hat-wizard text-green",onClick:()=>{if(console.log(e.form.EmployeeRowList.value),parseInt(e.form.TextType.value)==3 .valueOf())D.Update({EntityId:e.payrollSettingId,Entity:{Email:e.form.Email.value,PhoneNumber:e.form.PhoneNumber.value,ContactPerson:e.form.ContactPerson.value}});else if(parseInt(e.form.TextType.value)==5 .valueOf())D.Update({EntityId:e.payrollSettingId,Entity:{CreditingDay:e.form.CreditingDate.valueAsDate.getDay(),OrganisationName:e.form.OrganisationName.value,OrganisationCode:e.form.OrganisationCode.value}});else if(parseInt(e.form.TextType.value)==1 .valueOf()){if((0,S.isEmptyOrNull)(e.form.StateCodeId.value)){(0,S.alertDialog)("Please fill in the State Code");return}D.Update({EntityId:e.payrollSettingId,Entity:{StateCodeId:parseInt(e.form.StateCodeId.value)}})}if((0,S.isEmptyOrNull)(e.form.TextType.value)){(0,S.alertDialog)("Please fill in the type of government payment to generate");return}var i;parseInt(e.form.TextType.value)==3 .valueOf()?i=e.form.TextFormatLhdnId.value:parseInt(e.form.TextType.value)==5 .valueOf()?i=e.form.TextFormatAutopayId.value:parseInt(e.form.TextType.value)==1 .valueOf()?i=e.form.TextFormatEpfId.value:(parseInt(e.form.TextType.value)==2 .valueOf()||parseInt(e.form.TextType.value)==4 .valueOf())&&(i=e.form.TextFormatEisSocsoId.value);var t="PayMonth="+encodeURIComponent(e.form.PayMonth.value)+"&PayYear="+encodeURIComponent(e.form.PayYear.value)+"&Type="+encodeURIComponent(e.form.TextType.value)+"&CompanyCode="+encodeURIComponent(e.form.OrganisationCode.value)+"&CompanyName="+encodeURIComponent(e.form.OrganisationName.value)+"&CreditingDate="+encodeURIComponent(e.form.CreditingDate.value)+"&Email="+encodeURIComponent(e.form.Email.value)+"&PhoneNumber="+encodeURIComponent(e.form.PhoneNumber.value)+"&ContactPerson="+encodeURIComponent(e.form.ContactPerson.value)+"&EmployeeArrayString="+encodeURIComponent(e.form.EmployeeRowList.value)+"&StateCodeId="+encodeURIComponent(e.form.StateCodeId.value)+"&TextFormat="+encodeURIComponent(i),a=window.location.origin+"/PayrollSettings/Payroll/TxtGenerate?"+t,l=new XMLHttpRequest;l.open("GET",a,!0),l.responseType="blob",l.onload=function(){if(l.status===200){var u=l.response;let c=window.URL.createObjectURL(u),r=document.createElement("a");r.style.display="none",r.href=c;var f=`${e.form.TextType.text}.txt`;r.download=f,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(c)}else(0,Q.notifyError)("Error encounter when downloading Payslip Pdf")},l.send()}}),o}dialogOpen(e){super.dialogOpen();var o=this;(0,Q.serviceCall)({service:pe.baseUrl+"/GetTodayDateTime",method:"GET",data:{},async:!1,onSuccess:d=>{o.dateString=d,le.List({},E=>{var I=new Date(o.dateString),x=I.getMonth(),B=I.getFullYear(),W=0;for(var U in E.Entities)if(E.Entities[U].IsActive==1){W=E.Entities[U].PayDay;break}})}}),this.saveAndCloseButton.hide(),this.editButton.hide(),this.applyChangesButton.hide(),this.deleteButton.hide(),this.localizationButton.hide(),this.cloneButton.hide(),this.undeleteButton.hide();var i=document.getElementById(this.idPrefix+"PayMonth"),t=document.getElementById(this.idPrefix+"PayYear");let a=new ee.Select2Editor($(i)),l=new ee.Select2Editor($(t)),u=["January","February","March","April","May","June","July","August","September","October","November","December"];var f=new Date(o.dateString),c=f.getFullYear(),r=f.getMonth();for(let d=0;d<u.length;d++)a.addItem({id:d.toString(),text:u[d].toString()});a.set_value(r.toString());for(let d=-1;d<2;d++)l.addItem({id:(c+d).toString(),text:(c+d).toString()});l.set_value(c.toString());var p=document.getElementById(this.idPrefix+"TextType");$(".TextFormatEisSocsoId, .TextFormatEpfId, .TextFormatAutopayId, .TextFormatLhdnId").hide(),$(p).on("change",function(){return g(this,null,function*(){if($(".Email, .PhoneNumber, .ContactPerson, .CreditingDate, .OrganisationName, .OrganisationCode, .StateCodeId").hide(),$(".TextFormatEisSocsoId, .TextFormatEpfId, .TextFormatAutopayId, .TextFormatLhdnId").hide(),parseInt(o.form.TextType.value)==3 .valueOf())o.form.Email.value=o.Email,o.form.PhoneNumber.value=o.PhoneNumber,o.form.ContactPerson.value=o.ContactPerson,$(".Email, .PhoneNumber, .ContactPerson").show(),$(".TextFormatLhdnId").show();else if(parseInt(o.form.TextType.value)==5 .valueOf()){$(".TextFormatAutopayId").show();var d=new Date(c,r,o.payDay);o.form.CreditingDate.value=d.toString(),o.form.OrganisationName.value=o.OrganisationName,o.form.OrganisationCode.value=o.OrganisationCode,$(" .CreditingDate, .OrganisationName, .OrganisationCode").show()}else if(parseInt(o.form.TextType.value)==1 .valueOf()){$(".TextFormatEpfId").show();var d=new Date(c,r,o.payDay),E=d.getFullYear().toString(),I=(d.getMonth()+1).toString(),x=d.getDate().toString(),B=I.padStart(2,"0")+"/"+x.padStart(2,"0")+"/"+E;o.form.CreditingDate.value=B,$(" .CreditingDate, .StateCodeId").show()}else(parseInt(o.form.TextType.value)==2 .valueOf()||parseInt(o.form.TextType.value)==4 .valueOf())&&$(".TextFormatEisSocsoId").show()})});var h=document.getElementById(this.idPrefix+"SectionList"),v=document.getElementById(this.idPrefix+"OccupationList"),y=document.getElementById(this.idPrefix+"DepartmentList"),P=document.getElementById(this.idPrefix+"DivisionList"),b=document.getElementById(this.idPrefix+"JobGradeList");console.log(this.idPrefix),$(`#s2id_${this.idPrefix}EmployeeRowList`).on("click",function(d){return g(this,null,function*(){$(".select2-drop").hide()})}),$(i).on("change",function(){return g(this,null,function*(){((0,S.isEmptyOrNull)($(i).val())||(0,S.isEmptyOrNull)($(t).val()))&&(o.form.EmployeeRowList.value=""),o.AllButton()})}),$(t).on("change",function(){return g(this,null,function*(){((0,S.isEmptyOrNull)($(i).val())||(0,S.isEmptyOrNull)($(t).val()))&&(o.form.EmployeeRowList.value=""),o.AllButton()})}),$(v).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(P).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(b).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(y).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(h).on("change",function(){return g(this,null,function*(){o.AllButton()})});var A=document.getElementById(this.idPrefix+"All");$(A).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(i).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(t).on("change",function(){return g(this,null,function*(){o.AllButton()})}),$(".Email, .PhoneNumber, .ContactPerson, .CreditingDate, .OrganisationName, .OrganisationCode, .StateCodeId, .TextFormatId").hide()}AllButton(){var e=this;if(e.form.All.value==!0){let t=[];for(var o in e.EmployeeData){var i=e.form.EmployeeRowListBuffer.value;i!=""?i.includes(",")?(i.split(",").forEach(l=>{t.push(parseInt(l))}),t.indexOf(e.EmployeeData[o].Id)===-1&&(e.form.EmployeeRowListBuffer.value=e.form.EmployeeRowListBuffer.value+" , "+e.EmployeeData[o].Id.toString())):e.form.EmployeeRowListBuffer.value=e.form.EmployeeRowListBuffer.value+" , "+e.EmployeeData[o].Id.toString():e.form.EmployeeRowListBuffer.value=e.EmployeeData[o].Id.toString()}e.SearchEmployeeCallback()}else e.SearchCallback(),e.SearchEmployeeCallback()}getDialogOptions(){let e=super.getDialogOptions();return e.width=e.width+100,e}SearchCallback(){var e=this,o=document.getElementById(this.idPrefix+"PayMonth"),i=document.getElementById(this.idPrefix+"PayYear"),t=document.getElementById(this.idPrefix+"OccupationList"),a=document.getElementById(this.idPrefix+"DepartmentList"),l=document.getElementById(this.idPrefix+"DivisionList"),u=document.getElementById(this.idPrefix+"JobGradeList"),f=document.getElementById(this.idPrefix+"SectionList");if((0,S.isEmptyOrNull)($(o).val())||(0,S.isEmptyOrNull)($(i).val())){this.form.EmployeeRowList.value=this.form.EmployeeRowListBuffer.value="";return}function c(I){let x=$(I).val();return x.length?x.split(",").map(B=>parseInt(B,10)):[]}O(c,"parseListFromElement");let r=c(u),p=c(l),h=c(a),v=c(t),y=c(f),P=new Set(r),b=new Set(p),A=new Set(h),d=new Set(v),E=new Set(y);for(let I of e.EmployeeData){let{JobGradeID:x,DivisionID:B,DepartmentID:W,OccupationID:U,SectionID:Ie,Id:q}=I,De=P.has(x)||b.has(B)||A.has(W)||d.has(U)||E.has(Ie),te=e.form.EmployeeRowListBuffer.value,k=te?te.split(",").map(Number):[];De?k.includes(q)||k.push(q):k=k.filter(Le=>Le!==q),e.form.EmployeeRowListBuffer.value=k.join(",")}}SearchEmployeeCallback(){var e=this,o=document.getElementById(this.idPrefix+"EmployeeRowListBuffer"),i=$(o).val();let t=i.split(","),a=[];i.length&&t.forEach(p=>{a.push(parseInt(p))});var l=document.getElementById(this.idPrefix+"PayMonth"),u=document.getElementById(this.idPrefix+"PayYear"),f=$(u).val(),c=$(l).val(),r;e.form.EmployeeRowList.value="",C.List({Criteria:T.Criteria.and(r,[[s.Fields.PayYear],"=",e.form.PayYear.value],[[s.Fields.PayMonth],"=",e.form.PayMonth.value])},p=>{console.log(a);for(var h in p.Entities){var v=p.Entities[h].EmployeeRowId,y=p.Entities[h].PayMonth,P=p.Entities[h].PayYear;console.log(v),a.indexOf(v)!=-1&&y==c&&P==f&&(console.log(v),e.form.EmployeeRowList.value=v+" , "+e.form.EmployeeRowList.value)}})}};O(R,"TextDownloadingWizardDialog"),R=Y([T.Decorators.registerClass("HRMSoftware.PayrollSettings.TextDownloadingWizardDialog")],R);var F=class extends N.EntityGrid{constructor(e){super(e)}getColumnsKey(){return se.columnsKey}getDialogType(){return he}getRowDefinition(){return s}getService(){return C.baseUrl}getAddButtonCaption(){return"Create Employee Payroll"}getQuickFilters(){let e=super.getQuickFilters();return L.Authorization.hasPermission(M.HumanResources)&&(e.push({cssClass:"hidden-xs",field:s.Fields.CostCentreName,type:m.Select2Editor,title:"Cost Centre"}),e.push({cssClass:"hidden-xs",field:s.Fields.OccupationName,type:m.Select2Editor,title:"Occupation"}),e.push({cssClass:"hidden-xs",field:s.Fields.JobGradeName,type:m.Select2Editor,title:"Job Grade"}),e.push({cssClass:"hidden-xs",field:s.Fields.DivisionName,type:m.Select2Editor,title:"Division"}),e.push({cssClass:"hidden-xs",field:s.Fields.DepartmentName,type:m.Select2Editor,title:"Department"}),e.push({cssClass:"hidden-xs",field:s.Fields.SectionName,type:m.Select2Editor,title:"Section"}),e.push({cssClass:"hidden-xs",field:s.Fields.EmployeeName,type:m.Select2Editor,title:"Name"}),e.push({cssClass:"hidden-xs",field:s.Fields.EmployeeId,type:m.Select2Editor,title:"Employee ID"}),e.reverse()),e.push({cssClass:"hidden-xs",field:s.Fields.PayMonth,type:m.Select2Editor,title:"Pay Month"}),e.push({cssClass:"hidden-xs",field:s.Fields.PayYear,type:m.Select2Editor,title:"Pay Year"}),e}createQuickFilters(){let e=["January","February","March","April","May","June","July","August","September","October","November","December"];super.createQuickFilters(),L.Authorization.hasPermission(M.HumanResources)?(ne.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.OccupationName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})}),ae.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.JobGradeName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})}),ie.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.DepartmentName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})}),oe.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.DivisionName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})}),re.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.SectionName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})}),G.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.EmployeeName).items.push({id:i.Entities[t].EmployeeName.toString(),text:i.Entities[t].EmployeeName.toString()}),this.findQuickFilter(m.Select2Editor,s.Fields.EmployeeId).items.push({id:i.Entities[t].EmployeeID.toString(),text:i.Entities[t].EmployeeID.toString()})}),Pe.List({},i=>{for(var t in i.Entities)this.findQuickFilter(m.Select2Editor,s.Fields.CostCentreName).items.push({id:i.Entities[t].Name.toString(),text:i.Entities[t].Name.toString()})})):this.toolbar.findButton("add-button").toggle(!1);for(var o in e)this.findQuickFilter(m.Select2Editor,s.Fields.PayMonth).items.push({id:o.toString(),text:e[o].toString()});C.List({},i=>{let t=[];for(var a in i.Entities)t.indexOf(i.Entities[a].PayYear)==-1&&t.push(i.Entities[a].PayYear);for(var a in t)this.findQuickFilter(m.Select2Editor,s.Fields.PayYear).items.push({id:t[a].toString(),text:t[a].toString()})})}onViewProcessData(e){var o=this;if(e=super.onViewProcessData(e),L.Authorization.hasPermission(M.HumanResources)){var i=e;if(!(0,L.isEmptyOrNull)($(this.toolbar.findButton("add-button")).attr("style"))){var t=document.querySelectorAll(".text-bg-warning");t.forEach(function(r){$(r).hide()});var a=document.querySelectorAll(".text-bg-success");a.forEach(function(r){$(r).hide()})}for(var l in e.Entities)if((0,L.isEmptyOrNull)(e.Entities[l].PayslipPath)){var u="PayrollRowId="+encodeURIComponent(e.Entities[l].Id),f=window.location.origin+"/PayrollSettings/Payroll/PdfSharpConvert?"+u,c=new XMLHttpRequest;c.open("GET",f,!0),c.send(),C.Update({EntityId:e.Entities[l].Id,Entity:{PayslipPath:"Payroll\\Payslip\\"+e.Entities[l].Id+".pdf"}})}(0,n.serviceCall)({service:C.baseUrl+"/AskGenerationOfPayslip",method:"GET",data:{},async:!1,onSuccess:r=>{if(r[0]==1){let v=["January","February","March","April","May","June","July","August","September","October","November","December"];var p=r[1],h=r[2];(0,n.confirm)("Do you want to generate payslip for "+r[2]+" "+v[r[1]],()=>{(0,n.serviceCall)({service:C.baseUrl+"/LogGeneration",method:"GET",data:{Month:p,Year:h},async:!1,onSuccess:y=>{var P=new Z;P.dialogOpen(),P.element.on("dialogclose",function(){o.internalRefresh()})},onError:y=>{console.log(y.Error)}})},{onNo:()=>{(0,n.serviceCall)({service:C.baseUrl+"/LogGeneration",method:"GET",data:{Month:p,Year:h},async:!1,onSuccess:y=>{},onError:y=>{console.log(y.Error)}}),(0,n.notifyInfo)("You can run the payroll generation wizard anytime")}})}},onError:r=>{console.log(r.Error)}}),this.toolbar.findButton("column-picker-button").toggle(!1)}return i}getButtons(){var e=super.getButtons(),o=this;return L.Authorization.hasPermission(M.HumanResources)&&(D.List({},i=>{i.Entities.length>0?K.List({},t=>{t.Entities.length>0?J.List({},a=>{a.Entities.length>0?X.List({},l=>{l.Entities.length>0?J.List({},u=>{u.Entities.length>0?_.List({},f=>{f.Entities.length<=0&&(this.toolbar.findButton("add-button").toggle(!1),(0,n.notifyError)("Please complete PCB subjection form before using payroll function"))}):(this.toolbar.findButton("add-button").toggle(!1),(0,n.notifyError)("Please complete EIS subjection form before using payroll function"))}):((0,n.notifyError)("Please complete HRDF subjection form before using payroll function"),this.toolbar.findButton("add-button").toggle(!1))}):((0,n.notifyError)("Please complete EIS subjection form before using payroll function"),this.toolbar.findButton("add-button").toggle(!1))}):((0,n.notifyError)("Please complete EPF subjection form before using payroll function"),this.toolbar.findButton("add-button").toggle(!1))}):((0,n.notifyError)("Please complete Payroll Settings form before using payroll function"),this.toolbar.findButton("add-button").toggle(!1))}),e.push({title:"Payroll Settings",cssClass:"fas fa-wrench text-bg-primary",onClick:i=>{(0,n.confirm)("Do you want to edit payroll settings?",()=>{var t=new ge;D.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()})})}}),e.push({title:"Payroll Generator",cssClass:"fas fa-hat-wizard text-bg-success",onClick:i=>{(0,n.confirm)("Do you want to run payroll generating wizard",()=>{var t=new Z;t.dialogOpen(),t.element.on("dialogclose",function(){o.internalRefresh()})})}}),e.push({title:"Payroll Download",cssClass:"fas fa-hat-wizard text-bg-warning",onClick:i=>{(0,n.confirm)("Do you want to run payroll download wizard",()=>{var t=new ye(null,null,null);t.dialogOpen()})},separator:!0}),e.push({title:"Payroll Batch Delete",cssClass:"fas fa-hat-wizard text-bg-danger",onClick:i=>{(0,n.confirm)("Do you want to delete all selected payslips?",()=>{let t=[];$(".select-row-checkbox:checked").each(function(){let a=$(this).data("id"),l=C.Delete({EntityId:a}).then(()=>{console.log("Deleted Data ID:",a)}).catch(u=>{console.error("Error deleting Data ID:",a,u)});t.push(l)}),Promise.all(t).then(()=>{o.internalRefresh()}).catch(a=>{console.error("Error in delete operations:",a)})})},separator:!0}),e.push({title:"Download Text Report",cssClass:"fas fa-hat-wizard text-bg-info",onClick:i=>{(0,n.confirm)("Do you want to download text report?",()=>{var t=new R;t.dialogOpen(),t.element.on("dialogclose",function(){o.internalRefresh()})})},separator:!0}),e.push({title:"EPF Subjection",cssClass:"apply-changes-button",onClick:i=>{(0,n.confirm)("Do you want to set EPF Subjection",()=>{var t=new ve;K.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()})})},separator:!0}),e.push({title:"EIS Subjection",cssClass:"apply-changes-button",onClick:i=>{(0,n.confirm)("Do you want to set EPF Subjection",()=>{var t=new Ee;J.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()}),t.element.on("dialogclose",function(){})})},separator:!0}),e.push({title:"HRDF Subjection",cssClass:"apply-changes-button",onClick:i=>{(0,n.confirm)("Do you want to set HRDF Subjection",()=>{var t=new Se;X.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()}),t.element.on("dialogclose",function(){})})},separator:!0}),e.push({title:"PCB Subjection",cssClass:"apply-changes-button",onClick:i=>{(0,n.confirm)("Do you want to set PCB Subjection",()=>{var t=new fe;_.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()}),t.element.on("dialogclose",function(){})})},separator:!0}),e.push({title:"Socso Subjection",cssClass:"apply-changes-button",onClick:i=>{(0,n.confirm)("Do you want to set Socso Subjection",()=>{var t=new ue;me.List({},a=>{a.Entities.length>0?t.loadByIdAndOpenDialog(a.Entities[0].Id):t.dialogOpen()}),t.element.on("dialogclose",function(){})})},separator:!0})),e}onClick(e,o,i){if(super.onClick(e,o,i),!e.isDefaultPrevented()){var t=this.itemAt(o),a=$(e.target);a.parent().hasClass("inline-action")&&(a=a.parent()),a.hasClass("download-payroll")&&(0,n.confirm)("Do you want to download Payroll?",()=>{var l=t.Id,u=t.PayDate,f=new Date(u),c=f.toLocaleString("en-US",{month:"long"}),r=f.getFullYear().toString(),p=t.EmployeeRowId;G.Retrieve({EntityId:p},h=>{var v=h.Entity.EmployeeName.replace(/\s/g,""),y="PayrollRowId="+encodeURIComponent(l),P=window.location.origin+"/PayrollSettings/Payroll/PdfSharpConvert?"+y,b=new XMLHttpRequest;b.open("GET",P,!0),b.responseType="blob",b.onload=function(){if(b.status===200){var A=b.response;let d=window.URL.createObjectURL(A),E=document.createElement("a");E.style.display="none",E.href=d,E.download=v+"Payslip"+c+r+".pdf",E.click(),(0,n.notifySuccess)("Payslip downloaded")}else(0,n.notifyError)("Error encounter when downloading Payslip Pdf")},b.send()})})}}createToolbarExtensions(){super.createToolbarExtensions(),this.rowSelection=new N.GridRowSelectionMixin(this,{selectable:e=>(console.log(e),!0)})}getColumns(){var e=super.getColumns();return e.splice(2,0,{field:"Download Payroll",name:"",format:o=>{var i='<a class="inline-action download-payroll" title="Download Payroll pdf"><i class="fa fa-download text-yellow"></i></a>';return i},width:12,minWidth:12,maxWidth:12}),e.splice(0,0,{name:"",field:"",cssClass:"select-row-checkbox",format:o=>`<input type="checkbox" class="select-row-checkbox" data-id="${o.item.Id}" />`,width:40}),e}};O(F,"PayrollGrid"),F=Y([N.Decorators.registerClass("HRMSoftware.PayrollSettings.PayrollGrid")],F);function xe(){(0,be.initFullHeightGridPage)(new F($("#GridDiv")).element)}O(xe,"pageInit");export{xe as default};
//# sourceMappingURL=PayrollPage.js.map
