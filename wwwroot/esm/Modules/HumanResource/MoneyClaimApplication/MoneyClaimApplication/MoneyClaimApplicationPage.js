import{t as H}from"../../../../_chunks/chunk-ZO5M45KF.js";import{a as F,c as s,d as E}from"../../../../_chunks/chunk-CICJSBLQ.js";import{d as g}from"../../../../_chunks/chunk-KXMTVQGO.js";import"../../../../_chunks/chunk-GYFJ4L6D.js";import"../../../../_chunks/chunk-T7E74GLF.js";import"../../../../_chunks/chunk-6XVG2SV4.js";import{a as u}from"../../../../_chunks/chunk-27W64ILM.js";import"../../../../_chunks/chunk-3NATHMDL.js";import{l as k}from"../../../../_chunks/chunk-RTQCGMRU.js";import{f as C,j as N,n as A}from"../../../../_chunks/chunk-MVZ476J5.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import{a as I}from"../../../../_chunks/chunk-LLMDZJQJ.js";import{b}from"../../../../_chunks/chunk-J5PFZI4S.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as x}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as D,g as S,h as w,k as v}from"../../../../_chunks/chunk-L3ECGIWB.js";var P=S(v(),1);var r=S(x(),1);var i=S(v(),1);var y=class extends r.EntityGrid{constructor(t){super(t)}getColumnsKey(){return F.columnsKey}getDialogType(){return H}getRowDefinition(){return s}getService(){return E.baseUrl}getQuickFilters(){let t=super.getQuickFilters();return i.Authorization.hasPermission(u.HumanResources)&&(t.push({cssClass:"hidden-xs",field:s.Fields.OccupationName,type:r.Select2Editor,title:"Occupation"}),t.push({cssClass:"hidden-xs",field:s.Fields.JobGradeName,type:r.Select2Editor,title:"Job Grade"}),t.push({cssClass:"hidden-xs",field:s.Fields.DivisionName,type:r.Select2Editor,title:"Division"}),t.push({cssClass:"hidden-xs",field:s.Fields.DepartmentName,type:r.Select2Editor,title:"Department"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeName,type:r.Select2Editor,title:"Name"}),t.push({cssClass:"hidden-xs",field:s.Fields.EmployeeID,type:r.Select2Editor,title:"Employee ID"}),t.push({cssClass:"hidden-xs",field:s.Fields.CostCentreName,type:r.Select2Editor,title:"Cost Centre"}),t.reverse()),t}createQuickFilters(){if(super.createQuickFilters(),i.Authorization.hasPermission(u.HumanResources)){let t=["January","February","March","April","May","June","July","August","September","October","November","December"];A.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.OccupationName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),N.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.JobGradeName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),I.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DepartmentName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),C.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.DivisionName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})}),b.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeName).items.push({id:e.Entities[o].EmployeeName.toString(),text:e.Entities[o].EmployeeName.toString()}),this.findQuickFilter(r.Select2Editor,s.Fields.EmployeeID).items.push({id:e.Entities[o].EmployeeID.toString(),text:e.Entities[o].EmployeeID.toString()})}),k.List({},e=>{for(var o in e.Entities)this.findQuickFilter(r.Select2Editor,s.Fields.CostCentreName).items.push({id:e.Entities[o].Name.toString(),text:e.Entities[o].Name.toString()})})}}getButtons(){var t=super.getButtons(),e=this;return t.push({title:"Money Claim Batch Approve",cssClass:"fas fa-hat-wizard text-bg-success approveButton",onClick:o=>{(0,i.confirm)("Do you want to approve all selected applications?",()=>{let d=e.rowSelection.getSelectedAsInt64().map(l=>E.Retrieve({EntityId:l}).then(p=>{let c=p.Entity.EmployeeStatus,m=p.Entity.HrStatus,R=p.Entity.Id,a=p.Entity.EmployeeRowId,n={};return new Promise((f,h)=>{(0,i.serviceCall)({service:g.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:a},method:"GET",onSuccess:U=>{i.Authorization.userDefinition.Permissions[u.HumanResources]?U==!0?c===2||m===2?c===2?n={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:m===2&&(n={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):m===1?n={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:c===1?n={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:1,HrStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={HrStatus:1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:n={EmployeeStatus:1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},console.log(n),E.Update({EntityId:R,Entity:n}).then(f).catch(h)},onError:h})})}));Promise.all(d).then(()=>{e.internalRefresh()}).catch(l=>{console.error("Error in update operations:",l)})})},separator:!0}),t.push({title:"Money Claim Batch Reject",cssClass:"fas fa-hat-wizard text-bg-danger rejectButton",onClick:o=>{(0,i.confirm)("Do you want to reject all selected applications?",()=>{let d=e.rowSelection.getSelectedAsInt64().map(l=>E.Retrieve({EntityId:l}).then(p=>{let c=p.Entity.EmployeeStatus,m=p.Entity.HrStatus,R=p.Entity.Id,a={},n=p.Entity.EmployeeRowId;(0,i.serviceCall)({service:g.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:n},method:"GET",async:!1,onSuccess:f=>{console.log(f);var h=f;return i.Authorization.userDefinition.Permissions[u.HumanResources]?h==!0?c==2||m==2?c==2?a={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:m==2&&(a={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}):m==0?a={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:c==0?a={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID,HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={HrStatus:-1,HrUpdated:i.Authorization.userDefinition.EmployeeRowID}:a={EmployeeStatus:-1,EmployeeUpdated:i.Authorization.userDefinition.EmployeeRowID},E.Update({EntityId:R,Entity:a})}})}));Promise.all(d).then(()=>{e.internalRefresh()}).catch(l=>{console.error("Error in update operations:",l)})})},separator:!0}),t}createToolbarExtensions(){super.createToolbarExtensions(),this.rowSelection=new r.GridRowSelectionMixin(this,{selectable:t=>{var e=0,o;for((0,i.serviceCall)({service:g.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:i.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:t.EmployeeRowId},method:"GET",async:!1,onSuccess:l=>{e=1,console.log(l),o=l}});e==0;);let d=i.Authorization.hasPermission(u.HumanResources);if(t.Status==0){if(t.EmployeeRowId==i.Authorization.userDefinition.EmployeeRowID||d&&t.HrStatus==2)return;if(d&&t.HrStatus==0||o&&t.EmployeeStatus==0)return $(".approveButton, .rejectButton").show(),!0}}}),$(document).on("click",".select-item.check-box.no-float",function(){$(".select-item.check-box.no-float").parent().parent().removeClass("highlighted-row"),$(".select-item.check-box.no-float.checked").parent().parent().addClass("highlighted-row")}),$("<style>").prop("type","text/css").html(`
            .slick-row.highlighted-row {
                background-color: #D3E5FF !important;
            }
        `).appendTo("head")}getColumns(){var t=super.getColumns(),e;if(t.unshift(r.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection)),!i.Authorization.hasPermission(u.HumanResources))for(e in t)(t[e].name==s.Fields.EmployeeID||t[e].name==s.Fields.ApprovedBy)&&t.splice(e,1);return t}onViewSubmit(){return this.slickGrid.onHeaderCellRendered.subscribe((t,e)=>{e.column.id==="SelectAll"&&$(e.node).empty().append("<input type='checkbox' id='selectAll'/>")}),$(document).on("change","#selectAll",function(){let t=$(this).prop("checked");$(".row-checkbox").prop("checked",t)}),super.onViewSubmit()}createEntityDialog(t,e){let o=super.createEntityDialog(t,e);var d=this;return o.element.on("dialogclose",()=>{d.internalRefresh(),console.log("hahaa")}),o}onViewProcessData(t){return t=super.onViewProcessData(t),$(".approveButton, .rejectButton").hide(),this.toolbar.findButton("column-picker-button").toggle(!1),t}getAddButtonCaption(){return"Apply money claiming"}};D(y,"MoneyClaimApplicationGrid"),y=w([r.Decorators.registerClass("HRMSoftware.MoneyClaimApplication.MoneyClaimApplicationGrid")],y);function M(){(0,P.initFullHeightGridPage)(new y($("#GridDiv")).element)}D(M,"pageInit");export{M as default};
//# sourceMappingURL=MoneyClaimApplicationPage.js.map
