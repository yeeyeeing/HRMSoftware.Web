import{k as T,l as g,m as f,n as d}from"../../../../_chunks/chunk-QIDIFHUV.js";import"../../../../_chunks/chunk-7GGACY5T.js";import"../../../../_chunks/chunk-HERT6KZV.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import"../../../../_chunks/chunk-TIB4BNCY.js";import"../../../../_chunks/chunk-TYRFK7TU.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as E}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as a,g as c,h as s,j as h,k as y}from"../../../../_chunks/chunk-L3ECGIWB.js";var w=c(y(),1);var v=c(E(),1);var m=c(E(),1);var A=c(y(),1),I=c(y(),1);var r=class extends m.EntityDialog{constructor(){super();this.form=new g(this.idPrefix);var e=this,n=document.createElement("link");n.rel="stylesheet",n.href="https://cdn.jsdelivr.net/npm/clocklet@0.3.0/css/clocklet.min.css";var i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/clocklet@0.3.0",document.head.appendChild(n),document.head.appendChild(i);var t=$(".fieldset").children().attr("id");let p="PropertyGrid",l="AnnouncementTime",R=t.lastIndexOf(p);if(R!==-1)var S=t.substring(0,R)+l;var u=document.getElementById(S);u.setAttribute("data-clocklet",""),u.setAttribute("id","announcement-clocklet"),u.addEventListener("clocklet.opening",function(b){var k=document.getElementById("announcement-clocklet");k&&(k.style.zIndex=Number.MAX_SAFE_INTEGER.toString())}),u.addEventListener("clocklet.closed",function(b){e.GenerateRemarks()})}getFormKey(){return g.formKey}getRowDefinition(){return f}getService(){return d.baseUrl}onDialogOpen(){super.onDialogOpen();var e=this;m.EditorUtils.setReadonly(this.form.Remarks.element,!0);var n=$("#announcement-clocklet"),i=new Date;this.isNew()?($(".AnnouncementDateTime").hide(),$(".AnnouncementTime").hide(),n.val("12:00"),e.form.AnnouncementDateTime.value=i.toISOString()):($(".AnnouncementDateTime").hide(),$(".AnnouncementTime").hide(),$(".Immediate").hide(),$(".Delayed").hide(),$(".Remarks").parent().hide(),d.Retrieve({EntityId:e.entityId},l=>{console.log(l.Entity),(!(0,I.isEmptyOrNull)(l.Entity.GeneratedRecurringId)||!(0,I.isEmptyOrNull)(l.Entity.GeneratedWizardId))&&m.EditorUtils.setReadonly(this.form.Remarks.element,!0)}));var t=document.getElementById(this.idPrefix+"Immediate"),p=document.getElementById(this.idPrefix+"Delayed");$(t).on("change",function(){return h(this,null,function*(){e.form.Immediate.value==!0&&e.form.Delayed.value==!0&&(e.form.Delayed.value=!1),e.form.Delayed.value==!0&&e.form.Immediate.value==!1?($(".AnnouncementTime").show(),$(".AnnouncementDateTime").show(),e.GenerateRemarks()):(e.form.Delayed.value==!1&&e.form.Immediate.value==!0,$(".AnnouncementTime").hide(),$(".AnnouncementDateTime").hide(),e.GenerateRemarks())})}),$(p).on("change",function(){return h(this,null,function*(){e.form.Immediate.value==!0&&e.form.Delayed.value==!0&&(e.form.Immediate.value=!1),e.form.Delayed.value==!0&&e.form.Immediate.value==!1?($(".AnnouncementTime").show(),$(".AnnouncementDateTime").show(),e.GenerateRemarks()):(e.form.Delayed.value==!1&&e.form.Immediate.value==!0,$(".AnnouncementTime").hide(),$(".AnnouncementDateTime").hide(),e.GenerateRemarks())})})}GenerateRemarks(){var e=this,n="The announcement will be sent at ",i=document.getElementById("announcement-clocklet"),t="";e.form.Immediate.value==!0?t="The announcement will be made to the employee immediately":e.form.Delayed.value==!0?t=n+e.form.AnnouncementDateTime.value+" "+i.value+":00":t="",e.form.Remarks.value=t}save_submitHandler(e){if(this.form.Remarks.value==""){(0,A.alertDialog)("Invalid settings, please check again");return}if(this.form.EmployeeRowId.value==""){(0,A.alertDialog)("No employee chosen");return}super.save_submitHandler(e)}};a(r,"AnnouncementGeneratedDialog"),r=s([m.Decorators.registerClass("HRMSoftware.Announcement.AnnouncementGeneratedDialog")],r);var o=class extends v.EntityGrid{getColumnsKey(){return T.columnsKey}getDialogType(){return r}getRowDefinition(){return f}getService(){return d.baseUrl}getAddButtonCaption(){return"Generate Annnouncements"}constructor(D){super(D)}};a(o,"AnnouncementGeneratedGrid"),o=s([v.Decorators.registerClass("HRMSoftware.Announcement.AnnouncementGeneratedGrid")],o);function x(){(0,w.initFullHeightGridPage)(new o($("#GridDiv")).element)}a(x,"pageInit");export{x as default};
//# sourceMappingURL=AnnouncementGeneratedPage.js.map
