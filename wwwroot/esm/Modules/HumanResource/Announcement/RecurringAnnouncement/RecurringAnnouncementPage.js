import{H as J,I as x,J as B,K as R}from"../../../../_chunks/chunk-QIDIFHUV.js";import"../../../../_chunks/chunk-7GGACY5T.js";import"../../../../_chunks/chunk-HERT6KZV.js";import"../../../../_chunks/chunk-DMDSRNFC.js";import"../../../../_chunks/chunk-TIB4BNCY.js";import{b as H}from"../../../../_chunks/chunk-TYRFK7TU.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as W}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as D,g as b,h as P,j as l,k as F}from"../../../../_chunks/chunk-L3ECGIWB.js";var M=b(F(),1);var O=b(W(),1);var I=b(W(),1),G=b(F(),1);var v=class extends I.EntityDialog{constructor(){super();this.form=new x(this.idPrefix);var e=this,i=document.createElement("link");i.rel="stylesheet",i.href="https://cdn.jsdelivr.net/npm/clocklet@0.3.0/css/clocklet.min.css";var s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/clocklet@0.3.0",document.head.appendChild(i),document.head.appendChild(s);var o=$(".fieldset").children().attr("id");let a="PropertyGrid",u="RecurringTime",c=o.lastIndexOf(a);if(c!==-1)var m=o.substring(0,c)+u;var t=document.getElementById(m);t.setAttribute("data-clocklet",""),t.setAttribute("id","recurring-clocklet"),t.addEventListener("clocklet.opening",function(p){var y=document.getElementById("recurring-clocklet");y&&(y.style.zIndex=Number.MAX_SAFE_INTEGER.toString())}),t.addEventListener("clocklet.closed",function(p){e.GenerateRemarks()}),$(".AnnouncementDateTime").hide(),$(".AnnouncementTime").hide(),H.List({},p=>{e.EmployeeData=p.Entities})}getFormKey(){return x.formKey}getRowDefinition(){return B}getService(){return R.baseUrl}onDialogOpen(){super.onDialogOpen(),I.EditorUtils.setReadonly(this.form.Remarks.element,!0),$(".OccupationList").hide(),$(".JobGradeList").hide(),$(".DivisionList").hide(),$(".DepartmentList").hide(),$(".SectionList").hide(),$(".EmployeeRowList").hide(),this.editButton.hide(),this.applyChangesButton.hide(),this.deleteButton.hide(),this.localizationButton.hide(),this.cloneButton.hide(),this.undeleteButton.hide();var e=this,i=$("#recurring-clocklet"),s=new Date;this.isNew()?($(".AnnouncementList").parent().parent().parent().hide(),i.val("12:00"),e.form.StartingDateTime.value=s.toISOString(),$(".Sunday").parent().hide(),$(".IntervalInDays").parent().hide(),e.StartCallBack()):(R.Retrieve({EntityId:e.entityId},o=>{var a=o.Entity.StartingDateTime.substring(11,16);i.val(a),e.StartCallBack()}),e.form.DaysPerRecurring.value==!0?$(".Sunday").parent().hide():e.form.DaysOfWeekRecurring.value==!0&&$(".IntervalInDays").parent().hide())}SearchCallback(){var e=this,i=document.getElementById(this.idPrefix+"OccupationListActual"),s=document.getElementById(this.idPrefix+"DepartmentListActual"),o=document.getElementById(this.idPrefix+"DivisionListActual"),a=document.getElementById(this.idPrefix+"JobGradeListActual"),u=document.getElementById(this.idPrefix+"SectionListActual"),c=$(a).val();let m=[],t=c.split(",");c.length&&t.forEach(r=>{m.push(parseInt(r))});var p=$(o).val();t=p.split(",");let y=[];p.length&&t.forEach(r=>{y.push(parseInt(r))});var w=$(s).val();t=w.split(",");let L=[];w.length&&t.forEach(r=>{L.push(parseInt(r))});var f=$(i).val();t=f.split(",");let d=[];f.length&&t.forEach(r=>{d.push(parseInt(r))});var S=$(u).val();t=S.split(",");let k=[];S.length&&t.forEach(r=>{k.push(parseInt(r))});for(var n in e.EmployeeData){var g=0;for(var K in m)if(e.EmployeeData[n].JobGradeID==m[K]){g=1;break}for(var N in y)if(e.EmployeeData[n].DivisionID==y[N]){g=1;break}for(var _ in L)if(e.EmployeeData[n].DepartmentID==L[_]){g=1;break}for(var j in d)if(e.EmployeeData[n].OccupationID==d[j]){g=1;break}for(var U in k)if(e.EmployeeData[n].SectionID==k[U]){g=1;break}if(g==0){let r=[];var E=e.form.EmployeeListActual.value;E!=""?(E.split(",").forEach(A=>{r.push(parseInt(A))}),r=r.filter(A=>A!==e.EmployeeData[n].Id),e.form.EmployeeListActual.value=r.join(",")):e.form.EmployeeListActual.value=""}else{let r=[];var E=e.form.EmployeeListActual.value;E!=""?E.includes(",")?(E.split(",").forEach(z=>{r.push(parseInt(z))}),r.indexOf(e.EmployeeData[n].Id)===-1&&(e.form.EmployeeListActual.value=e.form.EmployeeListActual.value+" , "+e.EmployeeData[n].Id.toString())):e.form.EmployeeListActual.value=e.form.EmployeeListActual.value+" , "+e.EmployeeData[n].Id.toString():e.form.EmployeeListActual.value=e.EmployeeData[n].Id.toString()}}}StartCallBack(){var e=this,i=document.getElementById(this.idPrefix+"OccupationListActual"),s=document.getElementById(this.idPrefix+"DepartmentListActual"),o=document.getElementById(this.idPrefix+"DivisionListActual"),a=document.getElementById(this.idPrefix+"JobGradeListActual"),u=document.getElementById(this.idPrefix+"SectionListActual"),c=document.getElementById(this.idPrefix+"EmployeeListActual"),m=document.getElementById(this.idPrefix+"StartingDateTime"),t=document.getElementById(this.idPrefix+"DaysPerRecurring"),p=document.getElementById(this.idPrefix+"DaysOfWeekRecurring"),y=document.getElementById(this.idPrefix+"All");$(i).on("change",function(){return l(this,null,function*(){e.SearchCallback()})}),$(o).on("change",function(){return l(this,null,function*(){e.SearchCallback()})}),$(a).on("change",function(){return l(this,null,function*(){e.SearchCallback()})}),$(s).on("change",function(){return l(this,null,function*(){e.SearchCallback()})}),$(u).on("change",function(){return l(this,null,function*(){e.SearchCallback()})}),$(y).on("change",function(){return l(this,null,function*(){if(e.form.All.value==!0){let S=[];for(var f in e.EmployeeData){var d=e.form.EmployeeListActual.value;d!=""?d.includes(",")?(d.split(",").forEach(n=>{S.push(parseInt(n))}),S.indexOf(e.EmployeeData[f].Id)===-1&&(e.form.EmployeeListActual.value=e.form.EmployeeRowList.value+" , "+e.EmployeeData[f].Id.toString())):e.form.EmployeeListActual.value=e.form.EmployeeRowList.value+" , "+e.EmployeeData[f].Id.toString():e.form.EmployeeListActual.value=e.EmployeeData[f].Id.toString()}}else e.SearchCallback()})}),$(t).on("change",function(){return l(this,null,function*(){e.form.DaysOfWeekRecurring.value==!0&&e.form.DaysPerRecurring.value==!0&&(e.form.DaysOfWeekRecurring.value=!1),e.form.DaysPerRecurring.value==!0&&e.form.DaysOfWeekRecurring.value==!1?($(".Sunday").parent().hide(),$(".IntervalInDays").parent().show(),e.GenerateRemarks()):e.form.DaysPerRecurring.value==!1&&e.form.DaysOfWeekRecurring.value==!0?($(".IntervalInDays").parent().hide(),$(".Sunday").parent().show(),e.GenerateRemarks()):($(".IntervalInDays").parent().hide(),$(".Sunday").parent().hide(),e.GenerateRemarks())})}),$(p).on("change",function(){return l(this,null,function*(){e.form.DaysPerRecurring.value==!0&&e.form.DaysOfWeekRecurring.value==!0&&(e.form.DaysPerRecurring.value=!1),e.form.DaysPerRecurring.value==!0&&e.form.DaysOfWeekRecurring.value==!1?($(".Sunday").parent().hide(),$(".IntervalInDays").parent().show(),e.GenerateRemarks()):e.form.DaysPerRecurring.value==!1&&e.form.DaysOfWeekRecurring.value==!0?($(".IntervalInDays").parent().hide(),$(".Sunday").parent().show(),e.GenerateRemarks()):($(".IntervalInDays").parent().hide(),$(".Sunday").parent().hide(),e.GenerateRemarks())})}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].forEach(f=>{var d=document.getElementById(this.idPrefix+f);$(d).on("change",function(){return l(this,null,function*(){e.GenerateRemarks()})})});var L=document.getElementById(this.idPrefix+"IntervalInDays");$(L).on("change",function(){return l(this,null,function*(){e.GenerateRemarks()})}),$(m).on("change",function(){return l(this,null,function*(){e.GenerateRemarks()})})}save_submitHandler(e){if(this.form.Remarks.value==""){(0,G.alertDialog)("Invalid interval settings, please check again");return}if(this.form.EmployeeListActual.value==""){(0,G.alertDialog)("No employee chosen");return}super.save_submitHandler(e)}GenerateRemarks(){var e=this,i="The announcement will be sent at every ",s=" starting from ",o=document.getElementById("recurring-clocklet"),a="",u="",c=e.form.IntervalInDays.value;let m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];e.form.DaysOfWeekRecurring.value==!0?(m.forEach(t=>{e.form[t].value==!0&&(a=a==""?t:a+", "+t)}),a!=""&&(u=i+a+s+e.form.StartingDateTime.value+" "+o.value+":00")):e.form.DaysPerRecurring.value==!0&&c>0&&(a=c+" days ",u=i+a+s+e.form.StartingDateTime.value+" "+o.value+":00"),e.form.Remarks.value=u}};D(v,"RecurringAnnouncementDialog"),v=P([I.Decorators.registerClass("HRMSoftware.Announcement.RecurringAnnouncementDialog")],v);var h=class extends O.EntityGrid{getColumnsKey(){return J.columnsKey}getDialogType(){return v}getRowDefinition(){return B}getService(){return R.baseUrl}constructor(T){super(T)}};D(h,"RecurringAnnouncementGrid"),h=P([O.Decorators.registerClass("HRMSoftware.Announcement.RecurringAnnouncementGrid")],h);function Q(){(0,M.initFullHeightGridPage)(new h($("#GridDiv")).element)}D(Q,"pageInit");export{Q as default};
//# sourceMappingURL=RecurringAnnouncementPage.js.map
