import{a as Z,b as L,c as ee,d as y,e as D}from"../../../../_chunks/chunk-IFNCZ3M2.js";import{o as x}from"../../../../_chunks/chunk-GHIP3IPF.js";import{d as T}from"../../../../_chunks/chunk-2YJXBIYS.js";import{d as F}from"../../../../_chunks/chunk-GYFJ4L6D.js";import"../../../../_chunks/chunk-T7E74GLF.js";import{d as Y}from"../../../../_chunks/chunk-C45P7KJQ.js";import{d as X}from"../../../../_chunks/chunk-HDHDXEPW.js";import"../../../../_chunks/chunk-BVVXSYMS.js";import"../../../../_chunks/chunk-3FMYFY2A.js";import{a as g}from"../../../../_chunks/chunk-OAOSE5IN.js";import"../../../../_chunks/chunk-F3ZQHHES.js";import{l as q}from"../../../../_chunks/chunk-E5LOGLR4.js";import{f as K,j as J,n as V}from"../../../../_chunks/chunk-EM5O7OU6.js";import"../../../../_chunks/chunk-JXMDZA3A.js";import{a as z}from"../../../../_chunks/chunk-LLMDZJQJ.js";import{b as C}from"../../../../_chunks/chunk-J5PFZI4S.js";import"../../../../_chunks/chunk-K2UT2MVJ.js";import{a as W}from"../../../../_chunks/chunk-DNINIZJD.js";import{c as S,g as O,h as P,j as A,k as j}from"../../../../_chunks/chunk-L3ECGIWB.js";var te=O(j(),1);var f=O(W(),1);var I=O(W(),1);var p=O(j(),1);var M=O(j(),1),v=O(j(),1);var U=O(W(),1);var b=class extends U.EntityDialog{constructor(){super();this.form=new x(this.idPrefix);this.cloneButton.remove()}getFormKey(){return x.formKey}getRowDefinition(){return ee}getService(){return D.baseUrl}onDialogOpen(){super.onDialogOpen(),this.undeleteButton.remove(),this.applyChangesButton.remove(),this.deleteButton.remove(),this.localizationButton.remove()}save_submitHandler(t){window.rejectReason=this.form.RejectReason.value,this.dialogClose()}};S(b,"OTApplicationRejectDialog"),b=P([U.Decorators.registerClass("HRMSoftware.OTApplication.OTApplicationRejectDialog")],b);var k=class extends I.EntityDialog{constructor(){super();this.form=new L(this.idPrefix);this.ListOfPublicHolidayDate=[];var t=this;X.List({},a=>{var h;for(var R in a.Entities)a.Entities[R].IsActive==1&&(h=a.Entities[R].BasedCountry,this.SundayWeekday=a.Entities[R].SundayWeekday,this.MondayWeekday=a.Entities[R].MondayWeekday,this.TuesdayWeekday=a.Entities[R].TuesdayWeekday,this.WednesdayWeekday=a.Entities[R].WednesdayWeekday,this.ThursdayWeekday=a.Entities[R].ThursdayWeekday,this.FridayWeekday=a.Entities[R].FridayWeekday,this.SaturdayWeekday=a.Entities[R].SaturdayWeekday);Y.List({},w=>{for(var H in w.Entities)w.Entities[H].IsActive==1&&w.Entities[H].CountryCode.replace(/\s+/g,"")==h&&t.ListOfPublicHolidayDate.push(w.Entities[H].Date.substring(0,10))})});var e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/clocklet@0.3.0/css/clocklet.min.css";var i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/clocklet@0.3.0",document.head.appendChild(e),document.head.appendChild(i);var o=$(".fieldset").children().attr("id");let n="PropertyGrid",r="StartingAt",m="EndingAt",d=o.lastIndexOf(n);if(d!==-1)var E=o.substring(0,d)+r,s=o.substring(0,d)+m;var u=document.getElementById(E);u.setAttribute("data-clocklet",""),u.setAttribute("id","ot-start-clocklet"),u.addEventListener("clocklet.opening",function(a){let h=document.getElementById("ot-start-clocklet");h&&(h.style.zIndex=Number.MAX_SAFE_INTEGER.toString())}),u.addEventListener("clocklet.closed",function(a){});var c=document.getElementById(s);c.setAttribute("data-clocklet",""),c.setAttribute("id","ot-end-clocklet"),c.addEventListener("clocklet.opening",function(a){let h=document.getElementById("ot-end-clocklet");h&&(h.style.zIndex=Number.MAX_SAFE_INTEGER.toString())}),c.addEventListener("clocklet.closed",function(a){})}getFormKey(){return L.formKey}getRowDefinition(){return y}getService(){return D.baseUrl}calculateOtRate(t){function e(m){return new Date(m).getDay()}S(e,"getDayOfWeek");function i(m,d){let E=d.replace(/-/g,"");return m.some(s=>s.replace(/-/g,"").padEnd(8,"0")===E)}S(i,"isDateInArray");var o=this;if((0,v.isEmptyOrNull)(o.form.EmployeeRowId.value)||(0,v.isEmptyOrNull)(o.form.OtDate.value)){o.form.OtRate.value=null;return}if(t==!0){o.form.PublicHolidayOt.value=o.form.WeekendOt.value=o.form.WeekdayOt.value=!1;var n=i(o.ListOfPublicHolidayDate,o.form.OtDate.value);if(n==!0)o.form.PublicHolidayOt.value=!0;else{var r=e(o.form.OtDate.value);r==0&&o.SundayWeekday==!1||r==1&&o.MondayWeekday==!1||r==2&&o.TuesdayWeekday==!1||r==3&&o.WednesdayWeekday==!1||r==4&&o.ThursdayWeekday==!1||r==5&&o.FridayWeekday==!1||r==6&&o.SaturdayWeekday==!1?o.form.WeekendOt.value=!0:o.form.WeekdayOt.value=!0}}(0,v.serviceCall)({service:C.baseUrl+"/CalculateOtRate",data:{EmployeeRowID:o.form.EmployeeRowId.value,Date:o.form.OtDate.value},method:"GET",async:!1,onSuccess:m=>{if(console.log(m),o.form.WeekendOt.value==!0?o.form.OtRate.value=m.Entities[0].OtRateWeekend:o.form.WeekdayOt.value==!0?o.form.OtRate.value=m.Entities[0].OtRateWeekday:o.form.PublicHolidayOt.value==!0&&(o.form.OtRate.value=m.Entities[0].OtRatePublicHoliday),!(0,v.isEmptyOrNull)(o.form.OtHourBuffer.value)){var d=o.form.OtRate.value*o.form.OtHourBuffer.value;o.form.TotalOtPayBuffer.value=d}}})}dialogOpen(t){super.dialogOpen(t),I.EditorUtils.setReadonly(this.form.OtRate.element,!0),I.EditorUtils.setReadonly(this.form.EmployeeName.element,!0);var e=this,i=document.getElementById(this.idPrefix+"OtDate");$(i).on("change",()=>{e.calculateOtRate(!0)});var o=document.getElementById(this.idPrefix+"WeekendOt");$(o).on("change",()=>{e.form.PublicHolidayOt.value==!0&&(e.form.PublicHolidayOt.value=!1),e.form.WeekdayOt.value==!0&&(e.form.WeekdayOt.value=!1),e.calculateOtRate(!1)});var n=document.getElementById(this.idPrefix+"PublicHolidayOt");$(n).on("change",()=>{e.form.WeekendOt.value==!0&&(e.form.WeekendOt.value=!1),e.form.WeekdayOt.value==!0&&(e.form.WeekdayOt.value=!1),e.calculateOtRate(!1)});var r=document.getElementById(this.idPrefix+"WeekdayOt");$(r).on("change",()=>{e.form.WeekendOt.value==!0&&(e.form.WeekendOt.value=!1),e.form.PublicHolidayOt.value==!0&&(e.form.PublicHolidayOt.value=!1),e.calculateOtRate(!1)});function m(s,u){let c=new Date,a=new Date,[h,R]=s.split(":").map(Number),[w,H]=u.split(":").map(Number);return c.setHours(h,R,0,0),a.setHours(w,H,0,0),a<c&&a.setDate(a.getDate()+1),(a.getTime()-c.getTime())/(1e3*60*60)}S(m,"getHoursBetween");var d=document.getElementById("ot-start-clocklet"),E=document.getElementById("ot-end-clocklet");$(d).on("change",()=>{console.log("hahaha");var s=d.value,u=E.value,c=m(s,u);if(e.form.OtHourBuffer.value=c,!(0,v.isEmptyOrNull)(e.form.OtRate.value)){var a=e.form.OtRate.value*e.form.OtHourBuffer.value;e.form.OtPayBuffer.value=a}}),$(E).on("change",()=>{var s=d.value,u=E.value,c=m(s,u);if(e.form.OtHourBuffer.value=c,!(0,v.isEmptyOrNull)(e.form.OtRate.value)){var a=e.form.OtRate.value*e.form.OtHourBuffer.value;e.form.OtPayBuffer.value=a}})}save_submitHandler(t){var e=this,i=document.getElementById("ot-start-clocklet"),o=document.getElementById("ot-end-clocklet"),n=i.value,r=o.value;let m=n.split(":"),d=r.split(":"),E=parseInt(m[0],10),s=parseInt(m[1],10),u=parseInt(d[0],10),c=parseInt(d[1],10);var a=60*(u-E)+(c-s);if(this.minimum_ot_time>a){(0,M.alertDialog)("This OT cannot be applied as the duration is less than minimum time");return}e.form.PublicHolidayOt.value==!1&&e.form.WeekdayOt.value==!1&&e.form.WeekendOt.value==!1&&(0,M.alertDialog)("Please choose the type of ot to determine the rate"),super.save_submitHandler(t)}onDialogOpen(){super.onDialogOpen(),$(".EmployeeUpdated").hide(),$(".HrUpdated").hide();var t=this;if((0,v.isEmptyOrNull)(this.form.EmployeeUpdatedName.value))$(".EmployeeUpdatedName").hide();else{var e=document.getElementById(this.idPrefix+"EmployeeUpdatedName");$(e).on("click",function(){return A(this,null,function*(){var s=new F(parseInt(this.form.EmployeeUpdated.value));s.loadByIdAndOpenDialog(parseInt(this.form.EmployeeUpdated.value))})}),(0,v.isEmptyOrNull)(t.form.SuperiorRejectReason.value)||$(".SuperiorRejectReason").show()}if((0,v.isEmptyOrNull)(this.form.HrUpdatedName.value))$(".HrUpdatedName").hide();else{var i=document.getElementById(this.idPrefix+"HrUpdatedName");$(i).on("click",function(){return A(this,null,function*(){var s=new F(parseInt(this.form.HrUpdated.value));s.loadByIdAndOpenDialog(parseInt(this.form.HrUpdated.value))})}),(0,v.isEmptyOrNull)(t.form.HrRejectReason.value)||$(".HrRejectReason").show()}var o=".RejectedEmployeeName",n=".ApproveEmployeeName",r=document.getElementById(this.idPrefix+"EmployeeRowId"),m=document.getElementById(this.idPrefix+"OtDate");if(!p.Authorization.userDefinition.Permissions[g.HumanResources]&&this.isNew()&&(this.form.EmployeeRowId.value=p.Authorization.userDefinition.EmployeeRowID,I.EditorUtils.setReadonly(this.form.EmployeeRowId.element,!0),C.Retrieve({EntityId:$(r).val()},s=>{t.form.EmployeeName.value=s.Entity.EmployeeName,$(t.form.EmployeeRowId.element).val(p.Authorization.userDefinition.EmployeeRowID.toString()).trigger("change")})),this.isNew()){$(r).on("change",function(){return A(this,null,function*(){if((0,v.isEmptyOrNull)($(r).val())){t.form.EmployeeName.value="",$(t.form.OtRate.element).val("");return}t.calculateOtRate(),C.Retrieve({EntityId:$(r).val()},s=>{t.form.EmployeeName.value=s.Entity.EmployeeName})})});var d=document.querySelectorAll(".text-bg-success");d.forEach(function(s){$(s).hide()}),$(n).hide();var E=document.querySelectorAll(".text-bg-danger");E.forEach(function(s){$(s).hide()}),$(o).hide(),$(n).hide()}else if(!this.isNew()){if(!p.Authorization.userDefinition.Permissions[g.HumanResources]&&t.form.EmployeeRowId.value!=p.Authorization.userDefinition.EmployeeRowID&&(this.readOnly=!0),t.form.EmployeeRowId.value==p.Authorization.userDefinition.EmployeeRowID){I.EditorUtils.setReadonly(this.form.EmployeeRowId.element,!0),I.EditorUtils.setReadonly(this.form.EmployeeName.element,!0);return}D.Retrieve({EntityId:this.entityId},s=>{var u=s.Entity.EmployeeRowId,c=t.HrApproval=s.Entity.HrStatus,a=t.EmployeeApproval=s.Entity.EmployeeStatus,h=s.Entity.Status;h==0?(0,v.serviceCall)({service:T.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:p.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:u},method:"GET",async:!1,onSuccess:R=>{var w=t.SuperiorPermission=R;if(t.form.EmployeeRowId.value!=p.Authorization.userDefinition.EmployeeRowID&&this.set_readOnly(!0),$(".delete-button").removeClass("disabled"),c==0||a==0)w==!0&&!a&&$(".tool-button").removeClass("hidden"),p.Authorization.userDefinition.Permissions[g.HumanResources]&&!c&&$(".tool-button").removeClass("hidden");else if((c==-1||a==-1||c==1&&a==1)&&($(o).hide(),$(n).hide(),t.form.EmployeeRowId.value==p.Authorization.userDefinition.EmployeeRowID)){var H=document.querySelectorAll(".text-bg-success");H.forEach(function(B){$(B).hide()});var oe=document.querySelectorAll(".text-bg-danger");oe.forEach(function(B){$(B).hide()})}},onError:R=>{console.log(R.Error)}}):(this.set_readOnly(!0),$(".delete-button").removeClass("disabled"))})}}getToolbarButtons(){var t=this,e=super.getToolbarButtons(),i=document.createElement("style");return i.textContent=`
            .hidden {
      display: none;
    }
            `,document.head.appendChild(i),e.push({title:"Approve Application",cssClass:"text-bg-success p-2 hidden approveApplication",icon:"fa-check text-green",onClick:()=>{(0,v.confirm)("Do you want to approve this application?",()=>{let o={};p.Authorization.userDefinition.Permissions[g.HumanResources]?t.SuperiorPermission?t.EmployeeApproval===2||t.HrApproval===2?t.EmployeeApproval===2?o={HrStatus:1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID}:t.HrApproval===2&&(o={EmployeeStatus:1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID}):t.HrApproval===1?o={EmployeeStatus:1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID}:t.EmployeeApproval===1?o={HrStatus:1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID}:o={EmployeeStatus:1,HrStatus:1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID,HrUpdated:p.Authorization.userDefinition.EmployeeRowID}:o={HrStatus:1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID}:o={EmployeeStatus:1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID},D.Update({EntityId:t.entityId,Entity:o},n=>{t.loadById(n.EntityId),$(".rejectApplication, .approveApplication").hide()})})}}),e.push({title:"Rejected Application",cssClass:"text-bg-danger p-2 hidden rejectApplication",icon:"fa-times text-red",onClick:()=>{(0,v.confirm)("Do you want to reject this application?",()=>{var o=new b;o.dialogOpen(),o.element.on("dialogclose",()=>{let n={};var r=window.rejectReason;p.Authorization.userDefinition.Permissions[g.HumanResources]?t.SuperiorPermission==!0?t.EmployeeApproval==2||t.HrApproval==2?t.EmployeeApproval==2?n={HrStatus:-1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:t.HrApproval==2&&(n={EmployeeStatus:-1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r}):t.HrApproval==0?n={HrStatus:-1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:t.EmployeeApproval==0?n={EmployeeStatus:-1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r}:n={EmployeeStatus:-1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID,HrStatus:-1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r,SuperiorRejectReason:r}:n={HrStatus:-1,HrUpdated:p.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:n={EmployeeStatus:-1,EmployeeUpdated:p.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r},D.Update({EntityId:t.entityId,Entity:n},m=>{t.loadById(m.EntityId,d=>{console.log(d),(0,v.isEmptyOrNull)(t.form.SuperiorRejectReason.value)||$(".SuperiorRejectReason").show(),(0,v.isEmptyOrNull)(t.form.HrRejectReason.value)||$(".HrRejectReason").show()}),$(".rejectApplication, .approveApplication").hide()})})})}}),e}};S(k,"OTApplicationDialog"),k=P([I.Decorators.registerClass("HRMSoftware.OTApplication.OTApplicationDialog")],k);var l=O(j(),1);var N=class extends f.EntityGrid{constructor(t){super(t);this.SuperiorOfEmployeeRowIdList=[]}getColumnsKey(){return Z.columnsKey}getDialogType(){return k}getRowDefinition(){return y}getService(){return D.baseUrl}createEntityDialog(t,e){let i=super.createEntityDialog(t,e);var o=this;return i.element.on("dialogclose",()=>{o.internalRefresh(),console.log("hahaa")}),i}getQuickFilters(){let t=super.getQuickFilters();return t.push({cssClass:"hidden-xs",field:y.Fields.OccupationName,type:f.Select2Editor,title:"Occupation"}),t.push({cssClass:"hidden-xs",field:y.Fields.JobGradeName,type:f.Select2Editor,title:"Job Grade"}),t.push({cssClass:"hidden-xs",field:y.Fields.DivisionName,type:f.Select2Editor,title:"Division"}),t.push({cssClass:"hidden-xs",field:y.Fields.DepartmentName,type:f.Select2Editor,title:"Department"}),t.push({cssClass:"hidden-xs",field:y.Fields.EmployeeName,type:f.Select2Editor,title:"Name"}),t.push({cssClass:"hidden-xs",field:y.Fields.EmployeeID,type:f.Select2Editor,title:"Employee ID"}),t.push({cssClass:"hidden-xs",field:y.Fields.CostCentreName,type:f.Select2Editor,title:"Cost Centre"}),t.reverse(),t}createQuickFilters(){super.createQuickFilters();let t=["January","February","March","April","May","June","July","August","September","October","November","December"];V.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.OccupationName).items.push({id:e.Entities[i].Name.toString(),text:e.Entities[i].Name.toString()})}),J.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.JobGradeName).items.push({id:e.Entities[i].Name.toString(),text:e.Entities[i].Name.toString()})}),z.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.DepartmentName).items.push({id:e.Entities[i].Name.toString(),text:e.Entities[i].Name.toString()})}),K.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.DivisionName).items.push({id:e.Entities[i].Name.toString(),text:e.Entities[i].Name.toString()})}),C.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.EmployeeName).items.push({id:e.Entities[i].EmployeeName.toString(),text:e.Entities[i].EmployeeName.toString()}),this.findQuickFilter(f.Select2Editor,y.Fields.EmployeeID).items.push({id:e.Entities[i].EmployeeID.toString(),text:e.Entities[i].EmployeeID.toString()})}),q.List({},e=>{for(var i in e.Entities)this.findQuickFilter(f.Select2Editor,y.Fields.CostCentreName).items.push({id:e.Entities[i].Name.toString(),text:e.Entities[i].Name.toString()})})}getAddButtonCaption(){return"Apply Over Time Claiming"}getButtons(){var t=super.getButtons(),e=this;return t.push({title:"OT Application Claim Batch Approve",cssClass:"fas fa-hat-wizard text-bg-success approveButton hidden",onClick:i=>{if(e.rowSelection.getSelectedAsInt64().length==0){(0,l.alertDialog)("Please select at least one application to approve");return}(0,l.confirm)("Do you want to approve all selected applications?",()=>A(this,null,function*(){let o=e.rowSelection.getSelectedAsInt64();for(let n of o)try{let r=yield D.Retrieve({EntityId:n}),m=r.Entity.EmployeeStatus,d=r.Entity.HrStatus,E=r.Entity.Id,s=r.Entity.EmployeeRowId,u={},c=e.SuperiorOfEmployeeRowIdList.includes(s);l.Authorization.userDefinition.Permissions[g.HumanResources]?c==!0?m===2||d===2?m===2?u={HrStatus:1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID}:d===2&&(u={EmployeeStatus:1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID}):d===1?u={EmployeeStatus:1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID}:m===1?u={HrStatus:1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID}:u={EmployeeStatus:1,HrStatus:1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID,HrUpdated:l.Authorization.userDefinition.EmployeeRowID}:u={HrStatus:1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID}:u={EmployeeStatus:1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID},yield D.Update({EntityId:E,Entity:u})}catch(r){console.error(`Error updating application ${n}:`,r)}Q.notifyInfo(`${o.length} records have been approved.`),e.internalRefresh()}))},separator:!0}),t.push({title:"OT Application Batch Reject",cssClass:"fas fa-hat-wizard text-bg-danger rejectButton hidden",onClick:i=>{if(e.rowSelection.getSelectedAsInt64().length==0){(0,l.alertDialog)("Please select at least one application to reject");return}(0,l.confirm)("Do you want to reject all selected applications?",()=>A(this,null,function*(){var o=new b;o.dialogOpen(),o.element.on("dialogclose",()=>A(this,null,function*(){let n=e.rowSelection.getSelectedAsInt64();var r=window.rejectReason;for(let m of n)try{let d=yield D.Retrieve({EntityId:m}),E=d.Entity.EmployeeStatus,s=d.Entity.HrStatus,u=d.Entity.Id,c=d.Entity.EmployeeRowId,a={},h=yield new Promise((R,w)=>{(0,l.serviceCall)({service:T.baseUrl+"/PermissionToAcknowledge",data:{UserEmployeeRowID:l.Authorization.userDefinition.EmployeeRowID,ApplicantEmployeeRowID:c},method:"GET",onSuccess:R,onError:w})});l.Authorization.userDefinition.Permissions[g.HumanResources]?h==!0?E==2||s==2?E==2?a={HrStatus:-1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:s==2&&(a={EmployeeStatus:-1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r}):s==0?a={HrStatus:-1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:E==0?a={EmployeeStatus:-1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r}:a={EmployeeStatus:-1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID,HrStatus:-1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r,HrRejectReason:r}:a={HrStatus:-1,HrUpdated:l.Authorization.userDefinition.EmployeeRowID,HrRejectReason:r}:a={EmployeeStatus:-1,EmployeeUpdated:l.Authorization.userDefinition.EmployeeRowID,SuperiorRejectReason:r},yield D.Update({EntityId:u,Entity:a})}catch(d){console.error(`Error updating application ${m}:`,d)}(0,l.notifyInfo)(`${n.length} records have been rejected.`),e.internalRefresh()}))}))}}),t}onViewSubmit(){return this.slickGrid.onHeaderCellRendered.subscribe((t,e)=>{e.column.id==="SelectAll"&&$(e.node).empty().append("<input type='checkbox' id='selectAll'/>")}),$(document).on("change","#selectAll",function(){let t=$(this).prop("checked");$(".row-checkbox").prop("checked",t)}),super.onViewSubmit()}createToolbarExtensions(){super.createToolbarExtensions();var t=this;new Promise((i,o)=>{(0,l.serviceCall)({service:T.baseUrl+"/GetEmployeeUserCanView",data:{EmployeeRowID:l.Authorization.userDefinition.EmployeeRowID,PermissionKey:g.MoneyClaiming},method:"GET",onError:n=>o(n),onSuccess:n=>i(n||[])})}).then(i=>{t.SuperiorOfEmployeeRowIdList=i,console.log("Received data:",i),t.rowSelection=new f.GridRowSelectionMixin(t,{selectable:o=>{var n=i.includes(o.EmployeeRowId);if(o.EmployeeRowId==l.Authorization.userDefinition.EmployeeRowID||o.Status!=0)return;let r=l.Authorization.hasPermission(g.HumanResources);if(o.Status==0){if(o.EmployeeStatus==2||r&&o.HrStatus==2)return;if(r&&o.HrStatus==0||n&&o.EmployeeStatus==0)return $(".approveButton, .rejectButton").removeClass("hidden"),!0}}})}).catch(i=>{console.error("Error fetching data:",i)}),$(document).on("click",".select-item.check-box.no-float",function(){$(".select-item.check-box.no-float").parent().parent().removeClass("highlighted-row"),$(".select-item.check-box.no-float.checked").parent().parent().addClass("highlighted-row")}),$("<style>").prop("type","text/css").html(`
            .slick-row.highlighted-row {
                background-color: #D3E5FF !important;
            }
        `).appendTo("head")}getColumns(){var t=super.getColumns(),e;if(!l.Authorization.hasPermission(g.HumanResources))for(e in t)(t[e].name==y.Fields.EmployeeID||t[e].name==y.Fields.ApprovedBy)&&t.splice(e,1);return t.unshift(f.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection)),t}onViewProcessData(t){t=super.onViewProcessData(t);let i=l.Authorization.userDefinition.EmployeeRowID;return t.Entities.every(n=>n.EmployeeRowId===i)?l.Authorization.hasPermission(g.HumanResources)?$(".approveButton, .rejectButton").removeClass("hidden"):$(".approveButton, .rejectButton").addClass("hidden"):$(".approveButton, .rejectButton").removeClass("hidden"),this.toolbar.findButton("column-picker-button").toggle(!1),t}};S(N,"OTApplicationGrid"),N=P([f.Decorators.registerClass("HRMSoftware.OTApplication.OTApplicationGrid")],N);function re(){(0,te.initFullHeightGridPage)(new N($("#GridDiv")).element)}S(re,"pageInit");export{re as default};
//# sourceMappingURL=OTApplicationPage.js.map
