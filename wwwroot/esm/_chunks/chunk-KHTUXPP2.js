import{c as tt,d as Vt}from"./chunk-YIP4GR2E.js";import{c as et,d as _t}from"./chunk-B4PP3UR2.js";import{d as He,e as zt}from"./chunk-5TAMAFA5.js";import{a as Gt}from"./chunk-NO5DTLS5.js";import{G as Xe}from"./chunk-VLL7NB2K.js";import{c as Me,d as $t}from"./chunk-OLYWZP6G.js";import{A as Mt,B as Ht,C as Ee,G as jt,N as Nt,R as Wt,V as Ut,_ as kt,ca as Yt,d as Lt,h as Bt,l as Tt,o as Qe,p as At,r as Ft,s as xt,w as vt,y as ft,z as Rt}from"./chunk-3XL6K2Z3.js";import{c as Te,d as wt}from"./chunk-CICJSBLQ.js";import{d as Ze}from"./chunk-HDHDXEPW.js";import{A as mt,B as Ot,a as ct,b as Pt,e as Ve,f as Ct,m as qe,n as Dt,q as Je,r as It}from"./chunk-XMVX6RS3.js";import{a as Ke,b as Re}from"./chunk-BA2LGLQM.js";import{a as ut}from"./chunk-DNINIZJD.js";import{c as q,g as pe,h as ze,j as P,k as _e}from"./chunk-L3ECGIWB.js";var C=pe(ut(),1);var he=pe(_e(),1);var j=pe(_e(),1);var ge=class extends C.EntityDialog{constructor(t,e,a,m,i,r,d){super();this.form=new vt(this.idPrefix);this.ExternalEarnings=[];this.ExternalDeductions=[];this.EarningsString=[];this.DeductionsString=[];this.FinalEarnings=[];this.FinalDeductions=[];this.EmployerContributions=[];this.ListOfEpfSubjection=[];this.ListOfEisSubjection=[];this.ListOfHrdfSubjection=[];this.ListOfSocsoSubjection=[];this.ListOfPcbSubjection=[];this.ListOfCriteria=[];this.NoPaidLeaveId=[];this.MoneyClaimingId=[];this.OtPayId=[];this.LateArrivalId=[];this.EarlyLeavingId=[];this.listOfDicts=[];this.AllowanceId=[];this.DeductionId=[];var o=this;this.Wiz=t,this.WizEmployeeRowId=e,this.PayYear=a,this.PayMonth=m,this.PayDateWiz=i,this.PayPeriodStart=r,this.PayPeriodEnd=d;var o=this;this.ReadOnly=!1,Ee.List({},u=>{o.ListOfPayrollData=u.Entities})}getFormKey(){return vt.formKey}getRowDefinition(){return Ht}getService(){return Ee.baseUrl}dialogClose(){$("#NewEarningsCategory").remove(),super.dialogClose()}getDialogOptions(){let t=super.getDialogOptions();return t.width=t.width+550,t}ResetTable(){$("#AllowanceDeductionBody, #EarningDeductionBody, #MoneyClaimingBody").empty(),$(`#EarlyLeavingRate, #LateArrivalRate, #EarlyLeavingSubtotal, #LateArrivalSubtotal,
        #NplDayRate, #totalOt, #NplHrRate, #AbsentDayRate, #PC38`).text(0),$(`#${this.idPrefix}Bonus`).val(null),$(`#${this.idPrefix}Incentive`).val(null);var t=document.getElementById("Ot1.0x");t&&(t.textContent="0"),t=document.getElementById("Ot1.5x"),t&&(t.textContent="0"),t=document.getElementById("Ot2.0x"),t&&(t.textContent="0"),t=document.getElementById("Ot1.0xValueTotal"),t&&(t.textContent="0"),t=document.getElementById("Ot1.5xValueTotal"),t&&(t.textContent="0"),t=document.getElementById("Ot2.0xValueTotal"),t&&(t.textContent="0"),$(`#OtOnePointFiveTime, #OtTwoTime, #OtOneTime, #TotalSOCSO, #TotalEPF, #Deduction,
        #Allowance, #TotalEIS, #TotalHRD, #TotalTaxableWage, #GrossWage, #EmployerEPF, #EmployeeEPF,
        #EmployerSOCSO, #EmployeeSOCSO, #EmployerEIS, #EmployeeEIS, #HRD, #PCB, #TotalAllowance, #TotalDeduction,
        #EarlyLeavingMinutes,  #LateArrivalMinutes, #GrossWage, #NettWage, #GrossWage, #totalEmployerContribution,
        #totalEmployeeContribution, #CP38`).val(0),$(".Bonus, .Incentive").hide()}Setup(){var t=this;$(".HrdfWages").hide(),$(".PcbWages").hide(),$(".EisWages").hide(),$(".SocsoWages").hide(),$(".EpfWages").hide();var e=this.idPrefix+"PropertyGrid",a=document.getElementById(e),m=document.createElement("DIV");m.classList.add("category-title"),m.setAttribute("id","PayRoll-Description"),m.style.display="flex",a.appendChild(m);var i=document.createElement("a");i.classList.add("category-anchor");var r=document.createTextNode("Employee Payroll");i.appendChild(r),document.getElementById("PayRoll-Description").append(i);var d=document.getElementById("PayRoll-Description");d.insertAdjacentHTML("afterend",'<div class="DataGrid" id="PayRollGrid"></div>');var o=document.getElementById("PayRollGrid");o.style.display="flex";var u=document.createElement("TABLE");u.style.width="66%",u.id="PayrollTable",u.className="table";var c=document.createElement("thead");c.className="thead-dark",c.id="PayrollTableHeader";var y=document.createElement("tbody");y.id="PayrollTableBody";var f=document.createElement("tr"),l=document.createElement("tfoot");l.id="PayrollTableFoot";var E=document.createElement("TH"),v=document.createElement("TH"),g=document.createElement("TH"),D=document.createElement("TH");E.style.width="25%",v.style.width="25%",g.style.width="25%",D.style.width="25%";var H=document.createTextNode("Description"),b=document.createTextNode("Earnings"),W=document.createTextNode("Description"),I=document.createTextNode("Deductions");E.appendChild(H),v.appendChild(b),g.appendChild(W),D.appendChild(I);var O=document.createElement("TABLE");O.style.height="55%",O.id="EmployerContributionsTable";var U=document.createElement("thead");U.className="thead-dark",U.id="EmployerContributionsHeader";var k=document.createElement("tbody");k.id="EmployerContributionsBody";var _=document.createElement("tfoot");_.id="EmployerContributionsFoot";var R=document.createElement("TR"),Y=document.createElement("TH"),N=document.createElement("TH");Y.style.width="50%",N.style.width="50%";var F=document.createTextNode("Description"),M=document.createTextNode("Employer Contributions");Y.appendChild(F),N.appendChild(M),f.appendChild(E),f.appendChild(v),f.appendChild(g),f.appendChild(D),c.appendChild(f),u.appendChild(c),u.appendChild(y),u.appendChild(l),R.appendChild(Y),R.appendChild(N),U.appendChild(R),O.appendChild(U),O.appendChild(k),O.appendChild(_);var x=document.createElement("div");x.className="col-md-6",x.id="left";var S=document.createElement("div");S.id="NplAbsentTableContainer",x.appendChild(S);var A=document.createElement("div");A.id="OvertimeTableContainer",x.appendChild(A);var B=document.createElement("div");B.id="EarlyLeavingTableContainer",x.appendChild(B);var w=document.createElement("table");w.id="NplAbsentTable";var n=document.createElement("thead");n.innerHTML=`
      <tr>
        <th rowspan="2">NPL/Absent</th>
        <th colspan="3" id="totalNplAbsentDeduction">
            <span>Total:</span> <span id="totalNplAbsent">0</span>
        </th>
      </tr>
      `,w.appendChild(n);var K=[{label:"NPL Day",id:"NplDayRate",inputId:"NplDay",valueId:"NplDayValue",value:0,total:0,adjustment:0},{label:"NPL Hourly",id:"NplHrRate",inputId:"NplHr",valueId:"NplHrValue",value:0,total:0,adjustment:0},{label:"Absent Day",id:"AbsentDayRate",inputId:"AbsentDay",valueId:"AbsentDayValue",value:0,total:0,adjustment:0}];let V=document.createElement("tbody");V.id="NplAbsentTableBody",K.forEach(s=>{let Q=document.createElement("tr");Q.innerHTML=`
        <td class="Description">${s.label}</td>
        <td class="rates"> <span class="ratesValue" id = ${s.id} > ${s.value} </span> </td>
        <td class ="numberInputContainer"> <input id = ${s.inputId} min="0" class="nplDates numberInput" type="number" value="${s.total.toFixed(2)}" ></td>
        <td class ="subTotalContainer">  <span id = ${s.valueId} class="subTotal">0.00</span> </td>
      `,V.appendChild(Q)}),w.appendChild(V),S.appendChild(w);var h=document.createElement("table");h.id="OvertimeTable";var T=document.createElement("thead");T.innerHTML=`
      <tr>
        <th rowspan="2">Overtime</th>
        <th colspan="3" id="OvertimeAddition">
            <span>Total:</span> <span id="totalOt">0</span>
        </th>
      </tr>
      `,h.appendChild(T);var L=[{label:"OT1.0x",descId:"flatOtDesc",id:"Ot1.0x",valueId:"Ot1.0xValue",inputId:"OtOneTime",value:0,total:0,adjustment:0},{label:"OT1.5x",descId:"OnePointFiveOtDesc",id:"Ot1.5x",valueId:"Ot1.5xValue",inputId:"OtOnePointFiveTime",value:0,total:0,adjustment:0},{label:"OT2.0x",descId:"TwoOtDesc",id:"Ot2.0x",valueId:"Ot2.0xValue",inputId:"OtTwoTime",value:0,total:0,adjustment:0}];let ne=document.createElement("tbody");ne.id="OvertimeTableBody",L.forEach(s=>{let Q=document.createElement("tr");Q.innerHTML=`
        <td class="Description" id=${s.descId}>${s.label}</td>
        <td class="rates"> <span class="ratesValue" id=${s.id}> ${s.value} </span> </td>
        <td class ="numberInputContainer"> <input id=${s.inputId} min="0" class="overtime numberInput" type="number" value="${s.total.toFixed(2)}" ></td>
        <td>  <span class="subTotal" id=${s.valueId}Total>0.00</span> </td>
      `,ne.appendChild(Q)}),h.appendChild(ne),A.appendChild(h);var le=document.createElement("table");le.id="EarlyLeavingTable";var G=document.createElement("thead");G.innerHTML=`
      <tr>
        <th rowspan="2">Time Deduction</th>
        <th colspan="3" id="ShiftAddition">
            <span>Total:</span> <span id="totalTimeDeduction">0</span>
        </th>
      </tr>
      `,le.appendChild(G);var Se=[{label:"Early Leaving",Minutes:"EarlyLeavingMinutes",RateId:"EarlyLeavingRate",SubtotalId:"EarlyLeavingSubtotal",total:0,adjustment:0},{label:"Late Arrival",Minutes:"LateArrivalMinutes",RateId:"LateArrivalRate",SubtotalId:"LateArrivalSubtotal",total:0,adjustment:0}];let oe=document.createElement("tbody");oe.id="EarlyLeavingTableBody",Se.forEach(s=>{let Q=document.createElement("tr");Q.innerHTML=`
        <td class="Description">${s.label}</td>
        <td class="rates"> <span id=${s.RateId} class="ratesValue">0</span> </td>
        <td class ="numberInputContainer"> <input min="0" id=${s.Minutes} class="time numberInput" type="number" value="${s.total.toString()}" ></td>
        <td>  <span class="subTotal"  id=${s.SubtotalId} >0.00</span> </td>
      `,oe.appendChild(Q)}),le.appendChild(oe),B.appendChild(le);var te=document.createElement("div");te.className="col-md-4",te.id="center";var ae=document.createElement("div");ae.id="AllowanceDeductionContainer",te.appendChild(ae);var re=document.createElement("table");re.id="AllowanceDeductionTable";var de=document.createElement("thead");de.innerHTML=`
      <tr>
        <th colspan="3">Allowance/Deduction</th>
      </tr>
      <tr>
        <th>Code</th>
        <th>Description</th>
        <th>Amount</th>
      </tr>
      `,re.appendChild(de);let Pe=document.createElement("tbody");Pe.id="AllowanceDeductionBody",re.appendChild(Pe),ae.appendChild(re);var ve=document.createElement("div");ve.id="MoneyClaimingContainer",te.appendChild(ve);var fe=document.createElement("table");fe.id="MoneyClaimingTable";var Ne=document.createElement("thead");Ne.innerHTML=`
      <tr>
        <th colspan="3">Money Claiming</th>
      </tr>
      <tr>
        <th>Category</th>
        <th>Description</th>
        <th>Amount</th>
      </tr>
      `,fe.appendChild(Ne);let Ce=document.createElement("tbody");Ce.id="MoneyClaimingBody",fe.appendChild(Ce),ve.appendChild(fe);var Fe=document.createElement("div");Fe.id="EarningDeductionContainer",te.appendChild(Fe);var ue=document.createElement("table");ue.id="EarningDeductionTable";var xe=document.createElement("thead");xe.innerHTML=`
      <tr>
        <th colspan="3">Extra Earnings/Deductions</th>
      </tr>
      <tr>
        <th>Code</th>
        <th>Description</th>
        <th>Amount</th>
      </tr>
      `,ue.appendChild(xe);let We=document.createElement("tbody");We.id="EarningDeductionBody",ue.appendChild(We),Fe.appendChild(ue);var ye=document.createElement("div");ye.className="col-md-2 section",ye.id="right";let z=`
      <h3>Statutory Contribution</h3>
      <table class = "StatutoryContribution">

        <tr>
          <td></td>
          <td>Employer</td>
          <td>Employee</td>
        </tr>

        <tr>
          <td>EPF</td>
          <td><input class="govPayment" id="EmployerEPF" type="number" value="0.0" ></td>
          <td><input class="govPayment" id="EmployeeEPF" type="number" value="0.0" ></td>
        </tr>

        
        <tr>
          <td>SOCSO </td>
          <td><input class="govPayment" id="EmployerSOCSO" type="number" value="0.0" ></td>
          <td><input class="govPayment" id="EmployeeSOCSO" type="number" value="0.0" ></td>
        </tr>

        <tr>
          <td>EIS </td>
          <td><input class="govPayment" id="EmployerEIS" type="number" value="0.0" ></td>
          <td><input class="govPayment" id="EmployeeEIS" type="number" value="0.0" ></td>
        </tr>

        <tr>
          <td>HRD</td>
          <td><input class="govPayment" id="HRD" type="number" value="0.0" ></td>
          <td></td>
        </tr>

        <tr>
          <td>PCB</td>
           <td></td>
          <td><input class="govPayment" id="PCB" type="number" value="0.0" ></td>
        </tr>
          <tr>
          <td>CP38</td>
           <td></td>
          <td><input class="govPayment" id="CP38" type="number" value="0.0" ></td>
        </tr>
        <tr>
          <td>Total</td>
          <td><input class="govPayment" id="totalEmployerContribution" type="number" value="0.0" readonly></td>
          <td><input class="govPayment" id="totalEmployeeContribution" type="number" value="0.0" readonly></td>
        </tr>


      </table>
    `,Ue=`
      <h3>Total Wages</h3>
      <table class = "TotalWages" >
        <tr>
          <td>Total Allowance</td>
          <td><input id="TotalAllowance" type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>Total Deduction</td>
          <td><input id="TotalDeduction" type="number" value="0.00" readonly></td>
        </tr>
        <tr>
          <td>EPF Wage</td>
          <td><input id="TotalEPF" type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>HRD Wage</td>
          <td><input id="TotalHRD" type="number" value="0.0" readonly></td>
        </tr>



        <tr>
          <td>SOCSO Wage</td>
          <td><input id="TotalSOCSO" type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>EIS Wage</td>
          <td><input id="TotalEIS" type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>Total Taxable Wage</td>
          <td><input id="TotalTaxableWage" type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>Gross Wage</td>
          <td><input id="GrossWage"  type="number" value="0.0" readonly></td>
        </tr>
        <tr>
          <td>Nett Wage</td>
          <td><input id="NettWage" type="number" value="0.0" readonly></td>
        </tr>
      </table>
    `;var ae=document.createElement("div");ae.id="AllowanceDeductionContainer",ae.className="section",ae.innerHTML=z,ye.appendChild(ae);var ke=document.createElement("div");ke.id="Container2",ke.className="section",ke.innerHTML=Ue,ye.appendChild(ke),document.getElementById("PayRollGrid").append(x),document.getElementById("PayRollGrid").append(te),document.getElementById("PayRollGrid").append(ye);var p=document.getElementsByClassName("govPayment");$(p).on("change",function(s){return P(this,null,function*(){t.updateWages()})});var ce=document.getElementsByClassName("numberInput");$(ce).on("change",function(s){return P(this,null,function*(){t.updateTotals()})})}onDialogOpen(){super.onDialogOpen();var t=this;kt.List({},e=>{for(var a in e.Entities)if(e.Entities[a].IsActive==1){for(var m=e.Entities[a],i=Object.keys(m),r=0;r<i.length;r++){var d=i[r];if(!(d.toLowerCase()=="id"||d.toLowerCase()=="isactive")&&!(m[d]!=!0&&m[d]!=!1&&m[d]!==void 0)){var o=d.replace(/([A-Z])/g," $1").trim();this.ListOfPcbSubjection.push({id:r,name:o,subjection:m[d]})}}break}Bt.List({},u=>{for(var c in u.Entities)if(u.Entities[c].IsActive==1){for(var y=u.Entities[c],g=Object.keys(y),f=0;f<g.length;f++){var l=g[f];if(!(l.toLowerCase()=="id"||l.toLowerCase()=="isactive")&&!(y[l]!=!0&&y[l]!=!1&&y[l]!==void 0)){var E=l.replace(/([A-Z])/g," $1").trim();this.ListOfEpfSubjection.push({id:f,name:E,subjection:y[l]})}}break}for(var v=this.ListOfEpfSubjection,g=Object.keys(v),f=0;f<g.length;f++){var l=g[f];this.ListOfCriteria.push(v[l].name)}Lt.List({},D=>{for(var H in D.Entities)if(D.Entities[H].IsActive==1){for(var b=D.Entities[H],W=Object.keys(b),I=0;I<W.length;I++){var O=W[I];if(!(O.toLowerCase()=="id"||O.toLowerCase()=="isactive")&&!(b[O]!=!0&&b[O]!=!1&&b[O]!==void 0)){var U=O.replace(/([A-Z])/g," $1").trim();this.ListOfEisSubjection.push({id:I,name:U,subjection:b[O]})}}break}Tt.List({},k=>{for(var _ in k.Entities)if(k.Entities[_].IsActive==1){for(var R=k.Entities[_],Y=Object.keys(R),N=0;N<Y.length;N++){var F=Y[N];if(!(F.toLowerCase()=="id"||F.toLowerCase()=="isactive")&&!(R[F]!=!0&&R[F]!=!1&&R[F]!==void 0)){var M=F.replace(/([A-Z])/g," $1").trim();this.ListOfHrdfSubjection.push({id:N,name:M,subjection:R[F]})}}break}Yt.List({},x=>{for(var S in x.Entities)if(x.Entities[S].IsActive==1){for(var A=x.Entities[S],B=Object.keys(A),w=0;w<B.length;w++){var n=B[w];if(!(n.toLowerCase()=="id"||n.toLowerCase()=="isactive")&&!(A[n]!=!0&&A[n]!=!1&&A[n]!==void 0)){var K=n.replace(/([A-Z])/g," $1").trim();this.ListOfSocsoSubjection.push({id:w,name:K,subjection:A[n]})}}break}if(this.isNew()){var V="Overtime Payments",h=this.CheckSubjection(this.ListOfEisSubjection,V),T=this.CheckSubjection(this.ListOfEpfSubjection,V),L=this.CheckSubjection(this.ListOfHrdfSubjection,V),ne=this.CheckSubjection(this.ListOfPcbSubjection,V),le=this.CheckSubjection(this.ListOfSocsoSubjection,V);t.form.OtSubjectEis.value=h==1,t.form.OtSubjectEpf.value=T==1,t.form.OtSubjectHrdf.value=L==1,t.form.OtSubjectPcb.value=ne==1,t.form.OtSubjectSocso.value=le==1,$("#totalOt").attr("eis",h),$("#totalOt").attr("epf",T),$("#totalOt").attr("hrdf",L),$("#totalOt").attr("pcb",ne),$("#totalOt").attr("socso",le)}})})})})}),this.isNew()&&jt.List({},e=>{t.AnnualizedIncentive=t.SeperateIncentive=t.AnnualizedBonus=t.SeperateBonus=!1,t.form.IncentiveSubjectEpf.value=e.Entities[0].IncentiveSubjectEpf,t.form.IncentiveSubjectEis.value=e.Entities[0].IncentiveSubjectEis,t.form.IncentiveSubjectHrdf.value=e.Entities[0].IncentiveSubjectHrdf,t.form.IncentiveSubjectPcb.value=e.Entities[0].IncentiveSubjectPcb,t.form.IncentiveSubjectSocso.value=e.Entities[0].IncentiveSubjectSocso,t.form.BonusSubjectHrdf.value=e.Entities[0].BonusSubjectHrdf,t.form.BonusSubjectSocso.value=e.Entities[0].BonusSubjectSocso,t.form.BonusSubjectPcb.value=e.Entities[0].BonusSubjectPcb,t.form.BonusSubjectEpf.value=e.Entities[0].BonusSubjectEpf,t.form.BonusSubjectEis.value=e.Entities[0].BonusSubjectEis,t.form.AnnualizedBonus.value=e.Entities[0].AnnualizedBonus,t.form.SeperateIncentive.value=e.Entities[0].SeperateIncentive,t.form.AnnualizedIncentive.value=e.Entities[0].AnnualizedIncentive,t.form.SeperateBonus.value=e.Entities[0].SeperateBonus,t.AnnualizedIncentive=e.Entities[0].AnnualizedIncentive,t.SeperateIncentive=e.Entities[0].SeperateIncentive,t.AnnualizedBonus=e.Entities[0].AnnualizedBonus,t.SeperateBonus=e.Entities[0].SeperateBonus})}calculateAge(){let t=new Date(this.dateString),e=new Date(this.form.BirthDay.value),a=t.getFullYear()-e.getFullYear(),m=new Date(t.getFullYear(),e.getMonth(),e.getDate());t<m&&m.setFullYear(m.getFullYear()-1);let i=t.getTime()-m.getTime(),r=new Date(m);r.setFullYear(r.getFullYear()+1);let d=r.getTime()-m.getTime(),o=i/d;return a+o}dialogOpen(t){$(".field.BasicPay, .field.DailyPay, .field.DailyRate, .field.DaysWorked, .field.HourlyRate, .field.BirthDay, .field.Age").addClass("col-md-2"),$(" .field.WorkingSpouse").addClass("col-md-1"),$(".field.HrdfClass").addClass("col-md-2"),$(".field.Bonus, .field.Incentive").addClass("col-md-4"),$(" .field.ChildrenUnderEighteen, .field.ChildrenInUniversity, .field.DisabledChildInUniversity, .field.DisabledChild").addClass("col-md-2"),$(".field.MaritalStatus").addClass("col-md-3"),$(`.field.MaritalStatus label.caption, .field.WorkingSpouse label.caption, .field.ChildrenUnderEighteen label.caption, .field.ChildrenInUniversity label.caption,
        .field.DisabledChildInUniversity label.caption, .field.DisabledChild label.caption, .field.Age label.caption, .field.BirthDay label.caption, .field.HrdfClass label.caption`).removeClass("caption"),this.ResetTable(),$(".field.EisClass").addClass("col-md-2"),$(".field.SocsoClass").addClass("col-md-6"),$(".field.EpfClass").addClass("col-md-3"),$(".field.TaxClass").addClass("col-md-1"),$(`.field.BasicPay label.caption, .field.DailyPay label.caption, .field.DailyRate label.caption, .field.DaysWorked label.caption,
        .field.HourlyRate label.caption, .field.EisClass label.caption, .field.SocsoClass label.caption, .field.EpfClass label.caption, .field.HrdfClass label.caption, .field.TaxClass label.caption `).removeClass("caption"),C.EditorUtils.setReadonly(this.form.BasicPay.element,!0),C.EditorUtils.setReadonly(this.form.Bonus.element,!0),C.EditorUtils.setReadonly(this.form.Incentive.element,!0),C.EditorUtils.setReadonly(this.form.DaysWorked.element,!0),C.EditorUtils.setReadonly(this.form.HourlyRate.element,!0),C.EditorUtils.setReadonly(this.form.DailyRate.element,!0),C.EditorUtils.setReadonly(this.form.TaxClass.element,!0),C.EditorUtils.setReadonly(this.form.Age.element,!0),C.EditorUtils.setReadonly(this.form.BirthDay.element,!0),this.form.EpfClass.value=1 .valueOf().toString(),$(`.DeductedEarlyLeavingList, .OneTimeDeductionList, .DeductedNoPaidLeaveList,
        .DeductedLateArrivalList, .OneTimeAllowanceList, .PaidMoneyClaimingList, .PaidOtList, .EarlyLeavingRate, .LateArrivalRate, .EarlyLeaving,
        .LateArrival, .FlatOt, .OtOne, .OtOnePointFive, .OtTwo, .NPLHourlyRate, .NPLDailyRate, .NPLHourly, .NPLDaily, .AbsentDailyRate, .AbsentDaily,
        .OtSubjectEpf, .OtSubjectEis, .OtSubjectPcb, .OtSubjectSocso, .OtSubjectHrdf, .AllowanceList, .DeductionList, .OtOnePointFiveRate, .OtTwoRate, .HrdfClass, .Bonus, .Incentive`).hide();function e(o){let u=new Date(o);if(isNaN(u.getTime()))return o;{u.setDate(28);let c=u.getFullYear(),y=("0"+(u.getMonth()+1)).slice(-2),f=("0"+u.getDate()).slice(-2);return`${c}-${y}-${f}`}}q(e,"isValidDate");var a=this,m=!0;for((0,he.serviceCall)({service:Xe.baseUrl+"/GetTodayDateTime",method:"GET",data:{},async:!1,onSuccess:o=>{a.dateString=o,m=!1}});m==!0;);Ze.List({},o=>{for(var u in o.Entities)if(o.Entities[u].IsActive==1){this.DeductEarlyLeaving=o.Entities[u].DeductSalaryIfEarlyLeaving,this.DeductLateArrival=o.Entities[u].DeductSalaryIfLate,this.PayDate=o.Entities[u].PayDay,a.PublicHolidayMultiplier=o.Entities[u].PublicHolidayOnePointFive==!0?1.5:2,a.WeekendMultiplier=o.Entities[u].WeekendOnePointFive==!0?1.5:2,a.WeekdayMultiplier=o.Entities[u].WeekdayOnePointFive==!0?1.5:2;break}var c=new Date(a.dateString),y=c.getMonth(),f=c.getFullYear(),l=f.toString()+"-"+y.toString().padStart(2,"0")+"-"+this.PayDate.toString().padStart(2,"0");l=e(l);var E=new Date(f,y,this.PayDate),v=E.getFullYear().toString(),g=(E.getMonth()+1).toString(),D=E.getDate().toString();y=y-1;var H=new Date(f,y,this.PayDate);H.setDate(H.getDate()+1);var b=H.getFullYear().toString(),W=(H.getMonth()+1).toString(),I=H.getDate().toString(),O=g.padStart(2,"0")+"/"+D.padStart(2,"0")+"/"+v,U=W.padStart(2,"0")+"/"+I.padStart(2,"0")+"/"+b;this.isNew()&&(a.form.PayDate.value=O,a.form.PayPeriodEnd.value=O,a.form.PayPeriodStart.value=U)}),super.dialogOpen(t),a.isNew()&&this.applyChangesButton.hide(),C.EditorUtils.setReadonly(this.form.EmployeeName.element,!0);var i=this.form.EmployeeRowId.value;let r=["Deduction","Earnings","Nett","EmployeeEIS","EmployeeEPF","EmployeeSOCSO","EmployeePCB","PayrollTable","EmployerTable","EmployerHRDF","EmployerEPF","EmployerEIS","EmployerSOCSO"];for(var d in r)$("."+r[d]).hide();this.Setup(),Re.List({},o=>{var u=document.getElementById(this.idPrefix+"PayPeriodStart"),c=document.getElementById(this.idPrefix+"PayPeriodEnd"),y=document.getElementById(this.idPrefix+"EmployeeRowId"),f=document.getElementById(this.idPrefix+"PayMonth"),l=document.getElementById(this.idPrefix+"PayYear"),E=document.getElementById(this.idPrefix+"HrdfClass"),v=document.getElementById(this.idPrefix+"EisClass"),g=document.getElementById(this.idPrefix+"SocsoClass"),D=document.getElementById(this.idPrefix+"EpfClass"),H=document.getElementById(this.idPrefix+"MaritalStatus"),b=document.getElementById(this.idPrefix+"WorkingSpouse"),W=document.getElementById(this.idPrefix+"ChildrenUnderEighteen"),I=document.getElementById(this.idPrefix+"ChildrenInUniversity"),O=document.getElementById(this.idPrefix+"DisabledChild"),U=document.getElementById(this.idPrefix+"DisabledChildInUniversity");let k=new C.Select2Editor($(f)),_=new C.Select2Editor($(l)),R=["January","February","March","April","May","June","July","August","September","October","November","December"];var Y=new Date(a.dateString),N=Y.getFullYear(),F=Y.getMonth();for(let n=0;n<R.length;n++)k.addItem({id:n.toString(),text:R[n].toString()});a.isNew()&&k.set_value(F.toString());for(let n=-1;n<2;n++)_.addItem({id:(N+n).toString(),text:(N+n).toString()});a.isNew()&&_.set_value(N.toString());let M=new C.Select2Editor($(y)),x=[];for(var S in o.Entities)M.addItem({id:o.Entities[S].Id.toString(),text:o.Entities[S].EmployeeID.toString()}),x.push({id:o.Entities[S].Id,name:o.Entities[S].EmployeeName,BasicPay:o.Entities[S].BasicSalary,Allowance:o.Entities[S].Allowance,type:o.Entities[S].EmployeeType,EisClass:o.Entities[S].EisClass,EpfClass:o.Entities[S].EpfClass,SocsoClass:o.Entities[S].SocsoClass,MaritalStatus:o.Entities[S].MaritalStatus,WorkingSpouse:o.Entities[S].WorkingSpouse,ChildrenUnderEighteen:o.Entities[S].ChildrenUnderEighteen,ChildrenInUniversity:o.Entities[S].ChildrenInUniversity,DisabledChildInUniversity:o.Entities[S].DisabledChildInUniversity,DisabledChild:o.Entities[S].DisabledChild,Birthday:o.Entities[S].Birthday,HrdfClass:o.Entities[S].HRDFClass});if(this.listOfDicts=x,a.isNew()&&$(y).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.GeneratePayrollTable(1)})}),a.Wiz!=1&&($(v).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(g).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(E).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(D).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(b).on("change",function(n){return P(this,null,function*(){console.log("haha"),n.stopImmediatePropagation(),a.updatePayroll()})}),$(W).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(H).on("change",function(n){return P(this,null,function*(){console.log("hhaa"),parseInt(a.form.MaritalStatus.value)==1 .valueOf()?$(".WorkingSpouse, .ChildrenUnderEighteen, .ChildrenInUniversity, .DisabledChild, .DisabledChildInUniversity").show():parseInt(a.form.MaritalStatus.value)==0 .valueOf()&&$(".WorkingSpouse, .ChildrenUnderEighteen, .ChildrenInUniversity, .DisabledChild, .DisabledChildInUniversity").hide()})}),$(I).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(O).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})}),$(U).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.updatePayroll()})})),this.isNew())$(f).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.GeneratePayrollTable(1)})}),$(l).on("change",function(n){return P(this,null,function*(){n.stopImmediatePropagation(),a.GeneratePayrollTable(1)})}),$(u).on("change",function(n){return P(this,null,function*(){if(a.form.PayPeriodStart.valueAsDate>a.form.PayPeriodEnd.valueAsDate){(0,j.alertDialog)("Pay period start cannot be ahead of pay period end"),a.form.PayPeriodStart.value="";return}a.GeneratePayrollTable(0)})}),$(c).on("change",function(n){return P(this,null,function*(){if(a.form.PayPeriodStart.valueAsDate>a.form.PayPeriodEnd.valueAsDate){(0,j.alertDialog)("Pay period start cannot be ahead of pay period end"),a.form.PayPeriodEnd.value="";return}a.GeneratePayrollTable(0)})}),$(`.field.MaritalStatus, .field.WorkingSpouse, .field.ChildrenUnderEighteen, .field.ChildrenInUniversity,
        .field.DisabledChildInUniversity, .field.DisabledChild,  .field.DaysWorked, .field.BasicPay, .field.DailyRate,
        .field.HourlyRate, .field.EisClass, .field.SocsoClass, .field.EpfClass, .field.TaxClass, .field.HrdfClass, .field.addEarnings, .field.addDeductions,
        .field.BirthDay, .field.Age,  .addEarnings, .addDeductions`).hide();else if(!this.isNew()){C.EditorUtils.setReadonly(this.form.PayMonth.element,!0),C.EditorUtils.setReadonly(this.form.PayYear.element,!0),C.EditorUtils.setReadonly(this.form.PayDate.element,!0),C.EditorUtils.setReadonly(this.form.PayPeriodEnd.element,!0),C.EditorUtils.setReadonly(this.form.PayPeriodStart.element,!0),$(l).val(this.form.PayYear.value).trigger("change"),$(f).val(this.form.PayMonth.value).trigger("change");for(var S in x)x[S].id==parseInt(i)&&(this.EmployeeType=x[S].type);$(y).val(i.toString()).trigger("change"),$(".HrdfClass").show(),C.EditorUtils.setReadonly(this.form.EmployeeRowId.element,!0),$("#PCB").val(this.form.EmployeePCB.value),$("#EmployeeEIS").val(this.form.EmployeeEIS.value),$("#EmployeeEPF").val(this.form.EmployeeEPF.value),$("#EmployeeSOCSO").val(this.form.EmployeeSOCSO.value),$("#EmployerEIS").val(this.form.EmployerEIS.value),$("#EmployerEPF").val(this.form.EmployerEPF.value),$("#HRD").val(this.form.EmployerHRDF.value),$("#EmployerSOCSO").val(this.form.EmployerSOCSO.value),$("#NplDayRate").text(this.form.NPLDailyRate.value),$("#NplHrRate").text(this.form.NPLHourlyRate.value),$("#AbsentDayRate").text(this.form.AbsentDailyRate.value),$("#NplDay").val(this.form.NPLDaily.value),$("#NplHr").val(this.form.NPLHourly.value),$("#AbsentDay").val(this.form.AbsentDaily.value),document.getElementById("Ot1.0x").textContent=this.form.FlatOt.value.toString(),document.getElementById("Ot1.5x").textContent=this.form.OtOnePointFiveRate.value.toString(),document.getElementById("Ot2.0x").textContent=this.form.OtTwoRate.value.toString(),$("#OtOneTime").val(this.form.OtOne.value),$("#OtOnePointFiveTime").val(this.form.OtOnePointFive.value),$("#OtTwoTime").val(this.form.OtTwo.value),$("#EarlyLeavingRate").text(this.form.EarlyLeavingRate.value),$("#LateArrivalRate").text(this.form.LateArrivalRate.value),$("#EarlyLeavingMinutes").val(this.form.EarlyLeaving.value),$("#LateArrivalMinutes").val(this.form.LateArrival.value),$("#totalOt").attr("eis",a.form.OtSubjectEis.value.toString()),$("#totalOt").attr("epf",a.form.OtSubjectEpf.value.toString()),$("#totalOt").attr("hrdf",a.form.OtSubjectHrdf.value.toString()),$("#totalOt").attr("pcb",a.form.OtSubjectPcb.value.toString()),$("#totalOt").attr("socso",a.form.OtSubjectSocso.value.toString());let n=0;for(n=0;n<this.form.AllowanceList.value.length;n++){var A=document.createElement("tr");A.innerHTML=`<td>${this.form.AllowanceList.value[n].code}</td><td>${this.form.AllowanceList.value[n].Description}</td>
                                            <td class = "AllowanceAmount" eis =  ${this.form.AllowanceList.value[n].SubjectionEis.toString()} epf =  ${this.form.AllowanceList.value[n].SubjectionEpf.toString()}
                                            hrdf =  ${this.form.AllowanceList.value[n].SubjectionHrdf.toString()} pcb =  ${this.form.AllowanceList.value[n].SubjectionPcb.toString()}
                                                socso =  ${this.form.AllowanceList.value[n].SubjectionSocso.toString()} 
                                            >${this.form.AllowanceList.value[n].AllowanceAmount}</td>`,$("#AllowanceDeductionBody").append(A)}for(n=0;n<this.form.DeductionList.value.length;n++){var A=document.createElement("tr");A.innerHTML=`<td>${this.form.DeductionList.value[n].code}</td><td>${this.form.DeductionList.value[n].Description}</td><td class = "DeductionAmount">${this.form.DeductionList.value[n].DeductionAmount}</td>`,$("#AllowanceDeductionBody").append(A)}for(n=0;n<this.form.PaidMoneyClaimingList.value.length;n++){var A=document.createElement("tr");A.innerHTML=`<td>${this.form.PaidMoneyClaimingList.value[n].ClaimingCategory}</td><td>${this.form.PaidMoneyClaimingList.value[n].Description}</td>
                                            <td  eis =  ${this.form.PaidMoneyClaimingList.value[n].SubjectionEis.toString()} epf =  ${this.form.PaidMoneyClaimingList.value[n].SubjectionEpf.toString()}
                                            hrdf =  ${this.form.PaidMoneyClaimingList.value[n].SubjectionHrdf.toString()} pcb =  ${this.form.PaidMoneyClaimingList.value[n].SubjectionPcb.toString()}
                                                socso =  ${this.form.PaidMoneyClaimingList.value[n].SubjectionSocso.toString()} 
                                            >${this.form.PaidMoneyClaimingList.value[n].ClaimAmount}</td>`,$("#MoneyClaimingBody").append(A)}for(n=0;n<this.form.PayrollEarnings.value.length;n++){var B=this.form.PayrollEarnings.value[n],w=document.createElement("tr"),w=document.createElement("tr");w.innerHTML=`<td> <span>${B.EarningCode}</span>           <button class="remove">\xD7</button>
                            </td><td>${B.Description}</td><td> <input class = numberInput type="number" min="0" eis = ${B.SubjectionToEis} epf = ${B.SubjectionToEpf} hrdf = ${B.SubjectionToHrdf}
                             pcb = ${B.SubjectionToPcb} socso = ${B.SubjectionToSocso}  value = ${B.Amount} ></input>           </td>`,$("#EarningDeductionBody").append(w)}for(n=0;n<this.form.PayrollDeductions.value.length;n++){B=this.form.PayrollDeductions.value[n];var w=document.createElement("tr");w.innerHTML=`<td>${B.DeductionCode}  <button class="remove">\xD7</button>
                            </td><td>${B.Description}</td><td> <input class = numberInput type="number" max="0"  value = "${B.Amount}" ></input>           </td>`,$("#EarningDeductionBody").append(w)}$(".remove").on("click",function(K){return P(this,null,function*(){$(this).closest("tr").remove(),a.updatePayroll()})}),$(".numberInput").on("change",function(K){return P(this,null,function*(){a.updatePayroll()})}),a.updateTotals(),a.updatePayroll()}a.Wiz==1&&(a.form.EmployeeRowId.value=a.WizEmployeeRowId.toString(),a.form.PayMonth.value=a.PayMonth,a.form.PayYear.value=a.PayYear,a.form.PayPeriodStart.value=a.PayPeriodStart,a.form.PayPeriodEnd.value=a.PayPeriodEnd,a.form.PayDate.value=a.PayDateWiz)})}updatePayroll(){var t=this;if(this.extraEarningDeduction=0,(0,j.isEmptyOrNull)(t.form.EpfClass.value)||(0,j.isEmptyOrNull)(t.form.EisClass.value)||(0,j.isEmptyOrNull)(t.form.SocsoClass.value)||(0,j.isEmptyOrNull)(t.form.WorkingSpouse.value)||(0,j.isEmptyOrNull)(t.form.ChildrenUnderEighteen.value)||(0,j.isEmptyOrNull)(t.form.ChildrenInUniversity.value)||(0,j.isEmptyOrNull)(t.form.DisabledChild.value)||(0,j.isEmptyOrNull)(t.form.DisabledChildInUniversity.value))return;var e=this.form.BasicPay.value,a=parseFloat(document.getElementById("totalNplAbsent").innerHTML),m=parseFloat(document.getElementById("totalTimeDeduction").innerHTML),i=document.getElementById("totalOt"),r=parseFloat(i.innerHTML);let d=a+m,o=0,u=0,c=0,y=0,f=0,l=0,E=0,v=0,g=0,D=0,H=0,b=0,W=0,I=0,O=0,U=0,k=0;t.form.Bonus.value>0&&$(".Bonus").show(),t.form.Incentive.value>0&&$(".Incentive").show();let _=0;t.form.IncentiveSubjectEis.value==!0&&(t.form.SeperateIncentive.value==!0?W+=t.form.Incentive.value:c+=t.form.Incentive.value),t.form.IncentiveSubjectEpf.value==!0&&(t.form.SeperateIncentive.value==!0?I+=t.form.Incentive.value:y+=t.form.Incentive.value),t.form.IncentiveSubjectHrdf.value==!0&&(t.form.SeperateIncentive.value==!0?O+=t.form.Incentive.value:f+=t.form.Incentive.value),t.form.IncentiveSubjectPcb.value==!0&&(t.form.SeperateIncentive.value==!0?U+=t.form.Incentive.value:l+=t.form.Incentive.value),t.form.IncentiveSubjectSocso.value==!0&&(t.form.SeperateIncentive.value==!0?k+=t.form.Incentive.value:E+=t.form.Incentive.value),t.form.BonusSubjectEis.value==!0&&(t.form.SeperateBonus.value==!0?v+=t.form.Bonus.value:c+=t.form.Bonus.value),t.form.BonusSubjectEpf.value==!0&&(t.form.SeperateBonus.value==!0?g+=t.form.Bonus.value:y+=t.form.Bonus.value),t.form.BonusSubjectHrdf.value==!0&&(t.form.SeperateBonus.value==!0?D+=t.form.Bonus.value:f+=t.form.Bonus.value),t.form.BonusSubjectPcb.value==!0&&(t.form.SeperateBonus.value==!0?H+=t.form.Bonus.value:l+=t.form.Bonus.value),t.form.BonusSubjectSocso.value==!0&&(t.form.SeperateBonus.value==!0?b+=t.form.Bonus.value:E+=t.form.Bonus.value);let R=document.getElementById("AllowanceDeductionBody");R&&Array.from(R.rows).forEach(h=>{let T=h.cells[2],L=parseFloat(T.innerText.trim())||0;L>0?o+=L:L<0&&(u+=L),T.getAttribute("eis")==="true"&&(c+=L),T.getAttribute("epf")==="true"&&(y+=L),T.getAttribute("hrdf")==="true"&&(f+=L),T.getAttribute("pcb")==="true"&&(l+=L),T.getAttribute("socso")==="true"&&(E+=L)}),$("#TotalAllowance").val(o),$("#TotalDeduction").val(u);let Y=document.getElementById("MoneyClaimingBody");Y&&Array.from(Y.rows).forEach(h=>{let T=h.cells[2],L=parseFloat(T.innerText.trim())||0;t.extraEarningDeduction+=L,T.getAttribute("eis")==="true"&&(c+=L),T.getAttribute("epf")==="true"&&(y+=L),T.getAttribute("hrdf")==="true"&&(f+=L),T.getAttribute("pcb")==="true"&&(l+=L),T.getAttribute("socso")==="true"&&(E+=L)});let N=document.getElementById("EarningDeductionBody");N&&Array.from(N.rows).forEach(h=>{console.log(h);let T=h.querySelector("input.numberInput"),L=parseFloat(T.value)||0;t.extraEarningDeduction+=L,T.getAttribute("eis")==="true"&&(c+=L),T.getAttribute("epf")==="true"&&(y+=L),T.getAttribute("hrdf")==="true"&&(f+=L),T.getAttribute("pcb")==="true"&&(l+=L),T.getAttribute("socso")==="true"&&(E+=L)}),i.getAttribute("eis")==="true"&&(c+=r),i.getAttribute("epf")==="true"&&(y+=r),i.getAttribute("hrdf")==="true"&&(f+=r),i.getAttribute("pcb")==="true"&&(l+=r),i.getAttribute("socso")==="true"&&(E+=r),c+=e,y+=e,f+=e,l+=e,E+=e,c-=d,y-=d,f-=d,l-=d,E-=d,$("#TotalEPF").val(y.toFixed(2)),$("#TotalHRD").val(f.toFixed(2)),$("#TotalSOCSO").val(E.toFixed(2)),$("#TotalEIS").val(c.toFixed(2)),$("#TotalTaxableWage").val(l.toFixed(2));var F=t.form.WorkingSpouse.value==!0?1:0,M=0;let x=0,S=0,A=0,B=0,w=0,n=0,K=0,V=0;if(t.form.SeperateBonus.value==!0)for(M=0,(0,he.serviceCall)({service:Ee.baseUrl+"/CalculateGovernmentPaymentBonus",method:"GET",data:{EisCategory:t.form.EisClass.value,EpfCategory:t.form.EpfClass.value,SocsoCategory:t.form.SocsoClass.value,HrdfCategory:t.form.HrdfClass.value,EpfAmount:y,EisAmount:c,SocsoAmount:E,PcbAmount:l,HrdfAmount:f,Bonus:t.form.Bonus.value,WorkingSpouse:F,ChildrenUnderEighteen:t.form.ChildrenUnderEighteen.value,ChildrenInUniversity:t.form.ChildrenInUniversity.value,NumberOfDisabledChild:t.form.DisabledChild.value,NumberOfDisabledChildInUni:t.form.DisabledChildInUniversity.value},async:!1,onSuccess:h=>{x+=h.Entities[0].EmployeeEPF,w+=h.Entities[0].EmployerEPF,S+=h.Entities[0].EmployeeEIS,A+=h.Entities[0].EmployeePCB,B+=h.Entities[0].EmployeeSOCSO,n+=h.Entities[0].EmployerEIS,K+=h.Entities[0].EmployerHRDF,V+=h.Entities[0].EmployerSOCSO,console.log(h.Entities[0]),M=1}});M==0;);else if(t.form.SeperateIncentive.value==!0)for(M=0,(0,he.serviceCall)({service:Ee.baseUrl+"/CalculateGovernmentPaymentSpecial",method:"GET",data:{EisCategory:t.form.EisClass.value,EpfCategory:t.form.EpfClass.value,SocsoCategory:t.form.SocsoClass.value,HrdfCategory:t.form.HrdfClass.value,EpfAmount:I,EisAmount:W,SocsoAmount:k,PcbAmount:U,HrdfAmount:O,WorkingSpouse:F,ChildrenUnderEighteen:t.form.ChildrenUnderEighteen.value,ChildrenInUniversity:t.form.ChildrenInUniversity.value,NumberOfDisabledChild:t.form.DisabledChild.value,NumberOfDisabledChildInUni:t.form.DisabledChildInUniversity.value},async:!1,onSuccess:h=>{x+=h.Entities[0].EmployeeEPF,S+=h.Entities[0].EmployeeEIS,A+=h.Entities[0].EmployeePCB,B+=h.Entities[0].EmployeeSOCSO,w+=h.Entities[0].EmployerEPF,n+=h.Entities[0].EmployerEIS,K+=h.Entities[0].EmployerHRDF,V+=h.Entities[0].EmployerSOCSO,M=1}});M==0;);else for((0,he.serviceCall)({service:Ee.baseUrl+"/CalculateGovernmentPaymentSpecial",method:"GET",data:{EisCategory:t.form.EisClass.value,EpfCategory:t.form.EpfClass.value,SocsoCategory:t.form.SocsoClass.value,HrdfCategory:t.form.HrdfClass.value,EpfAmount:y,EisAmount:c,SocsoAmount:E,PcbAmount:l,HrdfAmount:f,WorkingSpouse:F,ChildrenUnderEighteen:t.form.ChildrenUnderEighteen.value,ChildrenInUniversity:t.form.ChildrenInUniversity.value,NumberOfDisabledChild:t.form.DisabledChild.value,NumberOfDisabledChildInUni:t.form.DisabledChildInUniversity.value},async:!1,onSuccess:h=>{t.EmployerContributions.length=0,t.form.TaxClass.value=h.Entities[0].TaxClass,x+=h.Entities[0].EmployeeEPF,S+=h.Entities[0].EmployeeEIS,A+=h.Entities[0].EmployeePCB,B+=h.Entities[0].EmployeeSOCSO,w+=h.Entities[0].EmployerEPF,n+=h.Entities[0].EmployerEIS,K+=h.Entities[0].EmployerHRDF,V+=h.Entities[0].EmployerSOCSO,console.log(h.Entities[0]),M=1}});M==0;);$("#EmployeeEPF").val(x.toFixed(2)),$("#EmployeeEIS").val(S.toFixed(2)),$("#PCB").val(A.toFixed(2)),$("#EmployeeSOCSO").val(B.toFixed(2)),$("#EmployerEPF").val(w.toFixed(2)),$("#EmployerEIS").val(n.toFixed(2)),$("#HRD").val(K.toFixed(2)),$("#EmployerSOCSO").val(V.toFixed(2)),t.updateWages()}updateTotals(){let t=parseFloat(document.getElementById("NplDayRate").textContent),e=parseFloat(document.getElementById("NplHrRate").textContent),a=parseFloat(document.getElementById("AbsentDayRate").textContent),m=parseFloat(document.getElementById("NplDay").value)||0,i=parseFloat(document.getElementById("NplHr").value)||0,r=parseFloat(document.getElementById("AbsentDay").value)||0;document.getElementById("NplDayValue").textContent=(t*m).toFixed(2),document.getElementById("NplHrValue").textContent=(e*i).toFixed(2),document.getElementById("AbsentDayValue").textContent=(a*r).toFixed(2);let d=t*m+e*i+a*r;document.getElementById("totalNplAbsent").textContent=d.toFixed(2);let o=parseFloat(document.getElementById("Ot1.0x").textContent),u=parseFloat(document.getElementById("Ot1.5x").textContent),c=parseFloat(document.getElementById("Ot2.0x").textContent),y=parseFloat(document.getElementById("OtOneTime").value)||0,f=parseFloat(document.getElementById("OtOnePointFiveTime").value)||0,l=parseFloat(document.getElementById("OtTwoTime").value)||0;document.getElementById("Ot1.0xValueTotal").textContent=(o*y).toFixed(2),document.getElementById("Ot1.5xValueTotal").textContent=(u*f).toFixed(2),document.getElementById("Ot2.0xValueTotal").textContent=(c*l).toFixed(2);let E=o*y+u*f+c*l;document.getElementById("totalOt").textContent=E.toFixed(2);let v=parseFloat(document.getElementById("EarlyLeavingRate").textContent),g=parseFloat(document.getElementById("LateArrivalRate").textContent),D=parseFloat(document.getElementById("EarlyLeavingMinutes").value)||0,H=parseFloat(document.getElementById("LateArrivalMinutes").value)||0;document.getElementById("EarlyLeavingSubtotal").textContent=(v*D).toFixed(2),document.getElementById("LateArrivalSubtotal").textContent=(g*H).toFixed(2);let b=v*D+g*H;document.getElementById("totalTimeDeduction").textContent=b.toFixed(2)}updateWages(){var t=this.form.BasicPay.value,e=this.form.Bonus.value,a=this.form.Incentive.value,m=parseFloat($("#TotalAllowance").val()),i=parseFloat($("#TotalDeduction").val()),r=parseFloat($("#totalOt").text()),d=0;document.getElementById("totalNplAbsent")&&(d=parseFloat(document.getElementById("totalNplAbsent").innerHTML));var o=0;document.getElementById("totalTimeDeduction")&&(o=parseFloat(document.getElementById("totalTimeDeduction").innerHTML));var u=t+m+r+this.extraEarningDeduction-i-d-o;(0,j.isEmptyOrNull)(e)||(u+=e),(0,j.isEmptyOrNull)(a)||(u+=a),$("#GrossWage").val(u.toFixed(2));let c=parseFloat($("#EmployeeEPF").val())+parseFloat($("#EmployeeSOCSO").val())+parseFloat($("#EmployeeEIS").val())+parseFloat($("#PCB").val())+parseFloat($("#CP38").val()),y=parseFloat($("#EmployerEPF").val())+parseFloat($("#EmployerEIS").val())+parseFloat($("#EmployerSOCSO").val())+parseFloat($("#HRD").val());$("#totalEmployeeContribution").val(c.toFixed(2)),$("#totalEmployerContribution").val(y.toFixed(2));let f=u-c;$("#NettWage").val(f.toFixed(2)),this.Wiz==1&&this.saveAndCloseButton.click()}GeneratePayrollTable(t){var e=this;function a(G,Se,oe,te){let re=new Date(G),de=new Date(Se),Pe=new Date(oe),ve=new Date(te);return re<=ve&&Pe<=de}q(a,"isOverlap"),e.Wiz!=1&&e.ResetTable();var m=document.getElementById("PayrollTable"),i=document.getElementById(this.idPrefix+"EmployeeRowId"),r=document.getElementById(this.idPrefix+"PayMonth"),d=document.getElementById(this.idPrefix+"PayYear"),o=document.getElementById(this.idPrefix+"EmployeeName"),u=this.ExternalDeductions,c=this.ExternalEarnings,y=this.EarningsString,f=this.DeductionsString,l=e.listOfDicts;if((0,j.isEmptyOrNull)($(i).val()))e.form.EmployeeName.value="";else for(var E in l)l[E].id==$(i).val()&&$(o).val(l[E].name);if((0,j.isEmptyOrNull)($(i).val())||(0,j.isEmptyOrNull)($(r).val())||(0,j.isEmptyOrNull)($(d).val())){$(`.field.MaritalStatus, .field.WorkingSpouse, .field.ChildrenUnderEighteen, .field.ChildrenInUniversity,
        .field.DisabledChildInUniversity, .field.DisabledChild,  .field.DaysWorked, .field.BasicPay, .field.DailyRate,
        .field.HourlyRate, .field.EisClass, .field.SocsoClass, .field.HrdfClass, .field.EpfClass, .field.TaxClass, .addEarnings, .addDeductions,
        .field.BirthDay, .field.Age`).hide();return}else{if(t==1){var v=e.form.PayYear.value,g=e.form.PayMonth.value,D=new Date(v,g,this.PayDate),H=D.getFullYear().toString(),b=(D.getMonth()+1).toString(),W=D.getDate().toString();g=g-1;var I=new Date(v,g,this.PayDate);I.setDate(I.getDate()+1);var O=I.getFullYear().toString(),U=(I.getMonth()+1).toString(),k=I.getDate().toString(),_=b.padStart(2,"0")+"/"+W.padStart(2,"0")+"/"+H,R=U.padStart(2,"0")+"/"+k.padStart(2,"0")+"/"+O;e.form.PayDate.value=_,e.form.PayPeriodEnd.value=_,e.form.PayPeriodStart.value=R}var Y=!0,N=!1,F=!1,M=!1,x=!1,S=!1,A=!1,B=!1,w=!1,n=!1,K=!1,V=!0,h=!0,T=!0;if(e.NoPaidLeaveId.length=0,e.MoneyClaimingId.length=0,e.OtPayId.length=0,e.EmployerContributions.length=0,u.length=0,c.length=0,y.length=0,f.length=0,e.FinalDeductions.length=0,e.FinalEarnings.length=0,e.NettEarnings=0,e.NettDeductions=0,e.AllowanceId.length=0,e.DeductionId.length=0,(0,j.isEmptyOrNull)($(r).val())&&(0,j.isEmptyOrNull)($(d).val())){e.form.PayPeriodEnd.valueAsDate=new Date(e.form.PayYear.value,e.form.PayMonth.value,e.PayDate),e.form.PayDate.valueAsDate=new Date(e.form.PayYear.value,e.form.PayMonth.value,e.PayDate);var I=e.form.PayPeriodEnd.valueAsDate;I.setMonth(I.getMonth()-1),I.setDate(I.getDate()-1),e.form.PayPeriodStart.valueAsDate=I}var L=`${e.form.PayYear.value}/${e.form.PayMonth.value+1}/${1}`,ne=0;for((0,he.serviceCall)({service:Ee.baseUrl+"/CalculateNplAbsentOtSpecial",method:"GET",data:{EmployeeRowID:parseInt($(i).val()),Date:L},async:!1,onSuccess:G=>{ne=1,e.form.DaysWorked.value=G.Entities[0].NumberOfWorkingDays,$("#NplDayRate").html(G.Entities[0].NPLDaily.toFixed(2)),$("#NplHrRate").html(G.Entities[0].NPLHourly.toFixed(2)),$("#AbsentDayRate").html(G.Entities[0].AbsentDaily.toFixed(2)),$("#EarlyLeavingRate").html(G.Entities[0].EarlyLeavingRate.toFixed(2)),$("#LateArrivalRate").html(G.Entities[0].LateArrivalRate.toFixed(2)),e.form.DailyRate.value=G.Entities[0].DailyRate.toFixed(2),e.form.HourlyRate.value=G.Entities[0].HourlyRate.toFixed(2)}});ne==0;);var le;Dt.List({Criteria:C.Criteria.and(le,[[qe.Fields.EmployeeRowId],"=",$(i).val()],[[qe.Fields.EffectiveFrom],"<=",e.form.PayPeriodEnd.valueAsDate],[e.form.PayPeriodStart.valueAsDate,"<=",[qe.Fields.EffectiveUntil]])},G=>{let Se=0;for(var oe in G.Entities)a(G.Entities[oe].EffectiveFrom,G.Entities[oe].EffectiveUntil,e.form.PayPeriodStart,e.form.PayPeriodEnd)&&(Se+=G.Entities[oe].Cp38Amount);$("#CP38").val(Se);var te;Ct.List({Criteria:C.Criteria.and(te,[[Ve.Fields.EmployeeRowId],"=",$(i).val()],[[Ve.Fields.PayMonth],"=",e.form.PayMonth.value],[[Ve.Fields.PayYear],"=",e.form.PayYear.value])},re=>{let de=0;for(var Pe in re.Entities)de+=re.Entities[Pe].BonusAmount;de>0&&(e.form.Bonus.value=de);var ve;It.List({Criteria:C.Criteria.and(ve,[[Je.Fields.EmployeeRowId],"=",$(i).val()],[[Je.Fields.PayMonth],"=",e.form.PayMonth.value],[[Je.Fields.PayYear],"=",e.form.PayYear.value])},fe=>{var Ne;let Ce=0;for(var Fe in fe.Entities)Ce+=fe.Entities[Fe].IncentiveAmount;Ce>0&&(e.form.Incentive.value=Ce),$t.List({Criteria:C.Criteria.and(Ne,[[Me.Fields.Status],"=","1"],[[Me.Fields.EmployeeRowId],"=",$(i).val()],[[Me.Fields.StartDate],"<=",e.form.PayPeriodEnd.get_value()],[[Me.Fields.EndDate],">=",e.form.PayPeriodStart.get_value()])},ue=>{ue.Entities.length>0&&(Y=!1);var xe;for(var We in ue.Entities){var ye=ue.Entities[We].LeaveReasonId;switch(ye){case 1:N=!0;break;case 2:F=!0;break;case 3:M=!0;break;case 4:x=!0;break;case 5:S=!0;break;case 6:A=!0;break;case 7:B=!0;break;case 8:w=!0;break;case 10:n=!0;break;case 11:K=!0;break}}for(var z in l)if(l[z].id==$(i).val()){e.form.PayrollEarnings.value.length=0,e.form.PayrollDeductions.value.length=0,$(".addEarnings, .addDeductions").show(),$(`.field.MaritalStatus, .field.WorkingSpouse, .field.ChildrenUnderEighteen, .field.ChildrenInUniversity,
                            .field.DisabledChildInUniversity, .field.DisabledChild,  .field.DaysWorked, .field.BasicPay, .field.DailyRate,
                            .field.HourlyRate, .field.EisClass, .field.SocsoClass, .field.EpfClass, .field.TaxClass, .field.BirthDay, .field.Age`).show(),$(".HrdfClass").show();var Ue=0;for((0,he.serviceCall)({service:Re.baseUrl+"/CalculateOtRate",data:{EmployeeRowID:e.form.EmployeeRowId.value,Date:L},method:"GET",async:!1,onSuccess:p=>{if(document.getElementById("PayRoll-Description").children.length==0&&e.Setup(),console.log(p.Entities[0]),e.FixedOtRateOption=p.Entities[0].FixedOtRateOption,e.FixedOtRateOption==!1){e.form.FlatOt.value=p.Entities[0].OtRate;let ce=parseFloat(p.Entities[0].OtRate.toFixed(2)),s=(ce*1.5).toFixed(2),Q=(ce*2).toFixed(2);document.getElementById("flatOtDesc").innerHTML="OT1.0x",document.getElementById("OnePointFiveOtDesc").innerHTML="OT1.5x",document.getElementById("TwoOtDesc").innerHTML="OT2.0x",document.getElementById("Ot1.0x").textContent=ce.toFixed(2),document.getElementById("Ot1.5x").textContent=s,document.getElementById("Ot2.0x").textContent=Q}else document.getElementById("flatOtDesc").innerHTML="Weekday",document.getElementById("OnePointFiveOtDesc").innerHTML="Weekend",document.getElementById("TwoOtDesc").innerHTML="Public Holiday",document.getElementById("Ot1.0x").textContent=p.Entities[0].OtRateWeekday,document.getElementById("Ot1.5x").textContent=p.Entities[0].OtRateWeekend,document.getElementById("Ot2.0x").textContent=p.Entities[0].OtRatePublicHoliday;Ue=1}});Ue==0;);e.form.BirthDay.value=l[z].Birthday,e.form.Age.value=e.calculateAge(),e.form.MaritalStatus.value=l[z].MaritalStatus.toString(),e.form.WorkingSpouse.value=l[z].WorkingSpouse,e.form.ChildrenUnderEighteen.value=l[z].ChildrenUnderEighteen,e.form.ChildrenInUniversity.value=l[z].ChildrenInUniversity,e.form.DisabledChildInUniversity.value=l[z].DisabledChildInUniversity,e.form.DisabledChild.value=l[z].DisabledChild,e.form.BasicPay.value=l[z].BasicPay,e.EmployeeType=l[z].type,e.EpfSubjection=l[z].EpfSubjection,e.form.EisClass.value=l[z].EisClass.toString(),e.form.EpfClass.value=l[z].EpfClass.toString(),e.form.SocsoClass.value=l[z].SocsoClass.toString(),e.form.HrdfClass.value=l[z].HrdfClass;var ae=l[z].name,xe;Pt.List({Criteria:C.Criteria.and(xe,[[ct.Fields.EmployeeRowId],"=",$(i).val()],[e.form.PayPeriodStart.get_value(),">=",[ct.Fields.EffectiveFrom]])},p=>{console.log(p.Entities),$("#AllowanceDeductionBody").empty();var ce=0;for(var s in p.Entities){if(!(0,j.isEmptyOrNull)(p.Entities[s].EffectiveUntil)){var Q=p.Entities[s].EffectiveUntil,Jt=new Date(Q);if(e.form.PayPeriodStart.valueAsDate>Jt)continue}if(!(p.Entities[s].OneTime==!0&&p.Entities[s].PaidOneTime==!0)){if(p.Entities[s].FullAttendance==!0){if(p.Entities[s].ExemptAnnualLeave==!1&&p.Entities[s].ExemptCompassionateLeave==!1&&p.Entities[s].ExemptEmergencyLeave==!1&&p.Entities[s].ExemptUnpaidLeave==!1&&p.Entities[s].ExemptSickLeave==!1&&p.Entities[s].ExemptPaternityLeave==!1&&p.Entities[s].ExemptMaternityLeave==!1&&p.Entities[s].ExemptMarriageLeave==!1&&p.Entities[s].ExemptHospitalisationLeave==!1&&p.Entities[s].ExemptGatepassLeave==!1){if(Y==!1)continue}else if(p.Entities[s].ExemptAnnualLeave==!0&&x==!0||p.Entities[s].ExemptCompassionateLeave==!0&&w==!0||p.Entities[s].ExemptEmergencyLeave==!0&&n==!0||p.Entities[s].ExemptUnpaidLeave==!0&&N==!0||p.Entities[s].ExemptSickLeave==!0&&M==!0||p.Entities[s].ExemptPaternityLeave==!0&&A==!0||p.Entities[s].ExemptMaternityLeave==!0&&S==!0||p.Entities[s].ExemptMarriageLeave==!0&&B==!0||p.Entities[s].ExemptHospitalisationLeave==!0&&F==!0||p.Entities[s].ExemptGatepassLeave==!0&&K==!0)continue}else{if(p.Entities[s].NoAbsence==!0&&h==!1)continue;if(p.Entities[s].NoEarlyLeaving==!0&&T==!1)continue;if(p.Entities[s].NoLate==!0&&V==!1)continue}var pt=document.createElement("tr");pt.innerHTML=`<td>${p.Entities[s].AllowanceCode}</td><td>${p.Entities[s].Description}</td>
                                            <td class = "AllowanceAmount" eis =  ${p.Entities[s].SubjectionEis.toString()} epf =  ${p.Entities[s].SubjectionEpf.toString()}
                                            hrdf =  ${p.Entities[s].SubjectionHrdf.toString()} pcb =  ${p.Entities[s].SubjectionPcb.toString()}
                                                socso =  ${p.Entities[s].SubjectionSocso.toString()} 
                                            >${p.Entities[s].Amount}</td>`,$("#AllowanceDeductionBody").append(pt),e.AllowanceId.push(p.Entities[s].Id),ce+=p.Entities[s].Amount}}if($("#TotalAllowance").val(ce),$(o).val(ae),m)for(var rt=m.getElementsByTagName("TR"),Kt=rt.length,Ye=Kt-1;Ye>0;Ye--)rt[Ye].parentNode.removeChild(rt[Ye]);var Zt;zt.List({Criteria:C.Criteria.and(Zt,[[He.Fields.Status],"=","1"],[[He.Fields.EmployeeRowId],"=",$(i).val()],[[He.Fields.OtDate],">=",e.form.PayPeriodStart.get_value()],[[He.Fields.OtDate],"<=",e.form.PayPeriodEnd.get_value()])},Qt=>{let De=0,Ie=0,Oe=0,$e=0,Le=0;Qt.Entities.forEach(X=>{X.WeekendOt?De+=X.OtMinute:X.WeekdayOt?Ie+=X.OtMinute:X.PublicHolidayOt&&(Oe+=X.OtMinute)}),e.FixedOtRateOption==!1?(e.PublicHolidayMultiplier==2?$e+=Oe:Le+=Oe,e.WeekendMultiplier==2?$e+=De:Le+=De,e.WeekdayMultiplier==2?$e+=Ie:Le+=Ie,$e=$e/60,Le=Le/60,$("#OtOnePointFiveTime").val(Le),$("#OtTwoTime").val($e)):(Ie=Ie/60,De=De/60,Oe=Oe/60,$("#OtOneTime").val(Ie),$("#OtOnePointFiveTime").val(De),$("#OtTwoTime").val(Oe)),$("#OtTwoTime").trigger("change");var Xt;At.List({Criteria:C.Criteria.and(Xt,[[Qe.Fields.EmployeeRowId],"=",$(i).val()],[[Qe.Fields.LeaveDate],">=",e.form.PayPeriodStart.get_value()],[[Qe.Fields.LeaveDate],"<=",e.form.PayPeriodEnd.get_value()])},X=>{let ea=0;for(var st in X.Entities)(0,j.isEmptyOrNull)(X.Entities[st].Deductions)||(e.NoPaidLeaveId.push(X.Entities[st].Id),ea+=X.Entities[st].HalfDay?.5:1);var ta;Ot.List({Criteria:C.Criteria.and(ta,[[mt.Fields.EmployeeRowId],"=",$(i).val()],[e.form.PayPeriodStart.get_value(),">=",[mt.Fields.EffectiveFrom]])},ie=>{var Et=0;for(var se in ie.Entities)if(!(ie.Entities[se].OneTime==!0&&ie.Entities[se].DeductedOneTime==!0)){if(!(0,j.isEmptyOrNull)(ie.Entities[se].EffectiveUntil)){var aa=ie.Entities[se].EffectiveUntil,ia=new Date(aa);if(e.form.PayPeriodStart.valueAsDate>ia)continue}var ht=document.createElement("tr");ht.innerHTML=`<td>${ie.Entities[se].DeductionCode}</td><td>${ie.Entities[se].Description}</td><td class = "DeductionAmount">-${ie.Entities[se].Amount}</td>`,$("#AllowanceDeductionBody").append(ht),e.DeductionId.push(ie.Entities[se].Id),Et+=ie.Entities[se].Amount}$(".remove").on("click",function(ee){return P(this,null,function*(){console.log("haha"),$(this).closest("tr").remove(),e.updatePayroll()})}),$(".numberInput").on("change",function(ee){return P(this,null,function*(){e.updatePayroll()})}),$("#TotalDeduction").val(Et);var na;wt.List({Criteria:C.Criteria.and(na,[[Te.Fields.EmployeeRowId],"=",$(i).val()],[[Te.Fields.Paid],"=","0"],[[Te.Fields.Status],"=","1"],[[Te.Fields.ClaimingDate],">=",e.form.PayPeriodStart.get_value()],[[Te.Fields.ClaimingDate],"<=",e.form.PayPeriodEnd.get_value()])},ee=>{$("#MoneyClaimingBody").empty();for(var me in ee.Entities){var gt=document.createElement("tr");gt.innerHTML=`<td>${ee.Entities[me].ClaimingCategory}</td><td>${ee.Entities[me].Description}</td>
                                            <td  eis =  ${ee.Entities[me].SubjectionEis.toString()} epf =  ${ee.Entities[me].SubjectionEpf.toString()}
                                            hrdf =  ${ee.Entities[me].SubjectionHrdf.toString()} pcb =  ${ee.Entities[me].SubjectionPcb.toString()}
                                                socso =  ${ee.Entities[me].SubjectionSocso.toString()} 
                                            >${ee.Entities[me].ClaimAmount}</td>`,$("#MoneyClaimingBody").append(gt)}var la;_t.List({Criteria:C.Criteria.and(la,[[et.Fields.EmployeeRowId],"=",$(i).val()],[[et.Fields.Date],">=",e.form.PayPeriodStart.get_value()],[[et.Fields.Date],"<=",e.form.PayPeriodEnd.get_value()])},we=>{we.Entities.length>0&&(T=!1);let bt=0;for(var dt in we.Entities)we.Entities[dt].Deducted==0&&(bt+=we.Entities[dt].EarlyMins,e.EarlyLeavingId.push(we.Entities[dt].Id));$("#EarlyLeavingMinutes").val(bt);var oa;Vt.List({Criteria:C.Criteria.and(oa,[[tt.Fields.EmployeeRowId],"=",$(i).val()],[[tt.Fields.Date],">=",e.form.PayPeriodStart.get_value()],[[tt.Fields.Date],"<=",e.form.PayPeriodEnd.get_value()])},Be=>{var St=0;Be.Entities.length>0&&(V=!1);for(var Ge in Be.Entities)Be.Entities[Ge].Deducted==0&&((0,j.isEmptyOrNull)(Be.Entities[Ge].Deductions)||(St+=Be.Entities[Ge].LateMins,e.LateArrivalId.push(Be.Entities[Ge].Id)));$("#LateArrivalMinutes").val(St),e.updatePayroll()})})})})})})});break}})})})})}}CheckSubjection(t,e){var a=e.match(/\((.*?)\)/),m;if(a&&a.length>1?m=a[1]:m=e,m=="Others")return 0;for(var i=0;i<t.length;i++){var r=t[i];for(var d in r)if(r[d]==m)return r.subjection}return 0}getToolbarButtons(){var t=super.getToolbarButtons(),e=document.createElement("style");e.textContent=`

    .section {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      border-radius: 8px;
    }

    .section h3 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #333;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table td {
      padding: 8px;
      text-align: left;
      vertical-align: middle;
    }

    table td input[type="number"] {
      width: 100%;
      text-align: right;
      padding: 5px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #f9f9f9;
    }









    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #d9e9f9; /* Light blue for headers */
      font-weight: bold;
    }

    td:nth-child(3), td:nth-child(5) {
      background-color: #fde8f1; /* Light pink for specific columns */
    }

    tr:nth-child(even) {
      background-color: #f9f9f9; /* Alternating row colors */
    }

    tr {
    position: sticky;
    }
        
    tr:hover {
      background-color: #f1f1f1; /* Hover effect for rows */
    }

    .numberInput {
      text-align: right; /* Align text consistently */
      width: 100%;
      border: none;
      background-color: transparent;
    }

    .Description {
    text-align: left; /* Align text consistently */
    width: 50px; /* Ensures consistent width for all spans */

    }

    .numberInputContainer {
    text-align: left; /* Align text consistently */
    width: 100px; /* Ensures consistent width for all spans */
    }


    .rates {
    text-align: right; /* Align text consistently */
    width: 100px; /* Ensures consistent width for all spans */
    }
    

    #PayRollGrid {
    display: flex;
    gap: 5px; /* Adds a 20px gap between #left, #center, and #right */
}

#left,
#center,
#right {
    flex: 1; /* Ensures each section takes equal space (optional) */
}

            `,document.head.appendChild(e);var a=this;return t.push({title:"Add Earnings",cssClass:"text-bg-success p-2 addEarnings",icon:"fa-plus text-green",onClick:()=>{$(".PayrollEarnings .add-button").click();var i=a.form.PayrollEarnings.value.length;$(".s-HRMSoftware-PayrollSettings-PayrollEarningsEditDialog").on("dialogclose",function(){if(i!=a.form.PayrollEarnings.value.length){var r=a.form.PayrollEarnings.value[a.form.PayrollEarnings.value.length-1],d=document.createElement("tr");d.innerHTML=`<td> <span>${r.EarningCode}</span>           <button class="remove">\xD7</button>
                            </td><td>${r.Description}</td><td> <input class = numberInput type="number" min="0" eis = ${r.SubjectionToEis} epf = ${r.SubjectionToEpf} hrdf = ${r.SubjectionToHrdf}
                             pcb = ${r.SubjectionToPcb} socso = ${r.SubjectionToSocso}  value = ${r.Amount} ></input>           </td>`,$("#EarningDeductionBody").append(d),$(".remove").on("click",function(o){return P(this,null,function*(){$(this).closest("tr").remove(),a.updatePayroll()})}),$(".numberInput").on("change",function(o){return P(this,null,function*(){a.updatePayroll()})}),a.updatePayroll()}})}}),t.push({title:"Add Deductions",cssClass:"text-bg-danger p-2 addDeductions",icon:"fa-minus text-red",onClick:()=>{$(".PayrollDeductions .add-button").click();var i=a.form.PayrollDeductions.value.length;$(".s-HRMSoftware-PayrollSettings-PayrollDeductionsEditDialog").on("dialogclose",function(){if(i!=a.form.PayrollDeductions.value.length){var r=a.form.PayrollDeductions.value[a.form.PayrollDeductions.value.length-1],d=document.createElement("tr");d.innerHTML=`<td>   <span>${r.DeductionCode}</span>  <button class="remove">\xD7</button>
                            </td><td>${r.Description}</td><td> <input class = numberInput type="number" max="0"  value = "-${r.Amount}" ></input>           </td>`,$("#EarningDeductionBody").append(d),$(".remove").on("click",function(o){return P(this,null,function*(){$(this).closest("tr").remove(),a.updatePayroll()})}),$(".numberInput").on("change",function(o){return P(this,null,function*(){a.updatePayroll()})}),a.updatePayroll()}})}}),t}save_submitHandler(t){let e=0,m=document.getElementById("EarningDeductionBody").querySelectorAll("tr");if(m.length){let l=[],E=[],v=Array.from(m).map(g=>{let D=g.querySelectorAll("td");return{code:D[0].querySelector("span").textContent,description:D[1].innerText,amount:D[2].querySelector(".numberInput").value,eis:D[2].querySelector(".numberInput").getAttribute("eis"),epf:D[2].querySelector(".numberInput").getAttribute("epf"),hrdf:D[2].querySelector(".numberInput").getAttribute("hrdf"),pcb:D[2].querySelector(".numberInput").getAttribute("pcb"),socso:D[2].querySelector(".numberInput").getAttribute("socso")}});for(e=0;e<v.length;e++){var i;parseFloat(v[e].amount)>0?(i=new nt,i.Amount=parseFloat(v[e].amount),i.Description=v[e].description,i.SubjectionToPcb=d(v[e].pcb),i.SubjectionToEis=d(v[e].eis),i.SubjectionToHrdf=d(v[e].hrdf),i.SubjectionToSocso=d(v[e].socso),i.SubjectionToEpf=d(v[e].epf),i.EarningCode=v[e].code,l.push(i)):parseFloat(v[e].amount)<0&&(i=new it,i.Amount=parseFloat(v[e].amount),i.Description=v[e].description,i.DeductionCode=v[e].code,E.push(i))}this.form.PayrollEarnings.value=l,this.form.PayrollDeductions.value=E}this.form.EpfWages.value=$("#TotalEPF").val(),this.form.HrdfWages.value=$("#TotalHRD").val(),this.form.SocsoWages.value=$("#TotalSOCSO").val(),this.form.EisWages.value=$("#TotalEIS").val(),this.form.EmployeeCp38.value=$("#Cp38").val(),this.form.NPLDaily.value=$("#NplDay").val(),this.form.NPLHourly.value=$("#NplHr").val(),this.form.AbsentDaily.value=$("#AbsentDay").val(),this.form.OtOne.value=$("#OtOneTime").val(),this.form.OtOnePointFive.value=$("#OtOnePointFiveTime").val(),this.form.OtTwo.value=$("#OtTwoTime").val(),this.form.EarlyLeaving.value=$("#EarlyLeavingMinutes").val(),this.form.LateArrival.value=$("#LateArrivalMinutes").val(),this.form.FlatOt.value=parseFloat(document.getElementById("Ot1.0x").textContent),this.form.OtOnePointFiveRate.value=parseFloat(document.getElementById("Ot1.5x").textContent),this.form.OtTwoRate.value=parseFloat(document.getElementById("Ot2.0x").textContent);var r=this;function d(l){return l==="true"}q(d,"toBoolean"),this.isNew()&&(this.form.SeperateBonus.value=this.SeperateBonus,this.form.SeperateIncentive.value=this.SeperateBonus,this.form.AnnualizedBonus.value=this.AnnualizedBonus,this.form.AnnualizedIncentive.value=this.AnnualizedIncentive),this.form.EmployeePCB.value=$("#PCB").val(),this.form.EmployeeEIS.value=$("#EmployeeEIS").val(),this.form.EmployeeEPF.value=$("#EmployeeEPF").val(),this.form.EmployeeSOCSO.value=$("#EmployeeSOCSO").val(),this.form.EmployerEIS.value=$("#EmployerEIS").val(),this.form.EmployerEPF.value=$("#EmployerEPF").val(),this.form.EmployerHRDF.value=$("#HRD").val(),this.form.EmployerSOCSO.value=$("#EmployerSOCSO").val(),this.form.NPLDailyRate.value=parseFloat($("#NplDayRate").text()),this.form.NPLHourlyRate.value=parseFloat($("#NplHrRate").text()),this.form.AbsentDailyRate.value=parseFloat($("#AbsentDayRate").text()),this.form.EarlyLeavingRate.value=parseFloat($("#EarlyLeavingRate").text()),this.form.LateArrivalRate.value=parseFloat($("#LateArrivalRate").text());let u=document.getElementById("MoneyClaimingBody").querySelectorAll("tr");if(u.length){let l=[],E=Array.from(u).map(v=>{let g=v.querySelectorAll("td");return{ClaimingCategory:g[0].innerText,description:g[1].innerText,amount:g[2].innerText,eis:g[2].getAttribute("eis"),epf:g[2].getAttribute("epf"),hrdf:g[2].getAttribute("hrdf"),pcb:g[2].getAttribute("pcb"),socso:g[2].getAttribute("socso")}});for(e=0;e<E.length;e++){var c=new at;c.ClaimAmount=parseFloat(E[e].amount),c.Description=E[e].description,c.ClaimingCategory=E[e].ClaimingCategory,c.SubjectionPcb=d(E[e].pcb),c.SubjectionEis=d(E[e].eis),c.SubjectionHrdf=d(E[e].hrdf),c.SubjectionSocso=d(E[e].socso),c.SubjectionEpf=d(E[e].epf),l.push(c)}this.form.PaidMoneyClaimingList.value=l}let f=document.getElementById("AllowanceDeductionBody").querySelectorAll("tr");if(f.length){let l=[],E=[],v=Array.from(f).map(H=>{let b=H.querySelectorAll("td");return{code:b[0].innerText,description:b[1].innerText,amount:b[2].innerText,eis:b[2].getAttribute("eis"),epf:b[2].getAttribute("epf"),hrdf:b[2].getAttribute("hrdf"),pcb:b[2].getAttribute("pcb"),socso:b[2].getAttribute("socso")}}),g=0,D=0;for(e=0;e<v.length;e++){var i;parseFloat(v[e].amount)>0?(i=new lt,i.AllowanceId=r.AllowanceId[g],i.AllowanceAmount=parseFloat(v[e].amount),i.Description=v[e].description,i.SubjectionPcb=d(v[e].pcb),i.SubjectionEis=d(v[e].eis),i.SubjectionHrdf=d(v[e].hrdf),i.SubjectionSocso=d(v[e].socso),i.SubjectionEpf=d(v[e].epf),i.code=v[e].code,g+=1,l.push(i)):parseFloat(v[e].amount)<0&&(i=new ot,i.DeductionId=r.DeductionId[D],i.DeductionAmount=parseFloat(v[e].amount),i.Description=v[e].description,i.code=v[e].code,E.push(i),D+=1)}this.form.AllowanceList.value=l,this.form.DeductionList.value=E}r.form.Nett.value=$("#NettWage").val(),r.form.Earnings.value=$("#GrossWage").val(),r.form.Deduction.value=r.form.Earnings.value-r.form.Nett.value,super.save_submitHandler(t)}};q(ge,"PayrollDialog"),ge=ze([C.Decorators.registerClass("HRMSoftware.PayrollSettings.PayrollDialog")],ge);var at=class extends Wt{constructor(){super()}};q(at,"ConcreteMoneyClaimApplicationRow");var it=class extends Ft{constructor(){super()}};q(it,"ConcretePayrollDeductionsRow");var nt=class extends xt{constructor(){super()}};q(nt,"ConcretePayrollEarningsRow");var lt=class extends Ut{constructor(){super()}};q(lt,"ConcreteEmployeeAllowanceRow");var ot=class extends Nt{constructor(){super()}};q(ot,"ConcreteFixedDeductionRow");var Ae=pe(ut(),1);var J=pe(_e(),1),Z=pe(_e(),1),yt=pe(ut(),1);var je=class extends Ae.EntityDialog{constructor(){super();this.form=new ft(this.idPrefix);var t;Re.List({Criteria:Ae.Criteria.and(t,[[Ke.Fields.Retired],"=","0"],[[Ke.Fields.Terminated],"=","0"],[[Ke.Fields.Resigned],"=","0"])},e=>{this.EmployeeData=e.Entities})}getFormKey(){return ft.formKey}getRowDefinition(){return Rt}getService(){return Mt.baseUrl}SearchCallback(){var t=this,e=document.getElementById(this.idPrefix+"PayMonth"),a=document.getElementById(this.idPrefix+"PayYear"),m=document.getElementById(this.idPrefix+"OccupationList"),i=document.getElementById(this.idPrefix+"DepartmentList"),r=document.getElementById(this.idPrefix+"DivisionList"),d=document.getElementById(this.idPrefix+"JobGradeList"),o=document.getElementById(this.idPrefix+"SectionList");if((0,J.isEmptyOrNull)($(e).val())||(0,J.isEmptyOrNull)($(a).val())){this.form.EmployeeRowList.value=this.form.EmployeeRowListBuffer.value="";return}function u(W){let I=$(W).val();return I.length?I.split(",").map(O=>parseInt(O,10)):[]}q(u,"parseListFromElement");let c=u(d),y=u(r),f=u(i),l=u(m),E=u(o),v=new Set(c),g=new Set(y),D=new Set(f),H=new Set(l),b=new Set(E);for(let W of t.EmployeeData){let{JobGradeID:I,DivisionID:O,DepartmentID:U,OccupationID:k,SectionID:_,Id:R}=W;console.log(W);let Y=v.has(I)||g.has(O)||D.has(U)||H.has(k)||b.has(_),N=t.form.EmployeeRowListBuffer.value,F=N?N.split(",").map(Number):[];Y?F.includes(R)||F.push(R):F=F.filter(M=>M!==R),t.form.EmployeeRowListBuffer.value=F.join(",")}t.form.EmployeeRowList.value=t.form.EmployeeRowListBuffer.value}SearchEmployeeCallback(){var t=this,e=document.getElementById(this.idPrefix+"EmployeeRowListBuffer"),a=$(e).val();let m=a.split(","),i=[];a.length&&m.forEach(l=>{i.push(parseInt(l))});var r=document.getElementById(this.idPrefix+"PayMonth"),d=document.getElementById(this.idPrefix+"PayYear"),o=$(d).val(),u=$(r).val();let c=[];var y=t.form.EmployeeRowListBuffer.value;y.split(",").forEach(l=>{c.push(parseInt(l))})}getToolbarButtons(){var t=this,e=super.getToolbarButtons();return $(`#${this.idPrefix}Toolbar`).addClass("ms-auto"),e.push({title:"Generate Payslips",cssClass:"text-bg-success p-2 ml-auto",icon:"fas fa-hat-wizard text-green",onClick:()=>{if((0,J.isEmptyOrNull)(t.form.PayDate.value)){(0,Z.notifyError)("Please enter pay date");return}if((0,J.isEmptyOrNull)(t.form.PayMonth.value)){(0,Z.notifyError)("Please enter pay Month");return}if((0,J.isEmptyOrNull)(t.form.PayYear.value)){(0,Z.notifyError)("Please enter pay Year");return}if((0,J.isEmptyOrNull)(t.form.PayPeriodEnd.value)){(0,Z.notifyError)("Please enter pay period end");return}if((0,J.isEmptyOrNull)(t.form.PayPeriodStart.value)){(0,Z.notifyError)("Please enter pay period start");return}var a=t.form.EmployeeRowList.value;let m=[],i=a.split(",");a.length&&i.forEach(r=>{m.push(parseInt(r))}),t.counter=0,t.WaitingCounter=m.length,(0,Z.confirm)("Are you sure to generate payslip of these employees?",()=>{function r(u){return new Promise(c=>{let y=new ge(1,u,t.form.PayYear.value,t.form.PayMonth.value,t.form.PayDate.value,t.form.PayPeriodStart.value,t.form.PayPeriodEnd.value);y.element.on("dialogopen",function(){$(".s-PayrollDialog").hide()}),y.dialogOpen(),y.element.on("dialogclose",function(){t.counter+=1,t.counter==m.length&&(0,Z.notifySuccess)("Payslip generated"),c()})})}q(r,"handleEmployee");function d(){return new Promise(u=>{var c=new Gt(a,t.form.PayMonth.value,t.form.PayYear.value);c.dialogOpen(),c.element.on("dialogclose",function(){t.SearchCallback(),u()})})}q(d,"handleDownload");function o(u){return P(this,null,function*(){for(let c=0;c<u.length;c++)yield r(u[c]);t.form.Download.value==!0?yield d():t.SearchCallback()})}q(o,"processEmployees"),console.log(m),o(m),t.form.Download.value==!0&&(0,Z.notifySuccess)("Payslip downloaded"),t.form.EmployeeRowListBuffer.value=t.form.EmployeeRowList.value=""})}}),e}dialogOpen(t){super.dialogOpen();var e=this;(0,Z.serviceCall)({service:Xe.baseUrl+"/GetTodayDateTime",method:"GET",data:{},async:!1,onSuccess:b=>{e.dateString=b,Ze.List({},W=>{var I=new Date(e.dateString),O=I.getMonth(),U=I.getFullYear(),k=0;for(var _ in W.Entities)if(W.Entities[_].IsActive==1){k=W.Entities[_].PayDay;break}var R=new Date(U,O,k),Y=R.getFullYear().toString(),N=(R.getMonth()+1).toString(),F=R.getDate().toString();O=O+1;var M=new Date(U,O,k);M.setDate(M.getDate()+1);var x=M.getFullYear().toString(),S=(M.getMonth()+1).toString(),A=M.getDate().toString(),B=N.padStart(2,"0")+"/"+F.padStart(2,"0")+"/"+Y,w=S.padStart(2,"0")+"/"+A.padStart(2,"0")+"/"+x;this.isNew()&&(e.form.PayDate.value=B,e.form.PayPeriodEnd.value=B,e.form.PayPeriodStart.value=w)})}}),this.saveAndCloseButton.hide(),this.editButton.hide(),this.applyChangesButton.hide(),this.deleteButton.hide(),this.localizationButton.hide(),this.cloneButton.hide(),this.undeleteButton.hide();var a=document.getElementById(this.idPrefix+"PayMonth"),m=document.getElementById(this.idPrefix+"PayYear");let i=new yt.Select2Editor($(a)),r=new yt.Select2Editor($(m)),d=["January","February","March","April","May","June","July","August","September","October","November","December"];var o=new Date(e.dateString),u=o.getFullYear(),c=o.getMonth();for(let b=0;b<d.length;b++)i.addItem({id:b.toString(),text:d[b].toString()});i.set_value(c.toString());for(let b=-1;b<2;b++)r.addItem({id:(u+b).toString(),text:(u+b).toString()});r.set_value(u.toString());var y=document.getElementById(this.idPrefix+"SectionList"),f=document.getElementById(this.idPrefix+"OccupationList"),l=document.getElementById(this.idPrefix+"DepartmentList"),E=document.getElementById(this.idPrefix+"DivisionList"),v=document.getElementById(this.idPrefix+"JobGradeList"),g=document.getElementById(this.idPrefix+"PayPeriodStart"),D=document.getElementById(this.idPrefix+"PayPeriodEnd"),H=document.getElementById(this.idPrefix+"EmployeeRowList");console.log(this.idPrefix),$(`#s2id_${this.idPrefix}EmployeeRowList`).on("click",function(b){return P(this,null,function*(){$(".select2-drop").hide()})}),$(a).on("change",function(){return P(this,null,function*(){((0,J.isEmptyOrNull)($(a).val())||(0,J.isEmptyOrNull)($(m).val()))&&(e.form.EmployeeRowList.value=""),e.SearchCallback()})}),$(m).on("change",function(){return P(this,null,function*(){((0,J.isEmptyOrNull)($(a).val())||(0,J.isEmptyOrNull)($(m).val()))&&(e.form.EmployeeRowList.value=""),e.SearchCallback()})}),$(f).on("change",function(){return P(this,null,function*(){e.SearchCallback()})}),$(E).on("change",function(){return P(this,null,function*(){e.SearchCallback()})}),$(v).on("change",function(){return P(this,null,function*(){e.SearchCallback()})}),$(l).on("change",function(){return P(this,null,function*(){e.SearchCallback()})}),$(y).on("change",function(){return P(this,null,function*(){e.SearchCallback()})}),$(g).on("change",function(){return P(this,null,function*(){if(e.form.PayPeriodStart.valueAsDate>e.form.PayPeriodEnd.valueAsDate){(0,J.alertDialog)("Pay period start cannot be ahead of pay period end"),e.form.PayPeriodStart.value="";return}})}),$(D).on("change",function(){return P(this,null,function*(){if(e.form.PayPeriodStart.valueAsDate>e.form.PayPeriodEnd.valueAsDate){(0,J.alertDialog)("Pay period start cannot be ahead of pay period end"),e.form.PayPeriodEnd.value="";return}})})}getDialogOptions(){let t=super.getDialogOptions();return t.width=t.width+100,t}};q(je,"PayrollGeneratingWizardDialog"),je=ze([Ae.Decorators.registerClass("HRMSoftware.PayrollSettings.PayrollGeneratingWizardDialog")],je);export{ge as a,je as b};
//# sourceMappingURL=chunk-KHTUXPP2.js.map
