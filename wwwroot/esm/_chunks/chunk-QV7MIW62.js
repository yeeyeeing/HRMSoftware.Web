import{d as ie}from"./chunk-T7MGTPAP.js";import{c as Z,d as _}from"./chunk-U2RRK6JY.js";import{a as oe}from"./chunk-K2UT2MVJ.js";import{a as U}from"./chunk-DNINIZJD.js";import{c as i,g as a,h as F,j as re,k as c}from"./chunk-L3ECGIWB.js";var ne=a(c(),1),se;(e=>(e.baseUrl="EmployeeGroup/EmployeeGroup",e.Methods={Create:"EmployeeGroup/EmployeeGroup/Create",Update:"EmployeeGroup/EmployeeGroup/Update",Delete:"EmployeeGroup/EmployeeGroup/Delete",Retrieve:"EmployeeGroup/EmployeeGroup/Retrieve",List:"EmployeeGroup/EmployeeGroup/List",ListGroup:"EmployeeGroup/EmployeeGroup/ListGroup"},["Create","Update","Delete","Retrieve","List","ListGroup"].forEach(t=>{e[t]=function(p,o,f){return(0,ne.serviceRequest)(e.baseUrl+"/"+t,p,o,f)}})))(se||(se={}));var M=class{};i(M,"EmployeeGroupColumns"),M.columnsKey="EmployeeGroup.EmployeeGroup";var G=a(U(),1);var de=a(U(),1),le=a(oe(),1);var ae=a(U(),1),pe=a(oe(),1),b=a(c(),1);var L=a(c(),1);var ee=a(U(),1),ue=a(c(),1);var A=class extends pe.GridEditorDialog{constructor(){super();this.form=new P(this.idPrefix)}getFormKey(){return P.formKey}getLocalTextPrefix(){return S.localTextPrefix}dialogOpen(e){super.dialogOpen(e);function t(v,n,s){let r=new Date(v),I=new Date(n);return s.filter(x=>{let O=new Date(x.ShiftStartDate),q=new Date(x.ShiftEndDate);return r>=O&&r<=q||I>=O&&I<=q||O>=r&&O<=I||q>=r&&q<=I}).map(x=>({ShiftStartDate:x.ShiftStartDate,ShiftEndDate:x.ShiftEndDate,ShiftId:x.ShiftId}))}i(t,"getClashingShifts");function p(v,n){let s=new Date(v);return n.filter(r=>{let I=new Date(r.ShiftStartDate),x=new Date(r.ShiftEndDate);return s>=I&&s<=x}).map(r=>({ShiftStartDate:r.ShiftStartDate,ShiftEndDate:r.ShiftEndDate,ShiftId:r.ShiftId}))}i(p,"getClashingDate");var o=this;console.log(window.ShiftList),this.isNew()==!1&&Z.List({},v=>{for(var n in v.Entities)if(v.Entities[n].Id==parseInt(o.form.ShiftId.value)){var s=new _;s.loadByIdAndOpenDialog(this.form.ShiftId.value),s.set_readOnly(!0)}});var f="",u=this.idPrefix+"PropertyGrid",m=$(".fieldset").children().uniqueId();for(var h in m)u==m[h].id&&(f=m[h].id.toString());var y="#"+f.replace("PropertyGrid","ShiftStartDate"),E="#"+f.replace("PropertyGrid","ShiftEndDate");$(this.form.ShiftStartDate.element).on("change",function(v){if(!(0,L.isEmptyOrNull)(o.form.ShiftStartDate.value)){var n=p(o.form.ShiftStartDate.value,window.ShiftList);n.length>0&&((0,b.alertDialog)(`There is already a shift from ${n.map(r=>`${r.ShiftStartDate.substring(0,10)} to ${r.ShiftEndDate.substring(0,10)}`).join(`
`)}`),$(y).val(null))}if(!((0,L.isEmptyOrNull)(o.form.ShiftEndDate.value)||(0,L.isEmptyOrNull)(o.form.ShiftStartDate.value))){if(o.form.ShiftStartDate.valueAsDate>o.form.ShiftEndDate.valueAsDate&&((0,b.alertDialog)("Shift Start Date cannot be later than Shift End Date"),o.form.ShiftStartDate.value=""),!(0,L.isEmptyOrNull)(window.ShiftList)){var s=t(o.form.ShiftStartDate.value,o.form.ShiftEndDate.value,window.ShiftList);if(s.length>0){(0,b.alertDialog)(`There is already a shift from ${s.map(r=>`${r.ShiftStartDate.substring(0,10)} to ${r.ShiftEndDate.substring(0,10)}`).join(`
`)}`),$(y).val(null);return}}console.log(window.CurrentEmployee),console.log(window.NewEmployee)}}),$(this.form.ShiftEndDate.element).on("change",function(v){if(!(0,L.isEmptyOrNull)(o.form.ShiftEndDate.value)){var n=p(o.form.ShiftEndDate.value,window.ShiftList);n.length>0&&((0,b.alertDialog)(`There is already a shift from ${n.map(r=>`${r.ShiftStartDate.substring(0,10)} to ${r.ShiftEndDate.substring(0,10)}`).join(`
`)}`),$(E).val(null))}if(!((0,L.isEmptyOrNull)(o.form.ShiftEndDate.value)||(0,L.isEmptyOrNull)(o.form.ShiftStartDate.value))&&(o.form.ShiftStartDate.valueAsDate>o.form.ShiftEndDate.valueAsDate&&((0,b.alertDialog)("Shift Start Date cannot be later than Shift End Date"),o.form.ShiftEndDate.value=""),!(0,L.isEmptyOrNull)(window.ShiftList))){var s=t(o.form.ShiftStartDate.value,o.form.ShiftEndDate.value,window.ShiftList);s.length>0&&((0,b.alertDialog)(`There is already a shift from ${s.map(r=>`${r.ShiftStartDate.substring(0,10)} to ${r.ShiftEndDate.substring(0,10)}`).join(`
`)}`),$(E).val(null))}}),$(this.form.ShiftId.element).on("change",function(v){Z.List({},n=>{for(var s in n.Entities)if(n.Entities[s].Id==this.form.ShiftId.value){var r=new _;r.loadByIdAndOpenDialog(this.form.ShiftId.value),r.set_readOnly(!0)}})})}save_submitHandler(e){function t(n){return new Date(n)}i(t,"parseDate");function p(n,s,r,I){return n<I&&s>=r}i(p,"areShiftsOverlapping");var o=(0,ue.getLookup)("EmployeeProfile.EmployeeProfile"),f=e,u=window.CurrentEmployee,m=window.NewEmployee,h=window.idToBypass;console.log(h);var y=window.ShiftList,E=u.concat(m);if(console.log(E),console.log(y.length),console.log(m.length),console.log(u.length),y.length==0&&m.length==0&&u.length==0)super.save_submitHandler(f);else{var v=E.length>0?(0,ee.Criteria)(S.Fields.EmployeeRowId).in(E):(0,ee.Criteria)(S.Fields.EmployeeRowId).ge("0");ie.List({Criteria:v},n=>{if(E.length>0){for(var s in n.Entities)if(!(!(0,L.isEmptyOrNull)(h)&&h.indexOf(n.Entities[s].Id)!=-1)){var r=t(n.Entities[s].ShiftStartDate),I=t(n.Entities[s].ShiftEndDate);console.log(y);for(let B=0;B<y.length;B++){var x=t(y[B].ShiftStartDate),O=t(y[B].ShiftEndDate);if(p(r,I,x,O)==!0){var q;for(var te in o.items)if(o.items[te].Id==n.Entities[s].EmployeeRowID){q=o.items[te].EmployeeID;break}var Ge="Employee "+q+" Already has a Shift from "+n.Entities[s].ShiftStartDate.substring(0,10)+" until "+n.Entities[s].ShiftEndDate.substring(0,10);(0,b.alertDialog)(Ge);return}}}}super.save_submitHandler(f)})}}};i(A,"EmployeeGroupShiftEditDialog"),A=F([ae.Decorators.registerClass("HRMSoftware.EmployeeGroup.EmployeeGroupShiftEditDialog")],A);var fe=a(c(),1),me=a(c(),1);var H=class extends le.GridEditorBase{getColumnsKey(){return w.columnsKey}getDialogType(){return A}getLocalTextPrefix(){return S.localTextPrefix}getAddButtonCaption(){return"Add Shift"}validateEntity(d,e){function t(u){return new Date(u)}i(t,"parseDate");function p(u,m,h,y){return u<y&&m>=h}i(p,"areShiftsOverlapping");function o(u){var m=!1;for(let s=0;s<u.length;s++){var h=t(u[s].ShiftStartDate),y=t(u[s].ShiftEndDate);for(let r=0;r<u.length;r++)if(s!=r){var E=t(u[r].ShiftStartDate),v=t(u[r].ShiftEndDate);if(p(h,y,E,v)){var n="There is a clash between "+u[s].Shift+" and "+u[r].Shift;(0,me.alertDialog)(n),m=!0;break}}if(m==!0)break}return m}if(i(o,"areAnyShiftsOverlapping"),!super.validateEntity(d,e))return!1;var f=e!=null?e:d[this.getIdProperty()];return console.log(this.value),(0,fe.getLookupAsync)("ShiftRow.ShiftRow").then(u=>{var E;var m=(E=this.view)==null?void 0:E.getItemById(f);let h=d.ShiftId.toString(),y=parseInt(h);d.ShiftId=y,console.log(d),console.log(m),console.log(f),m&&(m.Shift=u.itemById[d.ShiftId].ShiftName,o(this.value)==!0&&(this.value=this.value.slice(0,-1),console.log(this.value),this.view.refresh()),this.value=this.value.sort((v,n)=>new Date(v.ShiftStartDate).getTime()-new Date(n.ShiftStartDate).getTime()))}),!0}};i(H,"EmployeeGroupShiftEditor"),H=F([de.Decorators.registerEditor("HRMSoftware.EmployeeGroup.EmployeeGroupShiftEditor")],H);var ce=a(c(),1);var X=class extends G.PrefixedContext{constructor(d){if(super(d),!X.init){X.init=!0;var e=G.StringEditor,t=G.TextAreaEditor,p=G.LookupEditor,o=H;(0,ce.initFormType)(X,["Name",e,"ShiftColor",e,"Description",t,"OccupationList",p,"DepartmentList",p,"DivisionList",p,"JobGradeList",p,"SectionList",p,"NewAddedEmployee",p,"EmployeeList",p,"Shifts",o,"ActualShifts",o])}}},j=X;i(j,"EmployeeGroupForm"),j.formKey="EmployeeGroup.EmployeeGroup";var V=class{};i(V,"EmployeeGroupingsColumns"),V.columnsKey="EmployeeGroup.EmployeeGroupings";var T=a(U(),1),Se=a(c(),1);var C=class extends T.PrefixedContext{constructor(d){if(super(d),!C.init){C.init=!0;var e=T.IntegerEditor,t=T.DateEditor;(0,Se.initFormType)(C,["IsActive",e,"InsertUserId",e,"UpdateUserId",e,"DeleteUserId",e,"InsertDate",t,"UpdateDate",t,"DeleteDate",t,"EmployeeRowId",e,"EmployeeGroupId",e])}}},z=C;i(z,"EmployeeGroupingsForm"),z.formKey="EmployeeGroup.EmployeeGroupings";var ye=a(c(),1);var R=class{};i(R,"EmployeeGroupingsRow"),R.idProperty="Id",R.isActiveProperty="IsActive",R.localTextPrefix="EmployeeGroup.EmployeeGroupings",R.deletePermission="Administration:HumanResources",R.insertPermission="Administration:HumanResources",R.readPermission="*",R.updatePermission="Administration:HumanResources",R.Fields=(0,ye.fieldsProxy)();var De=a(c(),1),ve;(e=>(e.baseUrl="EmployeeGroup/EmployeeGroupings",e.Methods={Create:"EmployeeGroup/EmployeeGroupings/Create",Update:"EmployeeGroup/EmployeeGroupings/Update",Delete:"EmployeeGroup/EmployeeGroupings/Delete",Retrieve:"EmployeeGroup/EmployeeGroupings/Retrieve",List:"EmployeeGroup/EmployeeGroupings/List"},["Create","Update","Delete","Retrieve","List"].forEach(t=>{e[t]=function(p,o,f){return(0,De.serviceRequest)(e.baseUrl+"/"+t,p,o,f)}})))(ve||(ve={}));var J=a(c(),1);var D=class{static getLookup(){return(0,J.getLookup)("EmployeeGroup.EmployeeGroup")}static getLookupAsync(){return re(this,null,function*(){return(0,J.getLookupAsync)("EmployeeGroup.EmployeeGroup")})}};i(D,"EmployeeGroupRow"),D.idProperty="Id",D.isActiveProperty="IsActive",D.nameProperty="Name",D.localTextPrefix="EmployeeGroup.EmployeeGroup",D.lookupKey="EmployeeGroup.EmployeeGroup",D.deletePermission="Administration:HumanResources",D.insertPermission="Administration:HumanResources",D.readPermission="*",D.updatePermission="Administration:HumanResources",D.Fields=(0,J.fieldsProxy)();var w=class{};i(w,"EmployeeGroupShiftColumns"),w.columnsKey="EmployeeGroup.EmployeeGroupShift";var k=a(U(),1),he=a(c(),1);var K=class extends k.PrefixedContext{constructor(d){if(super(d),!K.init){K.init=!0;var e=k.LookupEditor,t=k.DateEditor;(0,he.initFormType)(K,["ShiftId",e,"ShiftStartDate",t,"ShiftEndDate",t])}}},P=K;i(P,"EmployeeGroupShiftForm"),P.formKey="EmployeeGroup.EmployeeGroupShift";var W=class{};i(W,"EmployeeGroupShiftPatternColumns"),W.columnsKey="EmployeeGroup.EmployeeGroupShiftPattern";var Q=a(U(),1),Ee=a(c(),1);var N=class extends Q.PrefixedContext{constructor(d){if(super(d),!N.init){N.init=!0;var e=Q.IntegerEditor,t=Q.DateEditor;(0,Ee.initFormType)(N,["EmployeeRowId",e,"InsertDate",t,"ShiftStartDate",t,"ShiftEndDate",t,"ShiftId",e,"UpdateDate",t,"DeleteDate",t,"IsActive",e,"InsertUserId",e,"DeleteUserId",e,"UpdateUserId",e,"EmployeeGroupId",e])}}},Y=N;i(Y,"EmployeeGroupShiftPatternForm"),Y.formKey="EmployeeGroup.EmployeeGroupShiftPattern";var Re=a(c(),1);var g=class{};i(g,"EmployeeGroupShiftPatternRow"),g.idProperty="Id",g.isActiveProperty="IsActive",g.localTextPrefix="EmployeeGroup.EmployeeGroupShiftPattern",g.deletePermission="Administration:HumanResources",g.insertPermission="Administration:HumanResources",g.readPermission="Administration:HumanResources",g.updatePermission="Administration:HumanResources",g.Fields=(0,Re.fieldsProxy)();var Ie=a(c(),1),ge;(e=>(e.baseUrl="EmployeeGroup/EmployeeGroupShiftPattern",e.Methods={Create:"EmployeeGroup/EmployeeGroupShiftPattern/Create",Update:"EmployeeGroup/EmployeeGroupShiftPattern/Update",Delete:"EmployeeGroup/EmployeeGroupShiftPattern/Delete",Retrieve:"EmployeeGroup/EmployeeGroupShiftPattern/Retrieve",List:"EmployeeGroup/EmployeeGroupShiftPattern/List"},["Create","Update","Delete","Retrieve","List"].forEach(t=>{e[t]=function(p,o,f){return(0,Ie.serviceRequest)(e.baseUrl+"/"+t,p,o,f)}})))(ge||(ge={}));var xe=a(c(),1);var S=class{};i(S,"EmployeeGroupShiftRow"),S.idProperty="Id",S.isActiveProperty="IsActive",S.localTextPrefix="EmployeeGroup.EmployeeGroupShift",S.deletePermission="Administration:HumanResources",S.insertPermission="Administration:HumanResources",S.readPermission="Administration:HumanResources",S.updatePermission="Administration:HumanResources",S.Fields=(0,xe.fieldsProxy)();var be=a(c(),1),Le;(e=>(e.baseUrl="EmployeeGroup/EmployeeGroupShift",e.Methods={Create:"EmployeeGroup/EmployeeGroupShift/Create",Update:"EmployeeGroup/EmployeeGroupShift/Update",Delete:"EmployeeGroup/EmployeeGroupShift/Delete",Retrieve:"EmployeeGroup/EmployeeGroupShift/Retrieve",List:"EmployeeGroup/EmployeeGroupShift/List"},["Create","Update","Delete","Retrieve","List"].forEach(t=>{e[t]=function(p,o,f){return(0,be.serviceRequest)(e.baseUrl+"/"+t,p,o,f)}})))(Le||(Le={}));export{M as a,j as b,V as c,z as d,R as e,ve as f,D as g,se as h,w as i,P as j,W as k,Y as l,g as m,ge as n,S as o,Le as p};
//# sourceMappingURL=chunk-QV7MIW62.js.map
